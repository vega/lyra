(window.__webpackJsonp__=window.__webpackJsonp__||[]).push([[0],{1068:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(23),s=n(87),r=n(48),i=n.n(r),l=n(27);function o(e){s.a.call(this,[],e)}o.Definition=Object(a.extend)({},s.a.Definition);const c=Object(a.inherits)(o,s.a);c.handles=function(e){const t=e.mark.bounds,n=Object(l.coords)(t,"handle");return[n.topLeft,n.topRight,n.bottomLeft,n.bottomRight]},c.connectors=function(e){const t=e.mark.bounds;return[Object(l.coords)(t,"connector").midCenter]},c.channels=function(e){const t=e.mark.bounds,n=e.mark.group.bounds,a=e._svg.getAttribute("d"),s=Object(l.coords)(t).midCenter;return[].concat([{x:n.x1,y:e.y},{x:e.x-l.PADDING,y:e.y}].map(i()("x","span"))).concat([{x:e.x,y:n.y1},{x:e.x,y:e.y-l.PADDING}].map(i()("y","span"))).concat([{x:s.x,y:s.y,path:a}].map(i()("fill","border")))},c.altchannels=function(e){const t=e.mark.bounds,n=Object(l.coords)(t).midCenter,a=e.mark.items[0].pathCache;return a=a.map(function(e){return e.join(" ")}).join(" "),[{x:n.x,y:n.y,path:a}].map(i()("stroke","border"))}},1069:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(23),s=n(87),r=n(48),i=n.n(r),l=n(27);function o(e){s.a.call(this,[],e)}o.Definition=Object(a.extend)({},s.a.Definition);const c=Object(a.inherits)(o,s.a);c.handles=function(e){const t=e.mark.bounds,n=Object(l.coords)(t,"handle");return[n.topLeft,n.topRight,n.bottomLeft,n.bottomRight]},c.connectors=function(e){const t=e.mark.bounds;return[Object(l.coords)(t,"connector").midCenter]},c.channels=function(e){const t=e.mark.bounds,n=e.mark.group.bounds,a=e._svg.getAttribute("d"),s=Object(l.coords)(t).midCenter;return[].concat([{x:n.x1,y:e.y},{x:e.x-l.PADDING,y:e.y}].map(i()("x","span"))).concat([{x:e.x,y:n.y1},{x:e.x,y:e.y-l.PADDING}].map(i()("y","span"))).concat([{x:s.x,y:s.y,path:a}].map(i()("stroke","border")))},c.altchannels=function(e){return this.channels(e).filter(e=>"stroke"===e.key).map(i()("detail","border"))}},1070:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(23),s=n(87),r=n(48),i=n.n(r),l=n(27);const o=3.5*l.PADDING;function c(e){s.a.call(this,[],e)}c.Definition=Object(a.extend)({},s.a.Definition);const d=Object(a.inherits)(c,s.a);d.handles=function(e){var t=Object(l.coords)(e.bounds,"handle");return[t.topLeft,t.topRight,t.bottomLeft,t.bottomRight]},d.connectors=function(e){return[Object(l.coords)(e.bounds,"connector").midCenter]},d.channels=function(e){var t=e.bounds,n=e.mark.group.bounds,a=Object(l.coords)(t).midCenter;return[].concat([{x:n.x1,y:a.y},{x:a.x-o,y:a.y,_voronoi:!1}].map(i()("x","span"))).concat([{x:a.x,y:n.y1},{x:a.x,y:a.y-o,_voronoi:!1}].map(i()("y","span"))).concat([{x:e.x+.01,y:e.y-.01,shape:e.shape,size:e.size}].map(i()("size","border"))).concat([{x:e.x-.01,y:e.y+.01,shape:e.shape,size:l.PADDING*e.size}].map(i()("fill","border")))},d.altchannels=function(e){return[].concat([{x:e.x+.01,y:e.y+.01,shape:e.shape,size:e.size}].map(i()("shape","border"))).concat([{x:e.x-.01,y:e.y,shape:e.shape,size:l.PADDING*e.size}].map(i()("stroke","border")))}},1071:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(23),s=n(87),r=n(48),i=n.n(r),l=n(27);const o=1.5*l.PADDING;function c(e){s.a.call(this,[],e)}c.Definition=Object(a.extend)({},s.a.Definition);const d=Object(a.inherits)(c,s.a);d.handles=function(e){var t=Object(l.coords)(e.bounds,"handle");return[t.topLeft,t.bottomRight]},d.connectors=function(e){return[Object(l.coords)(e.bounds,"connector").midCenter]},d.channels=function(e){var t=e.bounds,n=e.mark.group.bounds,s=Object(l.coords)(t).midCenter;return[].concat([{x:n.x1,y:s.y},{x:s.x-o,y:s.y}].map(i()("x","span"))).concat([{x:s.x,y:n.y1},{x:s.x,y:s.y-o}].map(i()("y","span"))).concat([Object(a.extend)({},e,{bounds:null,_id:null})].map(i()("text","border")))},d.altchannels=function(e){return[Object(a.extend)({},e,{bounds:null,_id:null})].map(i()("fill","border"))}},1072:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(23);n(313);function s(e){a.Transform.call(this,[],e),this._cellID=null,this._start=Object(a.ingest)({}),this._end=Object(a.ingest)({}),this._mouseCache={x:-1,y:-1}}s.Definition={metadata:{source:!0,changes:!0},params:[{name:"lyra_cell",required:!0},{name:"lyra_mouse",required:!0}]},Object(a.inherits)(s,a.Transform).transform=function(e,t){const n=e.lyra_cell,s=e.lyra_mouse,r=this._mouseCache,i=this._cellID,l=this._start,o=this._end,c=this.value||[],d=t.fork(t.NO_FIELDS&t.NO_SOURCE);if(c.length&&i!==Object(a.tupleid)(n)&&(d.rem=c.splice(0)),!Object(a.tupleid)(n))return d.source=this.value=c,d;let p=n.mark.group;const u=n.datum.manipulator,m=function(e){const t=e.mark.group,n=e.datum.manipulator;for(const a of t.items)if(a.role===n){if("group"===a.marktype)for(const t of a.items)if(t.datum&&t.datum.key===e.datum.key)return t.items[0].items;return a.items}return null}(n),g={x:0,y:0};if(!c.length||r.x===s.x&&r.y===s.y){if(!c.length){for(c.push(Object(a.extend)(l,s));p;p=p.mark&&p.mark.group)g.x+=p.x||0,g.y+=p.y||0;if("arrow"===u||"span"===u)c.push.apply(c,m.map(e=>Object(a.ingest)({x:e.x+g.x,y:e.y+g.y})));else{const e=m[0].bounds||m[0].mark.bounds;c.push.apply(c,[{x:e.x1,y:e.y1},{x:e.x2,y:e.y1},{x:e.x2,y:e.y2}].map(a.ingest))}c.push(Object(a.extend)(o,s)),d.add=c,this._cellID=Object(a.tupleid)(n)}}else d.mod.push(Object(a.extend)(l,s)),d.mod.push(Object(a.extend)(o,s));return this._mouseCache=s,d.source=this.value=c,d}},108:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),s=a.getIn,r=a.getInVis,i=n(13),l=n(33),o=n(67),c=n(882),d=n(1241),p=n(1246);t.Property=l.connect(function(e,t){if(!t.primId)return{};const n=r(e,t.primType+"."+t.primId);let a,i;t.name&&(t.primType===c.PrimType.MARKS?(a="encode.update."+t.name,i=s(n,"from.data")):a=t.name);const l=s(n,a+".scale"),o=s(n,a+".field"),d=l&&r(e,"scales."+l+".name"),p=s(n,a);return{group:s(n,a+".group"),signal:s(n,a+".signal"),value:void 0!==t.value?t.value:null!==p?p:void 0,field:o,scale:l,srcField:!(!i||!o)&&r(e,"datasets."+i+"._schema."+o+".source"),scaleName:d,dragging:e.getIn(["inspector","dragging"])}},function(e,t){return{unbind:function(){e(o.resetMarkVisual(t.name,t.primId))}}})(class extends i.Component{constructor(e){super(e),this.state={dragOver:0}}render(){const e=this.props,t=e.name,n=e.label,a=e.type,s=e.scale,r=e.field,l=e.unbind;let o,c,u,m,g=this.state.dragOver;if(i.Children.forEach(e.children,function(e){const t=e&&e.props.className;"extra"===t?m=e:"control"===t?u=e:("label"===a||t&&-1!==t.indexOf("label"))&&(o=e)}),o=o||i.createElement("label",{htmlFor:t},n),c=s?i.createElement("div",{className:"scale",onClick:l},e.scaleName):null,!(u=r?i.createElement("div",{className:"field "+(e.srcField?"source":"derived"),onClick:l},r):u))switch(a){case"autocomplete":u=i.createElement(d.AutoComplete,{type:e.autoType,updateFn:e.onChange,value:e.value,dsId:e.dsId,primId:e.primId,primType:e.primType});break;default:u=i.createElement(p.FormInputProperty,Object.assign({},e))}m&&(m=i.createElement("div",{className:"extra"},m));const h="property"+(e.droppable&&e.dragging?" droppable":"")+(e.droppable&&g?" drag-over":"")+(e.firstChild?" first-child":"");return i.createElement("div",{className:h,onDragEnter:()=>this.setState({dragOver:++g}),onDragLeave:()=>this.setState({dragOver:--g})},o,i.createElement("div",{className:"control"},c,u),m)}})},1099:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(1100),s=n(307),r=n(423),i=n(1151),l=n(1152),o=n(1153),c=n(267),d=n(1162),p=n(1163),u=n(1164),m=n(1165),g=n(1166),h=n(1167),f=n(1168),y=n(1169),v=n(1170),_=n(1171),b=n(1172),S=a.combineReducers({signals:y.signalsReducer,scene:f.sceneReducer,pipelines:g.pipelinesReducer,datasets:i.datasetsReducer,scales:h.scalesReducer,guides:l.guidesReducer,marks:m.marksReducer,interactions:p.interactionsReducer,widgets:u.widgetsReducer});t.default=a.combineReducers({vis:s.default(r.hydrator(S,"vis"),c.default),vega:v.invalidateVegaReducer,lyra:r.hydrator(_.lyraGlobalsReducer,"lyra"),inspector:r.hydrator(d.inspectorReducer,"inspector"),hints:o.hintsReducer,walkthrough:b.walkthroughReducer})},1108:function(e,t){},1109:function(e,t){},1110:function(e,t){},1111:function(e,t){},1129:function(e,t){},1140:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Asc="ascending",e.Desc="descending"}(t.SortOrderValues||(t.SortOrderValues={})),e.exports={ASC:"asc",DESC:"desc"}},1141:function(e,t,n){"use strict";function a(){}function s(e){this.cancelled=!1,this.promise=new Promise(e.bind(this))}a.prototype.catch=a.prototype.then=function(){return new a},s.prototype.cancel=function(){this.cancelled=!0},s.prototype.then=function(e,t){if(this.cancelled)return new a;var n=this;return this.promise.then(function(t){return n.cancelled?new a:e(t)}).catch(t)},s.prototype.catch=function(e){return this.promise.catch(e)},e.exports=s},1142:function(e,t,n){"use strict";var a=n(1143),s={};Object.keys(a).forEach(function(e){var t=a[e];Object.keys(t).forEach(function(e){var n=t[e];"string"==typeof n&&(s[e]=n)})}),e.exports=s},1143:function(e,t,n){"use strict";e.exports={vega:n(420),signals:n(268),scene:n(223),pipelines:n(315),datasets:n(141),scales:n(271),guides:n(201),marks:n(67),rules:n(377),inspectors:n(91),hints:n(597),walkthrough:n(876)}},1146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(592),s=n(141),r=n(271),i=n(47).getInVis;t.default=function(e,t){const n=a.getCounts(!0).scales;for(const t in n)0===n[t].markTotal&&e(r.deleteScale(null,+t));const l=a.getCounts(!0).data;for(const n in l)if(0===l[n].total){const a=i(t,`datasets.${n}._parent`);i(t,`pipelines.${a}._source`)!==+n&&e(s.deleteDataset(+n,a))}}},1147:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47).getInVis,s=n(141),r=n(315);t.default=function(e,t,n){n.map.data.source_0=n.dsId,n.map.data.data_0=n.dsId;const i=n.output.data;!function(e,t,n,i){const l=i.transform&&i.transform.find(e=>"aggregate"===e.type);if(!l)return;const o=l.groupby.join("|"),c=n.plId;let d=a(t,"pipelines."+c+"._aggregates."+o);d?e(s.summarizeAggregate(l,d)):(e(r.aggregatePipeline(c,l)),d=l._id),n.map.data.source_0=d,n.map.data.data_0=d}(e,t,n,i.find(e=>"data_0"===e.name)||i.find(e=>"source_0"===e.name))}},1148:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(312),s=n(201),r=n(316),i=n(167),l=n(47),o=(l.getIn,l.getInVis),c={x:a.GuideType.Axis,y:a.GuideType.Axis,color:a.GuideType.Legend,size:a.GuideType.Legend,shape:a.GuideType.Legend},d={left:"right",right:"left",top:"bottom",bottom:"top"};t.default=function(e,t,n){const l=n.channel,p=n.map,u=c[l],m=p.scales[l],g=n.output;u&&m&&(u===a.GuideType.Axis?function(e,t,n,l,c){const p=n.map,u=n.mark._parent,m=(o(t,`scales.${l}`),o(t,`marks.${u}.axes`));let g,h=!1,f=0;const y=c.find(e=>p.scales[e.scale]===l&&e.title);if(m.forEach(e=>{const n=o(t,`guides.${e}`);n&&(String(n.scale)===String(l)&&(h=!0),n.orient===y.orient&&(++f,g=n.orient),d[n.orient]===y.orient&&++f)}),!h&&f<2){let o=a.Guide(a.GuideType.Axis,n.channel,l);o=o.mergeDeep({title:y.title,orient:1===f&&g?d[g]:y.orient||o.orient,encode:y.encode});const c=i.assignId(e,t);o=o.merge({_id:c}),e(s.addGuide(o)),e(r.addAxisToGroup(c,u))}}(e,t,n,m,g.axes):function(e,t,n,l,c){const d=n.map,p=n.mark,u=n.property,m=p._parent,g=o(t,`marks.${m}.legends`);let h=!1;const f=c.find(e=>d.scales[e[u]]===l);if(g.some(function(e){const n=o(t,`guides.${e}`);if(n)return h=h||n.get(u)===l}),!h){let n=a.Guide(a.GuideType.Legend,u,l);n=(n=n.deleteIn(["encode","symbols",u])).mergeDeep({title:f.title,encode:f.encode});const o=i.assignId(e,t);n=n.merge({_id:o}),e(s.addGuide(n)),e(r.addLegendToGroup(o,m))}}(e,t,n,m,g.legends))}},1149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),s=n(4),r=n(593),i=n(168),l=n(67),o=n(268),c=n(47).getInVis;function d(e,t,n,a){const s=t.map,r=t.markId,c=t.markType;if("detail"===(a=a||t.property))return;const d="stroke"===a?n.stroke||n.fill:n[a];"scale"in d&&"string"==typeof d.scale&&(d.scale=s.scales[d.scale]),"value"in d&&(d.signal=i.propSg(r,c,a),e(o.setSignal(d.value,d.signal)),delete d.value),e(l.setMarkVisual({property:a,def:d},r)),s.marks[r]=s.marks[r]||{},s[a]=Date.now()}t.default=function(e,t,n){const i=n.markType,o=n.map,u=n.markId,m=n.channel;let g=null,h=n.output.marks[0];"group"===h.type&&h.name.indexOf("pathgroup")>=0&&(g=h,h=h.marks[0]),"rect"!==i||"x"!==m&&"y"!==m?"text"===i&&"text"===m?function(e,t){const n=s.getFieldDef(t.input.encoding.text);e(l.setMarkVisual({property:"text",def:{signal:`datum.${n.field}`}},t.markId))}(e,n):d(e,n,h.encode.update):function(e,t,n,s){const i=n.channel,o=n.property,u=n.markId,m=n.map.marks[u],g=i+"2",h=i+"c",f=p[i],y=Object.values(r.default[i]),v=c(t,`marks.${u}.encode.update`);let _=0;if(o!==`${i}+`)return y.map(e=>a.extend({},{ts:m&&m[e.name]||0},e)).sort(a.compare("ts","descending")).forEach(t=>{const n=t.name;n!==o&&(_>=1?e(l.disableMarkVisual(n,u)):v[n]._disabled||++_)}),s[o]=s[i]||s[h]||s[o],d(e,n,s);y.forEach(t=>e(l.disableMarkVisual(t.name,u))),s[g]?(d(e,n,s,i),d(e,n,s,g)):(d(e,n,s,i),s[f]={scale:s[i].scale,band:!0,offset:-1},d(e,n,s,f))}(e,t,n,h.encode.update),g?e(l.updateMarkProperty({property:"_facet",value:Object.assign(Object.assign({},g.from.facet),{data:o.data[g.from.facet.data]})},u)):h.from&&h.from.data&&e(l.updateMarkProperty({property:"from",value:{data:o.data[h.from.data]}},u))};const p={x:"width",y:"height"}},1150:function(e,t,n){"use strict";var a=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n};Object.defineProperty(t,"__esModule",{value:!0});const s=n(23),r=n(24),i=n(424),l=n(271),o=n(316),c=n(167),d=n(47),p=(d.getIn,d.getInVis);function u(e,t,n,a){if(n.type!==t.type)return!1;if(JSON.stringify(n.range)!==JSON.stringify(t.range))return!1;if(r.isDataRefDomain(t.domain)&&n._domain){const s=n._domain[0];if(s.field!==t.domain.field)return!1;if(p(e,`datasets.${s.data}._parent`)!==p(e,`datasets.${a[t.domain.data]}._parent`))return!1}return!0}function m(e,t){const{domain:n}=t,l=a(t,["domain"]),o=r.isDataRefDomain(n)?s.extend({},l,{_domain:[{data:e.map.data[n.data],field:n.field}]}):t;return i.Scale(o)}t.default=function(e,t,n){const a=n.map.scales,i=n.map.data,d=n.mark,g=n.channel;let h=p(t,"scales."+a[g]),f=h&&h._id,y=n.output.scales;if(!y)return;if(1!==(y=y.filter(e=>e.name===g)).length)return void console.warn(y.length+" scales found for "+g);const v=function(e){const t=e.range;return"x"===e.name||s.isArray(t)&&t.find(e=>r.isSignalRef(e)&&"width"===e.signal)?e.range="width":("y"===e.name||s.isArray(t)&&t.find(e=>r.isSignalRef(e)&&"height"===e.signal))&&(e.range="height"),e}(y[0]);h&&u(t,v,h,i)||p(t,"scales").valueSeq().forEach(function(e){if(u(t,v,e,i))return h=e,f=e._id,!1});const _=t.getIn(["vis","present","marks"]).valueSeq().filter(e=>"group"!==e.type&&"scene"!==e.type&&e._id!==d._id&&e._parent===d._parent);let b=!1;if(_.forEach(a=>{var s,r,i,o;let c;if("x"===g?c=(null===(r=null===(s=a.encode)||void 0===s?void 0:s.update)||void 0===r?void 0:r.x).scale:"y"===g&&(c=(null===(o=null===(i=a.encode)||void 0===i?void 0:i.update)||void 0===o?void 0:o.y).scale),c){const a=t.getIn(["vis","present","scales",String(c)]);h=a,f=a._id;const s=m(n,v),r=a._domain.concat(s._domain).filter((e,t,n)=>n.findIndex(t=>t.field===e.field)===t);e(l.updateScaleProperty({property:"_domain",value:r},a._id)),b=!0}}),!(b||h&&u(t,v,h,i))){f=c.assignId(e,t);const a=m(n,v).merge({_id:f});e(l.addScale(a))}a[g]=f,e(o.addScaleToGroup(f,d._parent))}},1151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(46),r=n(584),i=n(141),l=n(374),o=n(225);t.datasetsReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===s.getType(i.baseAddDataset))return t.meta&&o.init(t.payload,t.meta),e.set(String(t.payload._id),t.payload);if(t.type===s.getType(i.deleteDataset))return e.remove(String(n));if(t.type===s.getType(i.changeFieldMType)){const a=t.payload;return e.setIn([String(n),"_schema",a.field,"mtype"],a.mtype)}if(t.type===s.getType(i.sortDataset))return e.setIn([String(n),"_sort"],t.payload);if(t.type===s.getType(i.addTransform)){const s=t.payload,i=e.getIn([String(n),"transform"])||a.List();return"formula"===s.type&&(e=e.setIn([String(n),"_schema",s.as],l.Column({name:s.as,type:"number",mtype:r.QUANTITATIVE,source:!1}))),e.setIn([String(n),"transform"],i.concat(s))}if(t.type===s.getType(i.updateTransform)){const a=t.payload,s=a.transform;if("formula"===s.type){const t=e.getIn([String(n),"transform",a.index,"as"]),r=e.getIn([String(n),"_schema",t]);e=(e=e.deleteIn([String(n),"_schema",t])).setIn([String(n),"_schema",s.as],r.set("name",s.as))}else if("lookup"===s.type){e.getIn([String(n),"transform",a.index,"as"]).forEach(t=>e=e.deleteIn([String(n),"_schema",t]));const t=s.values,r=s.as;for(const[a,i]of r.entries()){const r=t[a],l=e.getIn([s.from,"_schema",r]);e=e.setIn([String(n),"_schema",i],l.set("name",i).set("source",!1))}}return e.setIn([String(n),"transform",a.index],a.transform)}if(t.type===s.getType(i.summarizeAggregate)){const a=(e=(e=(e=e.setIn([String(n),"transform","0","fields"],e.getIn([String(n),"transform","0","fields"]).concat(t.payload.fields))).setIn([String(n),"transform","0","ops"],e.getIn([String(n),"transform","0","ops"]).concat(t.payload.ops))).setIn([String(n),"transform","0","as"],e.getIn([String(n),"transform","0","as"]).concat(t.payload.as))).getIn([String(n),"source"]);return e.setIn([String(n),"_schema"],o.aggregateSchema(e.getIn([a,"_schema"]),e.getIn([String(n),"transform","0"])))}return e}},1152:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(46),r=n(201),i=n(271),l=n(312),o=n(168).convertValuesToSignals;t.guidesReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===s.getType(r.baseAddGuide))return e.set(String(n),function(e){const t=e.payload,n=t.encode;return t.merge({encode:Object.keys(n).reduce(function(e,a){return e[a]=o(n[a],"guide",t._id,a),e},{})})}(t));if(t.type===s.getType(r.deleteGuide))return e.remove(String(n));if(t.type===s.getType(r.updateGuideProperty))return e.setIn([String(n),...t.payload.property.split(".")],a.fromJS(t.payload.value));if(t.type===s.getType(i.updateScaleProperty)){const a=t.payload;let s=e;return"_domain"===a.property&&e.valueSeq().forEach(e=>{let t;if(l.isAxis(e)&&(t=e.scale),l.isLegend(e)&&(t=e[e._type]),String(t)===String(n)){const t=a.value.map(e=>e.field);if(e.title){if(e.title&&"string"==typeof e.title){const n=e.title.split(", ");(n.every(e=>t.includes(e))&&n.length+1===t.length||t.every(e=>n.includes(e))&&t.length+1===n.length)&&(s=s.setIn([String(e._id),"title"],t.join(", ")))}}else s=s.setIn([String(e._id),"title"],t.join(", "))}}),s}if(t.type===s.getType(i.deleteScale)){const n=t.meta;return e.withMutations(function(t){e.forEach(function(e,a){+(l.isAxis(e)?e.scale:l.isLegend(e)?e[e._type]:null)===n&&t.delete(String(a))})})}return e}},1153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(597),r=n(67),i=n(223),l=n(1154),o=n(1161),c=n(879);t.hintsReducer=function(e,t){if(void 0===e)return c.Hints();if(t.type===a.getType(s.clearHints))return e.set("display",null);if(t.type===a.getType(s.hintsOn))return e.set("on",t.payload);if(t.type===a.getType(i.baseCreateScene))return e.set("display",o.SceneHints.CREATE_SCENE);if(t.type===a.getType(r.baseAddMark)){const n=t.payload.props.type;if(l.MarkHints.ADD_MARK[n])return e.set("display",l.MarkHints.ADD_MARK[n])}return e}},1154:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(223);t.MarkHints={ADD_MARK:{rect:{title:"I see you have added a RECT...",text:"Maybe you'd like to clear the whole canvas",action_text:"DO IT. CLEAR IT OUT.",action:a.clearScene},line:{title:"I see you have added a LINE...",text:"Drop data on it to create a graph."},symbol:{template:n(1155)}}}},1155:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(67),i=n(72).lookup;t.SymbolHints=s.connect(function(e,t){return{selectedId:e.getIn(["inspector","encodings","selectedId"])}},function(e,t){return{updateProperty:(t,n,a)=>{const s=i(t);s&&(s[n]=a),e(r.updateMarkProperty({property:n,value:a},t))}}})(class extends a.Component{render(){return a.createElement("div",null,a.createElement("p",null,"I have a special template!!!"))}})},1161:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(597);t.SceneHints={CREATE_SCENE:{title:"Hi, I'm helpy the helper hints box",text:"You can turn me on and off. You can manage this in the settings link in the footer.",action_text:"DISABLE HINTS",action:a.hintsOn,action_props:!1}}},1162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(91),r=n(143),i=n(226),l=n(67),o=n(272);function c(e,t){return t.reduce(function(e,t){return e.setIn(["encodings","expandedLayers",t],!0)},e)}t.inspectorReducer=function(e,t){if(void 0===e)return o.Inspector();if(t.type===a.getType(s.selectPipeline))return e.setIn(["pipelines","selectedId"],t.payload);if(t.type===a.getType(s.startDragging))return e.setIn(["dragging"],t.payload);if(t.type===a.getType(s.stopDragging))return e.setIn(["dragging"],null);if(t.type!==a.getType(s.baseSelectMark)&&t.type!==a.getType(s.selectScale)&&t.type!==a.getType(s.selectInteraction)&&t.type!==a.getType(s.selectWidget)&&t.type!==a.getType(s.selectGuide)||(e=(e=e.setIn(["encodings","selectedId"],t.payload)).setIn(["encodings","selectedType"],t.type)),t.type===a.getType(r.baseAddInteraction)&&(e=(e=e.setIn(["encodings","selectedId"],t.meta)).setIn(["encodings","selectedType"],a.getType(s.selectInteraction))),t.type===a.getType(i.baseAddWidget)&&(e=(e=e.setIn(["encodings","selectedId"],t.meta)).setIn(["encodings","selectedType"],a.getType(s.selectWidget))),t.type===a.getType(l.baseAddMark)&&(e=(e=e.setIn(["encodings","selectedId"],t.meta)).setIn(["encodings","selectedType"],a.getType(s.baseSelectMark))),t.type===a.getType(s.baseSelectMark))return c(e,t.meta);if(t.type===a.getType(l.baseAddMark)){const n={};return n[t.payload.props._parent]=!0,"group"===t.payload.props.type&&(n[t.meta]=!0),e.mergeIn(["encodings","expandedLayers"],n)}return t.type===a.getType(s.expandLayers)?c(e,t.payload):t.type===a.getType(s.removeLayers)?t.payload.reduce(function(e,t){return e.deleteIn(["encodings","expandedLayers",t])},e):t.type===a.getType(s.toggleLayers)?t.payload.reduce(function(e,t){const n=["encodings","expandedLayers",t];return e.setIn(n,!e.getIn(n))},e):e}},1163:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(46),r=n(143);t.interactionsReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===s.getType(r.baseAddInteraction))return e.set(String(n),t.payload);if(t.type===s.getType(r.setInput))return e.setIn([String(n),"input"],t.payload);if(t.type===s.getType(r.setSelection))return e.setIn([String(n),"selection"],t.payload);if(t.type===s.getType(r.setSignals))return e.setIn([String(n),"signals"],t.payload);if(t.type===s.getType(r.setSignalPush)){const a=e.getIn([String(n),"signals"]);return a.forEach(e=>{e.signal in t.payload&&(e.push=t.payload[e.signal])}),e.setIn([String(n),"signals"],a)}if(t.type===s.getType(r.toggleEnableApplicationType)){const a=t.payload.label,s=Boolean(e.getIn([String(n),"_applicationTypeIsEnabled",a]));return e.setIn([String(n),"_applicationTypeIsEnabled",a],!s)}if(t.type===s.getType(r.setApplication)){const a=e.getIn([String(n),"applications"]).filter(e=>e.id!==t.payload.id);return e.setIn([String(n),"applications"],[...a,t.payload])}if(t.type===s.getType(r.removeApplication)){const a=e.getIn([String(n),"applications"]).filter(e=>e.id!==t.payload.id);return e.setIn([String(n),"applications"],a)}return t.type===s.getType(r.deleteInteraction)?e.remove(String(n)):t.type===s.getType(r.updateInteractionName)?e.setIn([String(n),"name"],t.payload):e}},1164:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(46),r=n(226);t.widgetsReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===s.getType(r.baseAddWidget))return e.set(String(n),t.payload);if(t.type===s.getType(r.setSelection))return e.setIn([String(n),"selection"],t.payload);if(t.type===s.getType(r.setApplication)){const a=e.getIn([String(n),"applications"]).filter(e=>e.id!==t.payload.id);return e.setIn([String(n),"applications"],[...a,t.payload])}if(t.type===s.getType(r.removeApplication)){const a=e.getIn([String(n),"applications"]).filter(e=>e.id!==t.payload.id);return e.setIn([String(n),"applications"],a)}return t.type===s.getType(r.setSignals)?e.setIn([String(n),"signals"],t.payload):t.type===s.getType(r.deleteWidget)?e.remove(String(n)):t.type===s.getType(r.updateWidgetName)?e.setIn([String(n),"name"],t.payload):e}},1165:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(46),r=n(316),i=n(201),l=n(67),o=n(223),c=n(143),d=n(226),p=n(168),u=function(e,t,n){return e.updateIn(t,e=>(-1===e.indexOf(n)&&e.push(n),e))},m=function(e,t,n){return e.updateIn(t,e=>-1===e.indexOf(n)?[...e,n]:e)},g=function(e,t,n){return e.updateIn(t,e=>e.filter(e=>e!==n))};function h(e){const t=e.payload.props,n=t.encode&&t.encode.update;return t.encode?t.merge({encode:{update:p.convertValuesToSignals(n,t.type,e.meta)}}):t}function f(e,t){const{parentId:n,childId:a}=t;if(void 0===a)return e;const s=e.get(String(a));if(!s)return e;const r=s._parent;if(null==r&&!n)return e;const i=e.get(String(r)),l=n?e.get(String(n)):n;return null===l?g(e.setIn([String(a),"_parent"],null),[String(r),"marks"],a):u(i&&l?g(e.setIn([String(a),"_parent"],n),[String(r),"marks"],a):e.setIn([String(a),"_parent"],n),[String(n),"marks"],a)}t.marksReducer=function(e,t){if(void 0===e)return a.Map();const n=t.meta;if(t.type===s.getType(o.baseCreateScene))return e.set(String(n),h(t));if(t.type===s.getType(l.baseAddMark))return f(e.set(String(n),h(t)),{parentId:t.payload.props?t.payload.props._parent:null,childId:n});if(t.type===s.getType(l.baseDeleteMark))return f(e,{childId:n,parentId:null}).remove(String(n));if(t.type===s.getType(l.setParent))return f(e,{parentId:t.payload,childId:n});if(t.type===s.getType(l.updateMarkProperty))return e.setIn([String(n),t.payload.property],t.payload.value);if(t.type===s.getType(l.setMarkVisual))return e.setIn([String(n),"encode","update",t.payload.property],t.payload.def);if(t.type===s.getType(l.disableMarkVisual))return e.setIn([String(n),"encode","update",t.payload,"_disabled"],!0);if(t.type===s.getType(l.resetMarkVisual)){const a=e.getIn([String(n),"type"]),s=t.payload;return e.setIn([String(n),"encode","update",s],{signal:p.propSg(n,a,s)})}if(t.type===s.getType(l.setMarkExtent))return e.setIn([String(n),"encode","update",t.payload.oldExtent,"_disabled"],!0).setIn([String(n),"encode","update",t.payload.newExtent,"_disabled"],!1);if(t.type===s.getType(l.setVlUnit))return e.setIn([String(n),"_vlUnit"],t.payload);if(t.type===s.getType(l.bindScale))return e.setIn([String(n),"encode","update",t.payload.property,"scale"],t.payload.scaleId);const y=t.meta;if(t.type===s.getType(r.addScaleToGroup))return u(e,[String(y),"scales"],t.payload);if(t.type===s.getType(r.addAxisToGroup))return m(e,[String(y),"axes"],t.payload);if(t.type===s.getType(r.addLegendToGroup))return m(e,[String(y),"legends"],t.payload);if(t.type===s.getType(r.addInteractionToGroup))return m(e,[String(y),"_interactions"],t.payload);if(t.type===s.getType(r.addWidgetToGroup))return m(e,[String(y),"_widgets"],t.payload);const v=t.meta;return t.type===s.getType(i.deleteGuide)?(e=g(e,[String(t.payload.groupId),"axes"],v),g(e,[String(t.payload.groupId),"legends"],v)):t.type===s.getType(c.deleteInteraction)?g(e,[String(t.payload.groupId),"_interactions"],v):t.type===s.getType(d.deleteWidget)?g(e,[String(t.payload.groupId),"_widgets"],v):e}},1166:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(46),r=n(315);t.pipelinesReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===s.getType(r.baseAddPipeline))return e.set(String(n),t.payload);if(t.type===s.getType(r.updatePipelineProperty)){const a=t.payload;return e.setIn([String(n),a.property],a.value)}if(t.type===s.getType(r.baseAggregatePipeline)){const a=t.payload;return void 0===a.dsId?e.deleteIn([String(n),"_aggregates",a.key]):e.setIn([String(n),"_aggregates",a.key],a.dsId)}return e}},1167:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(46),r=n(271);t.scalesReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===s.getType(r.baseAddScale)){let a=t.payload.set("name",function(e,t){t=t||"scale";const n=e.valueSeq().map(e=>e.get("name"));let a=2,s=t;for(;n.contains(s);)s=t+""+a++;return s}(e,t.payload.name));return e.set(String(n),a)}if(t.type===s.getType(r.updateScaleProperty)){const a=t.payload;try{return e.setIn([String(n),...a.property.split(".")],a.value)}catch(t){const s={};return s[a.property.split(".").slice(-1).toString()]=a.value,e.setIn([String(n),...a.property.split(".").slice(0,-1)],s)}}if(t.type===s.getType(r.amendDataRef)){const a=t.payload,s=e.getIn([String(n),a.property]);return e.setIn([String(n),a.property],s.push(a.ref))}return t.type===s.getType(r.deleteScale)?e.remove(String(n)):e}},1168:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(46),r=n(223);t.sceneReducer=function(e,t){return void 0===e?a.Map():t.type===s.getType(r.baseCreateScene)?e.set("_id",t.meta):e}},1169:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(46),r=n(201),i=n(67),l=n(268),o=n(88),c=n(168),d=n(222);function p(e,t,n){return e.set(t,o.Signal({name:d(t),value:n,_idx:e.size}))}function u(e,t,n){return e.setIn([t,"on"],n)}function m(e,t,n,a){return n?Object.keys(n).reduce(function(e,l){if(void 0===n[l]||void 0===n[l].value)return e;if(t.type===s.getType(r.baseAddGuide)){const s="guide",r=a+"_"+l;return p(e,c.propSg(t.meta,s,r),n[l].value)}if(t.type===s.getType(i.baseAddMark)){const a=t.payload.props.type,s=l,r=c.propSg(t.meta,a,s),i=t.payload.streams,o=p(e,r,n[l].value);return i&&i[r]?u(o,r,i[r]):o}},e):e}t.signalsReducer=function(e,t){if(void 0===e)return a.Map();if(t.type===s.getType(l.initSignal))return p(e,t.meta,t.payload);if(t.type===s.getType(l.baseSetSignal))return e.setIn([t.meta,"value"],t.payload);if(t.type===s.getType(l.setSignalStreams))return u(e,t.meta,t.payload);if(t.type===s.getType(l.unsetSignal))return e.remove(t.meta);if(t.type===s.getType(i.baseAddMark))return m(e,t,t.payload.props.encode&&t.payload.props.encode.update);if(t.type===s.getType(r.baseAddGuide)){const n=t.payload.encode;return Object.keys(n).forEach(function(a){e=m(e,t,n[a],a)}),e}return t.type===s.getType(i.baseDeleteMark)||t.type===s.getType(r.deleteGuide)?function(e,t){const n=t.type===s.getType(i.baseDeleteMark)?t.payload:"guide",a=new RegExp("^"+d(n+"_"+t.meta));return e.filter(function(e,t){return!a.test(t)})}(e,t):e}},1171:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(598),r=n(855);t.lyraGlobalsReducer=function(e,t){return void 0===e?s.LyraGlobals({idCounter:1}):t.type===a.getType(r.incrementCounter)?e.set("idCounter",e.get("idCounter")+1):e}},1172:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(876),r=n(881);t.walkthroughReducer=function(e,t){return void 0===e?r.Walkthrough():t.type===a.getType(s.setActiveStep)?e.set("activeStep",t.payload):t.type===a.getType(s.setActiveWalkthrough)?e.set("activeWalkthrough",t.payload):e}},1173:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data={example:n(1174),barChart:n(1175)}},1174:function(e){e.exports={title:"Example Walkthrough",image:"https://placeholdit.imgix.net/~text?txtsize=33&txt=150%C3%97150&w=150&h=150",alt_text:"an image",steps:[{id:1,title:"Step 1: Add a RECT",text:"Click on the RECT button in the toolbar to add a new Rect to the canvas",image:"http://fillmurray.com/g/150/150",alt_text:"an image",lyra_state:{},help:"If you are stuck, try clearing the scene."},{id:2,title:"Step 2: Change Color",text:"Select the RECT mark and then change it's color to #000000 in the property inspector",image:"http://fillmurray.com/150/150",alt_text:"an image",lyra_state:{marks:[{type:"rect"}]},help:"If you are stuck, try clearing the scene."},{id:3,title:"Step 2: Change color",text:"Select the RECT mark and then change it's stroke color to #ffffff",image:"http://fillmurray.com/g/150/150",alt_text:"an image",lyra_state:{marks:[{type:"rect",properties:{update:{fill:{value:"#000000"}}}}]},help:"If you are stuck, try clearing the scene."},{id:4,title:"Walkthrough complete!",text:"You did it!",image:"http://fillmurray.com/150/150",alt_text:"an image",lyra_state:{marks:[{type:"rect",properties:{update:{fill:{value:"#000000"},stroke:{value:"#ffffff"}}}}]}}]}},1175:function(e){e.exports={title:"Cool times",image:"https://placeholdit.imgix.net/~text?txtsize=33&txt=150%C3%97150&w=150&h=150",alt_text:"an image",steps:[{id:1,title:"Step 1: Add a SYMBOL",text:"Click on the SYMBOL button in the toolbar to add a new Rect to the canvas",image:"http://fillmurray.com/g/150/150",alt_text:"an image",lyra_state:{},help:"If you are stuck, try clearing the scene."},{id:2,title:"Step 2: Change symbol shape",text:"Select the SYMBOL and change it's SHAPE to CROSS",image:"http://fillmurray.com/150/150",alt_text:"an image",lyra_state:{marks:[{type:"symbol"}]},help:"If you are stuck, try clearing the scene."},{id:3,title:"Step 3: Change color and add RECT",text:"Select the SYMBOL mark and then change it's stroke color to #ffffff, then add a RECT mark and change it's fill to #000000",image:"http://fillmurray.com/g/150/150",alt_text:"an image",lyra_state:{marks:[{type:"symbol",properties:{update:{shape:{value:"cross"}}}}]},help:"If you are stuck, try clearing the scene."},{id:4,title:"Walkthrough complete!",text:"You did it!",image:"http://fillmurray.com/150/150",alt_text:"an image",lyra_state:{marks:[{type:"symbol",properties:{update:{shape:{value:"cross"},stroke:{value:"#ffffff"}}}},{type:"rect",properties:{update:{fill:{value:"#000000"}}}}]}}]}},1177:function(e,t,n){"use strict";n.r(t);var a=n(1068),s=n(1069),r=n(665),i=n(1070),l=n(1071),o=n(1072),c=n(23);const d=n(222),p=d("manipulators_"),u={[`${p}area`]:a.a,[`${p}group`]:r.a,[`${p}line`]:s.a,[`${p}rect`]:r.a,[`${p}symbol`]:i.a,[`${p}text`]:l.a,[d("bubble_cursor")]:o.a};Object.keys(u).forEach(e=>u[e].Definition.type=e),c.extend(c.transforms,u),t.default=u},1178:function(e,t,n){"use strict";var a=n(88),s=n(270),r=n(47),i=r.getIn,l=r.getInVis,o=n(420).parseVega;function c(e,t){var n=e.getState(),a=i(n,"vega.invalid"),s=l(n,"scene._id");if(a){if(!s)return!0;t.view&&(t.view.finalize(),t.view=null),e.dispatch(o(!0)),t.parse().then(function(){e.dispatch(o(!1))})}return a}function d(e,t){if(e){var n=t.signal(a.SELECTED);if(n){var r=n.mark.role,i=r&&+r.split("lyra_")[1],l=e.get("_id");if(l!==i){var o=[l].concat(s.getParentGroupIds(l)),c=s.findInItemTree(t.scenegraph().root.items[0],o);(t._running||Promise.resolve(!0)).then(function(){null!==c&&(t.signal(a.SELECTED,c),t.runAsync())})}}}}e.exports={createStoreListener:function(e,t){return function(){var n=c(e,t),a=e.getState(),s=i(a,"vega.isParsing");if(!n&&!s&&t.view&&t.view.signal&&"function"==typeof t.view.signal){var r=i(a,"inspector.encodings.selectedId"),o=l(a,"marks."+r);r&&o&&d(o,t.view)}}},_recreateVegaIfNecessary:c,_updateSelectedMarkInVega:d}},1179:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(426),r=n(33),i=n(227),l=n(203),o=n(1183),c=n(1239),d=n(1267),p=n(1296),u=n(1303);e.exports=s.render(a.createElement(r.Provider,{store:l.store},a.createElement("div",{className:"lyra-container"},a.createElement("div",{className:"sidebar-container"},a.createElement(o.EncodingsSidebar,null),a.createElement(c.InspectorSidebar,null)),a.createElement("div",{className:"main-container"},a.createElement(d.PipelinesToolbar,null),a.createElement("div",{className:"tools-container"},a.createElement("div",{className:"vis-container"},a.createElement("div",{id:"vis"}),a.createElement(u.default,null)),a.createElement(p.Toolbar,null))),a.createElement(i.default,{effect:"solid",delayShow:375,class:"tooltip",html:!0}))),document.querySelector(".app-container"))},1183:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(1184),r=n(1238);t.EncodingsSidebar=class extends a.Component{constructor(){super(...arguments),this.groupList=a.createRef(),this.scaleList=a.createRef()}render(){return a.createElement("div",{className:"sidebar",id:"visual-sidebar"},a.createElement(s.default,{ref:e=>this.groupList=e}),a.createElement(r.default,{ref:e=>this.scaleList=e}))}}},1184:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(91),i=n(67),l=n(223),o=n(421),c=n(73),d=n(1185),p=n(47).getInVis,u=n(74);t.default=s.connect(function(e){const t=p(e,"scene._id");return{sceneId:t,selectedId:e.getIn(["inspector","encodings","selectedId"]),selectedType:e.getIn(["inspector","encodings","selectedType"]),marks:p(e,"marks."+t+".marks")}},function(e){return{addMark:function(t,n){e(i.addMark(o.Mark(t,{_parent:n})))},selectMark:function(t){e(r.selectMark(t))},clearScene:function(){e(r.selectMark(null)),e(l.clearScene())}}})(class extends a.Component{render(){const e=this.props,t=e.sceneId,n=(e.selectedId===t&&(e.selectedType,r.InspectorSelectedType.SELECT_MARK),e.marks?e.marks:[]);return a.createElement("div",{id:"layer-list",className:"expandingMenu"},a.createElement("h2",null,"Groups",a.createElement("span",{className:"new",onClick:this.props.addMark.bind(null,"group",t)},a.createElement(c.Icon,{glyph:u.plus}))),a.createElement("ul",null,n.map(function(t){return a.createElement(d.default,Object.assign({key:t,id:t},e))},this)))}})},1185:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(227),i=n(91),l=n(67),o=n(73),c=n(1186),d=n(1232),p=n(1236),u=n(1237),m=n(317),g=n(47).getInVis,h=n(74);t.default=s.connect(function(e,t){return{expandedLayers:e.getIn(["inspector","encodings","expandedLayers"]),group:g(e,"marks."+t.id)}},function(e,t){return{selectGroup:function(){e(i.selectMark(t.id))},deleteGroup:function(n){const a=t.id;t.selectedId===a&&e(i.selectMark(t.sceneId)),e(l.deleteMark(a)),n.preventDefault(),n.stopPropagation(),r.default.hide()},updateName:function(n){e(l.updateMarkProperty({property:"name",value:n},t.id))},toggleGroup:function(){e(i.toggleLayers([t.id]))}}})(class extends a.Component{componentDidUpdate(){r.default.rebuild()}render(){const e=this.props,t=e.id,n=e.group,s=n.name,r=e.expandedLayers[t],l=r?"expanded":"contracted";return a.createElement("li",{className:l},a.createElement("div",{className:"name"+(e.selectedId===t&&e.selectedType===i.InspectorSelectedType.SELECT_MARK?" selected":""),onClick:e.selectGroup},a.createElement(o.Icon,{glyph:h["group-"+l],onClick:e.toggleGroup}),a.createElement(m,{value:s,save:e.updateName,onClick:e.selectGroup}),a.createElement(o.Icon,{glyph:h.trash,className:"delete",onClick:e.deleteGroup,"data-html":!0,"data-place":"right","data-tip":"Delete "+s+" and <br> everything inside it"})),r&&n.get("marks")?a.createElement("ul",{className:"group"},a.createElement(c.default,Object.assign({groupId:t},e)),a.createElement(d.default,Object.assign({groupId:t},e)),a.createElement(p.default,Object.assign({groupId:t},e)),a.createElement(u.default,Object.assign({groupId:t},e))):null)}})},1186:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(227),i=n(201),l=n(91),o=n(312),c=n(73),d=n(373),p=n(47).getInVis,u=n(74);t.default=s.connect(function(e,t){const n=t.groupId,a=p(e,"marks."+n+".axes"),s=p(e,"marks."+n+".legends");return{scales:p(e,"scales"),guides:a.concat(s).map(function(t){return p(e,"guides."+t)}).filter(function(e){return!!e})}},function(e,t){return{selectGuide:function(t){e(l.selectGuide(t))},deleteGuide:function(n,a,s){const o=t.groupId;n===a&&e(l.selectMark(o)),e(i.deleteGuide({groupId:o},a)),s.preventDefault(),s.stopPropagation(),r.default.hide()}}})(class extends a.Component{componentDidUpdate(){r.default.rebuild()}render(){const e=this.props,t=e.selectedId,n=e.selectedType;return a.createElement("div",null,a.createElement("li",{className:"header"},"Guides "),e.guides.map(function(s){const r=s._id;let i;s._gtype===o.GuideType.Axis?i=(s=s).scale:s._gtype===o.GuideType.Legend&&(i=(s=s)[s._type]);const p=d(e.scales.getIn([i,"name"])),m=d(s._gtype);return a.createElement("li",{key:r},a.createElement("div",{style:{paddingLeft:"26px"},className:"name"+(t===r&&n===l.InspectorSelectedType.SELECT_GUIDE?" selected":""),onClick:e.selectGuide.bind(null,r)},p+" "+m,a.createElement(c.Icon,{glyph:u.trash,className:"delete",onClick:e.deleteGuide.bind(null,t,r),"data-tip":"Delete "+p+" "+m,"data-place":"right"})))}))}})},1187:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"mark-group-open",use:"mark-group-open-usage",viewBox:"0 0 100 125",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 125" id="mark-group-open"><g transform="rotate(90 50 50)"><polygon points="14.019,14.02 85.981,50.004 14.019,85.98" /></g></symbol>'});s.add(r);e.exports=r},1188:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"mark-group-closed",use:"mark-group-closed-usage",viewBox:"0 0 100 125",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 125" id="mark-group-closed"><g><polygon points="14.019,14.02 85.981,50.004 14.019,85.98" /></g></symbol>'});s.add(r);e.exports=r},1189:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"mark-rect",use:"mark-rect-usage",viewBox:"0 0 14 17.5",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 14 17.5" id="mark-rect"><path fill-rule="evenodd" clip-rule="evenodd" d="M10,6v7c0,0.55,0.45,1,1,1h2c0.55,0,1-0.45,1-1V6c0-0.55-0.45-1-1-1h-2  C10.45,5,10,5.45,10,6z M5,1v12c0,0.55,0.45,1,1,1h2c0.55,0,1-0.45,1-1V1c0-0.55-0.45-1-1-1H6C5.45,0,5,0.45,5,1z M0,9v4  c0,0.55,0.45,1,1,1h2c0.55,0,1-0.45,1-1V9c0-0.55-0.45-1-1-1H1C0.45,8,0,8.45,0,9z" />\n\x3c!-- <text x="0" y="29" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Dilon Choudhury</text><text x="0" y="34" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});s.add(r);e.exports=r},1190:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"mark-line",use:"mark-line-usage",viewBox:"0 0 100 100",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" id="mark-line"><polygon stroke-width="2" points="8.744,100 0,97.362 17.2,35.373 60.077,52.269 91.799,0 99.607,4.739 63.892,63.589 23.08,47.506" /></symbol>'});s.add(r);e.exports=r},1191:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"mark-area",use:"mark-area-usage",viewBox:"0 0 111 122.5",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 111 122.5" id="mark-area"><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M10 86.0322264L29.5264445 51.6235581 45.3423478 59.340291 61.8834325 28.2855206 80.0690932 39.7393663 100 10 100 86.0322266 10 86.0322264ZM10 86.0322264" /></g>\n\x3c!-- <text x="0" y="113" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Pham Thi Dieu Linh</text><text x="0" y="118" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});s.add(r);e.exports=r},1192:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"mark-text",use:"mark-text-usage",viewBox:"0 0 24 30",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 30" id="mark-text"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.905 3.068c-1.076 0-1.903 0.364-2.47 1.091 -0.571 0.729-0.858 1.787-0.858 3.18v0.083H1.686V0h20.629v7.422h-2.863V7.339c0-1.383-0.288-2.438-0.861-3.17 -0.577-0.734-1.408-1.101-2.495-1.101h-0.852v16.47c0 0.75 0.098 1.224 0.298 1.407 0.198 0.186 0.647 0.278 1.338 0.278h1.637V24H5.629v-2.776h1.52c0.658 0 1.089-0.076 1.296-0.233 0.211-0.158 0.313-0.644 0.313-1.452V3.068H7.905z" />\n\x3c!-- <text x="0" y="39" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Plainicon</text><text x="0" y="44" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});s.add(r);e.exports=r},1193:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"mark-symbol",use:"mark-symbol-usage",viewBox:"0 0 100 125",content:'<symbol xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 125" id="mark-symbol"><title>Bars plot</title><g transform="translate(0,-952.36217)"><circle cx="39.75" cy="1028.3622" r="25" fill-opacity="1" stroke="none" /><circle cx="57.5" cy="982.86218" r="18" fill-opacity="1" stroke="none" /></g>\n\x3c!-- <text x="0" y="115" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Gonzalo Bravo</text><text x="0" y="120" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});s.add(r);e.exports=r},1194:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"trash",use:"trash-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="trash"><path d="M704 1376v-704q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v704q0 14 9 23t23 9h64q14 0 23-9t9-23zm256 0v-704q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v704q0 14 9 23t23 9h64q14 0 23-9t9-23zm256 0v-704q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v704q0 14 9 23t23 9h64q14 0 23-9t9-23zm-544-992h448l-48-117q-7-9-17-11h-317q-10 2-17 11zm928 32v64q0 14-9 23t-23 9h-96v948q0 83-47 143.5t-113 60.5h-832q-66 0-113-58.5t-47-141.5v-952h-96q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h309l70-167q15-37 54-63t79-26h320q40 0 79 26t54 63l70 167h309q14 0 23 9t9 23z" /></symbol>'});s.add(r);e.exports=r},1195:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"plus",use:"plus-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="plus"><path d="M1600 736v192q0 40-28 68t-68 28h-416v416q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-416h-416q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h416v-416q0-40 28-68t68-28h192q40 0 68 28t28 68v416h416q40 0 68 28t28 68z" /></symbol>'});s.add(r);e.exports=r},1196:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"undo",use:"undo-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="undo"><path d="M1664 896q0 156-61 298t-164 245-245 164-298 61q-172 0-327-72.5t-264-204.5q-7-10-6.5-22.5t8.5-20.5l137-138q10-9 25-9 16 2 23 12 73 95 179 147t225 52q104 0 198.5-40.5t163.5-109.5 109.5-163.5 40.5-198.5-40.5-198.5-109.5-163.5-163.5-109.5-198.5-40.5q-98 0-188 35.5t-160 101.5l137 138q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59 39-17 69 14l130 129q107-101 244.5-156.5t284.5-55.5q156 0 298 61t245 164 164 245 61 298z" /></symbol>'});s.add(r);e.exports=r},1197:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"redo",use:"redo-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="redo"><path d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5 163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0 225-52t179-147q7-10 23-12 14 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109 132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298 164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14 39 17 39 59z" /></symbol>'});s.add(r);e.exports=r},1198:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"type-nominal",use:"type-nominal-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="type-nominal"><path d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0 57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29 31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15 34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 4-.5 13t-.5 13q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0 12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11 2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0 22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58 0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z" /></symbol>'});s.add(r);e.exports=r},1199:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"type-ordinal",use:"type-ordinal-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="type-ordinal"><path d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0 57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29 31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15 34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 4-.5 13t-.5 13q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0 12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11 2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0 22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58 0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z" /></symbol>'});s.add(r);e.exports=r},1200:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"type-quantitative",use:"type-quantitative-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="type-quantitative"><path d="M991 1024l64-256h-254l-64 256h254zm768-504l-56 224q-7 24-31 24h-327l-64 256h311q15 0 25 12 10 14 6 28l-56 224q-5 24-31 24h-327l-81 328q-7 24-31 24h-224q-16 0-26-12-9-12-6-28l78-312h-254l-81 328q-7 24-31 24h-225q-15 0-25-12-9-12-6-28l78-312h-311q-15 0-25-12-9-12-6-28l56-224q7-24 31-24h327l64-256h-311q-15 0-25-12-10-14-6-28l56-224q5-24 31-24h327l81-328q7-24 32-24h224q15 0 25 12 9 12 6 28l-78 312h254l81-328q7-24 32-24h224q15 0 25 12 9 12 6 28l-78 312h311q15 0 25 12 9 12 6 28z" /></symbol>'});s.add(r);e.exports=r},1201:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"type-temporal",use:"type-temporal-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="type-temporal"><path d="M192 1664h288v-288h-288v288zm352 0h320v-288h-320v288zm-352-352h288v-320h-288v320zm352 0h320v-320h-320v320zm-352-384h288v-288h-288v288zm736 736h320v-288h-320v288zm-384-736h320v-288h-320v288zm768 736h288v-288h-288v288zm-384-352h320v-320h-320v320zm-352-864v-288q0-13-9.5-22.5t-22.5-9.5h-64q-13 0-22.5 9.5t-9.5 22.5v288q0 13 9.5 22.5t22.5 9.5h64q13 0 22.5-9.5t9.5-22.5zm736 864h288v-320h-288v320zm-384-384h320v-288h-320v288zm384 0h288v-288h-288v288zm32-480v-288q0-13-9.5-22.5t-22.5-9.5h-64q-13 0-22.5 9.5t-9.5 22.5v288q0 13 9.5 22.5t22.5 9.5h64q13 0 22.5-9.5t9.5-22.5zm384-64v1280q0 52-38 90t-90 38h-1408q-52 0-90-38t-38-90v-1280q0-52 38-90t90-38h128v-96q0-66 47-113t113-47h64q66 0 113 47t47 113v96h384v-96q0-66 47-113t113-47h64q66 0 113 47t47 113v96h128q52 0 90 38t38 90z" /></symbol>'});s.add(r);e.exports=r},1202:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"prev",use:"prev-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="prev"><path d="M1664 896v128q0 53-32.5 90.5t-84.5 37.5h-704l293 294q38 36 38 90t-38 90l-75 76q-37 37-90 37-52 0-91-37l-651-652q-37-37-37-90 0-52 37-91l651-650q38-38 91-38 52 0 90 38l75 74q38 38 38 91t-38 91l-293 293h704q52 0 84.5 37.5t32.5 90.5z" /></symbol>'});s.add(r);e.exports=r},1203:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"next",use:"next-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="next"><path d="M1600 960q0 54-37 91l-651 651q-39 37-91 37-51 0-90-37l-75-75q-38-38-38-91t38-91l293-293h-704q-52 0-84.5-37.5t-32.5-90.5v-128q0-53 32.5-90.5t84.5-37.5h704l-293-294q-38-36-38-90t38-90l75-75q38-38 90-38 53 0 91 38l651 651q37 35 37 90z" /></symbol>'});s.add(r);e.exports=r},1204:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"close",use:"close-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="close"><path d="M1490 1322q0 40-28 68l-136 136q-28 28-68 28t-68-28l-294-294-294 294q-28 28-68 28t-68-28l-136-136q-28-28-28-68t28-68l294-294-294-294q-28-28-28-68t28-68l136-136q28-28 68-28t68 28l294 294 294-294q28-28 68-28t68 28l136 136q28 28 28 68t-28 68l-294 294 294 294q28 28 28 68z" /></symbol>'});s.add(r);e.exports=r},1205:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"hamburger",use:"hamburger-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="hamburger"><path d="M1664 1344v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zm0-512v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zm0-512v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45z" /></symbol>'});s.add(r);e.exports=r},1206:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"erase",use:"erase-usage",viewBox:"0 0 24 24",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" id="erase"><path d="M13.2,3.5L8,8.7l7.2,7.2l5.2-5.2c0.7-0.7,0.7-1.9,0-2.6l-4.6-4.6C15.1,2.8,13.9,2.8,13.2,3.5z" /><path fill="none" stroke="#000000" stroke-width="2" stroke-linejoin="round" stroke-miterlimit="10" d="M11.3,20l9.2-9.2  c0.7-0.7,0.7-1.9,0-2.6l-4.6-4.6c-0.7-0.7-1.9-0.7-2.6,0l-9.7,9.7c-0.7,0.7-0.7,1.9,0,2.6L7.7,20l0,0H22" /></symbol>'});s.add(r);e.exports=r},1207:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"export",use:"export-usage",viewBox:"0 0 16 20",content:'<symbol xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:a="http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/" viewBox="0 0 16 20" overflow="visible" id="export"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"></foreignObject><g i:extraneous="self"><g i:layer="yes" i:dimmedPercent="50" i:rgbTrio="#4F008000FFFF"><path i:knockout="Off" d="M9,0v2h3L7,7l2,2l5-5v3h2V0H9z M14,14H2V2h4V0H0v16h16v-6h-2V14z" /></g></g></switch>\n\x3c!-- <text x="0" y="31" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Tahsin Tahil</text><text x="0" y="36" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});s.add(r);e.exports=r},1208:function(e,t){e.exports='<html>\n  <head>\n    <title>Vega Scaffold</title>\n    <script src="https://cdn.jsdelivr.net/npm/vega@5"><\/script>\n    <script src="https://cdn.jsdelivr.net/npm/vega-lite@4"><\/script>\n    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"><\/script>\n  </head>\n  <body>\n    <div id="vis"></div>\n  </body>\n  <script type="text/javascript">\n  // parse a spec and create a visualization view\n  function parse(spec) {\n    vegaEmbed(\'#vis\', spec);\n  }\n  parse(INJECT_SPEC);\n  <\/script>\n</html>'},1209:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"select",use:"select-usage",viewBox:"0 0 512 512",content:'<symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="select"><g><path d="m106 120c8.284 0 15-6.716 15-15 0-41.355 33.645-75 75-75s75 33.645 75 75c0 8.284 6.716 15 15 15s15-6.716 15-15c0-57.897-47.103-105-105-105s-105 47.103-105 105c0 8.284 6.716 15 15 15z" /><path d="m159.292 510.417c2.083 1.041 4.379 1.583 6.708 1.583h210c3.979 0 7.793-1.58 10.607-4.394 22.179-22.179 34.393-51.667 34.393-83.032v-137.574c0-24.813-20.187-45-45-45-5.857 0-11.449 1.137-16.586 3.181-5.205-19.096-22.691-33.181-43.414-33.181-5.857 0-11.449 1.137-16.586 3.181-5.205-19.096-22.691-33.181-43.414-33.181-5.258 0-10.305.915-15 2.58v-79.58c0-24.813-20.187-45-45-45s-45 20.187-45 45v167h-15c-24.813 0-45 20.187-45 45v82.918c0 22.96 6.38 45.419 18.451 64.949 12.07 19.531 29.305 35.281 49.841 45.55zm-38.292-193.417c0-8.271 6.729-15 15-15h15v64.486c0 8.284 6.716 15 15 15s15-6.716 15-15v-261.486c0-8.271 6.729-15 15-15s15 6.729 15 15v212c0 8.284 6.716 15 15 15s15-6.716 15-15v-90c0-8.271 6.729-15 15-15s15 6.729 15 15v90c0 8.284 6.716 15 15 15s15-6.716 15-15v-60c0-8.271 6.729-15 15-15s15 6.729 15 15v60c0 8.284 6.716 15 15 15s15-6.716 15-15v-30c0-8.271 6.729-15 15-15s15 6.729 15 15v137.574c0 21.337-7.593 41.508-21.499 57.426h-199.824c-30.115-16.423-48.677-47.565-48.677-82.082z" /></g></symbol>'});s.add(r);e.exports=r},1210:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"sort",use:"sort-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="sort"><path d="M1408 1088q0 26-19 45l-448 448q-19 19-45 19t-45-19l-448-448q-19-19-19-45t19-45 45-19h896q26 0 45 19t19 45zm0-384q0 26-19 45t-45 19h-896q-26 0-45-19t-19-45 19-45l448-448q19-19 45-19t45 19l448 448q19 19 19 45z" /></symbol>'});s.add(r);e.exports=r},1211:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"sort-alpha-asc",use:"sort-alpha-asc-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="sort-alpha-asc"><path d="M1255 408h177l-72-218-12-47q-2-16-2-20h-4l-3 20q0 1-3.5 18t-7.5 29zm-455 1032q0 12-10 24l-319 319q-10 9-23 9-12 0-23-9l-320-320q-15-16-7-35 8-20 30-20h192v-1376q0-14 9-23t23-9h192q14 0 23 9t9 23v1376h192q14 0 23 9t9 23zm836 119v233h-584v-90l369-529q12-18 21-27l11-9v-3q-2 0-6.5.5t-7.5.5q-12 3-30 3h-232v115h-120v-229h567v89l-369 530q-6 8-21 26l-11 11v2l14-2q9-2 30-2h248v-119h121zm89-897v106h-288v-106h75l-47-144h-243l-47 144h75v106h-287v-106h70l230-662h162l230 662h70z" /></symbol>'});s.add(r);e.exports=r},1212:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"sort-alpha-desc",use:"sort-alpha-desc-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="sort-alpha-desc"><path d="M1255 1432h177l-72-218-12-47q-2-16-2-20h-4l-3 20q0 1-3.5 18t-7.5 29zm-455 8q0 12-10 24l-319 319q-10 9-23 9-12 0-23-9l-320-320q-15-16-7-35 8-20 30-20h192v-1376q0-14 9-23t23-9h192q14 0 23 9t9 23v1376h192q14 0 23 9t9 23zm925 246v106h-288v-106h75l-47-144h-243l-47 144h75v106h-287v-106h70l230-662h162l230 662h70zm-89-1151v233h-584v-90l369-529q12-18 21-27l11-9v-3q-2 0-6.5.5t-7.5.5q-12 3-30 3h-232v115h-120v-229h567v89l-369 530q-6 8-21 26l-11 10v3l14-3q9-1 30-1h248v-119h121z" /></symbol>'});s.add(r);e.exports=r},1213:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"sort-numeric-asc",use:"sort-numeric-asc-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="sort-numeric-asc"><path d="M1474 1313q0-63-44-116t-103-53q-52 0-83 37t-31 94 36.5 95 104.5 38q50 0 85-27t35-68zm-610 127q0 12-10 24l-319 319q-10 9-23 9-12 0-23-9l-320-320q-15-16-7-35 8-20 30-20h192v-1376q0-14 9-23t23-9h192q14 0 23 9t9 23v1376h192q14 0 23 9t9 23zm750-69q0 62-13 121.5t-41 114-68 95.5-98.5 65.5-127.5 24.5q-62 0-108-16-24-8-42-15l39-113q15 7 31 11 37 13 75 13 84 0 134.5-58.5t66.5-145.5h-2q-21 23-61.5 37t-84.5 14q-106 0-173-71.5t-67-172.5q0-105 72-178t181-73q123 0 205 94.5t82 252.5zm-30-717v114h-469v-114h167v-432q0-7 .5-19t.5-17v-16h-2l-7 12q-8 13-26 31l-62 58-82-86 192-185h123v654h165z" /></symbol>'});s.add(r);e.exports=r},1214:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"sort-numeric-desc",use:"sort-numeric-desc-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="sort-numeric-desc"><path d="M1474 289q0-63-44-116t-103-53q-52 0-83 37t-31 94 36.5 95 104.5 38q50 0 85-27t35-68zm-610 1151q0 12-10 24l-319 319q-10 9-23 9-12 0-23-9l-320-320q-15-16-7-35 8-20 30-20h192v-1376q0-14 9-23t23-9h192q14 0 23 9t9 23v1376h192q14 0 23 9t9 23zm720 238v114h-469v-114h167v-432q0-7 .5-19t.5-17v-16h-2l-7 12q-8 13-26 31l-62 58-82-86 192-185h123v654h165zm30-1331q0 62-13 121.5t-41 114-68 95.5-98.5 65.5-127.5 24.5q-62 0-108-16-24-8-42-15l39-113q15 7 31 11 37 13 75 13 84 0 134.5-58.5t66.5-145.5h-2q-21 23-61.5 37t-84.5 14q-106 0-173-71.5t-67-172.5q0-105 72-178t181-73q123 0 205 94.5t82 252.5z" /></symbol>'});s.add(r);e.exports=r},1215:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"filter",use:"filter-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="filter"><path d="M1595 295q17 41-14 70l-493 493v742q0 42-39 59-13 5-25 5-27 0-45-19l-256-256q-19-19-19-45v-486l-493-493q-31-29-14-70 17-39 59-39h1280q42 0 59 39z" /></symbol>'});s.add(r);e.exports=r},1216:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"lookup",use:"lookup-usage",viewBox:"0 0 100 125",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 125" id="lookup">\n  <path d="M98.079,85.956l-2.587-2.587c1.271-1.913,1.963-4.161,1.963-6.503v-64.64C97.456,5.705,92.15,0.4,85.629,0.4H11.981  C5.46,0.4,0.154,5.705,0.154,12.226v64.64c0,6.521,5.305,11.827,11.827,11.827h65.08l9.141,9.141  c1.138,1.139,2.653,1.766,4.263,1.766s3.124-0.627,4.262-1.766l3.352-3.351c1.139-1.139,1.766-2.653,1.766-4.263  C99.846,88.609,99.219,87.094,98.079,85.956z M4.167,12.226c0-4.309,3.505-7.814,7.814-7.814h73.648  c4.309,0,7.814,3.505,7.814,7.814v6.82H4.167V12.226z M32.597,84.681V73.214c0-1.108-0.898-2.006-2.006-2.006  s-2.006,0.898-2.006,2.006V84.68H11.981c-4.309,0-7.814-3.505-7.814-7.814v-8.328H24.73c1.108,0,2.006-0.898,2.006-2.006  s-0.898-2.006-2.006-2.006H4.167V43.461H24.73c1.108,0,2.006-0.898,2.006-2.006s-0.898-2.006-2.006-2.006H4.167v-16.39h24.418  v12.465c0,1.108,0.898,2.006,2.006,2.006s2.006-0.898,2.006-2.006V23.059h60.846v14.383h-8.526c-1.108,0-2.006,0.898-2.006,2.006  s0.898,2.006,2.006,2.006h8.526v21.065h-8.526c-1.108,0-2.006,0.898-2.006,2.006c0,1.108,0.898,2.006,2.006,2.006h8.526v10.335  c0,1.264-0.305,2.487-0.873,3.581L79.347,67.224c4.6-9.527,2.96-21.336-4.932-29.229c-9.972-9.973-26.201-9.973-36.174,0  s-9.973,26.201,0,36.174c4.987,4.986,11.537,7.479,18.087,7.479c3.818,0,7.634-0.853,11.142-2.547l5.579,5.579L32.597,84.681  L32.597,84.681z M71.578,71.333c-8.409,8.408-22.091,8.408-30.501,0c-8.408-8.409-8.408-22.092,0-30.501  c4.204-4.204,9.727-6.306,15.25-6.306s11.046,2.102,15.25,6.306C79.986,49.241,79.986,62.924,71.578,71.333z M95.243,91.645  l-3.353,3.352c-0.761,0.763-2.089,0.761-2.851,0L71.042,77c1.184-0.833,2.316-1.772,3.374-2.83s1.997-2.19,2.83-3.374l17.997,17.997  c0.381,0.381,0.591,0.888,0.591,1.426C95.833,90.757,95.624,91.263,95.243,91.645z" />\n  \x3c!-- <text x="0" y="115" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by akash k</text><text x="0" y="120" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});s.add(r);e.exports=r},1217:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"formula",use:"formula-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="formula"><path d="M384 1536q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm384 0q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm-384-384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm768 384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm-384-384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm-384-384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm768 384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm-384-384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm768 768v-384q0-52-38-90t-90-38-90 38-38 90v384q0 52 38 90t90 38 90-38 38-90zm-384-768q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm384-320v-256q0-26-19-45t-45-19h-1280q-26 0-45 19t-19 45v256q0 26 19 45t45 19h1280q26 0 45-19t19-45zm0 320q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm128-640v1536q0 52-38 90t-90 38h-1408q-52 0-90-38t-38-90v-1536q0-52 38-90t90-38h1408q52 0 90 38t38 90z" /></symbol>'});s.add(r);e.exports=r},1218:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"aggregate",use:"aggregate-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="aggregate"><path d="M576 736v192q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h192q40 0 68 28t28 68zm512 0v192q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h192q40 0 68 28t28 68zm512 0v192q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h192q40 0 68 28t28 68z" /></symbol>'});s.add(r);e.exports=r},1219:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"download",use:"download-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="download"><path d="M1344 1344q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm256 0q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm128-224v320q0 40-28 68t-68 28h-1472q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h465l135 136q58 56 136 56t136-56l136-136h464q40 0 68 28t28 68zm-325-569q17 41-14 70l-448 448q-18 19-45 19t-45-19l-448-448q-31-29-14-70 17-39 59-39h256v-448q0-26 19-45t45-19h256q26 0 45 19t19 45v448h256q42 0 59 39z" /></symbol>'});s.add(r);e.exports=r},1220:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"bold",use:"bold-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="bold"><path d="M747 1521q74 32 140 32 376 0 376-335 0-114-41-180-27-44-61.5-74t-67.5-46.5-80.5-25-84-10.5-94.5-2q-73 0-101 10 0 53-.5 159t-.5 158q0 8-1 67.5t-.5 96.5 4.5 83.5 12 66.5zm-14-746q42 7 109 7 82 0 143-13t110-44.5 74.5-89.5 25.5-142q0-70-29-122.5t-79-82-108-43.5-124-14q-50 0-130 13 0 50 4 151t4 152q0 27-.5 80t-.5 79q0 46 1 69zm-541 889l2-94q15-4 85-16t106-27q7-12 12.5-27t8.5-33.5 5.5-32.5 3-37.5.5-34v-65.5q0-982-22-1025-4-8-22-14.5t-44.5-11-49.5-7-48.5-4.5-30.5-3l-4-83q98-2 340-11.5t373-9.5q23 0 68.5.5t67.5.5q70 0 136.5 13t128.5 42 108 71 74 104.5 28 137.5q0 52-16.5 95.5t-39 72-64.5 57.5-73 45-84 40q154 35 256.5 134t102.5 248q0 100-35 179.5t-93.5 130.5-138 85.5-163.5 48.5-176 14q-44 0-132-3t-132-3q-106 0-307 11t-231 12z" /></symbol>'});s.add(r);e.exports=r},1221:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"italic",use:"italic-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="italic"><path d="M384 1662l17-85q6-2 81.5-21.5t111.5-37.5q28-35 41-101 1-7 62-289t114-543.5 52-296.5v-25q-24-13-54.5-18.5t-69.5-8-58-5.5l19-103q33 2 120 6.5t149.5 7 120.5 2.5q48 0 98.5-2.5t121-7 98.5-6.5q-5 39-19 89-30 10-101.5 28.5t-108.5 33.5q-8 19-14 42.5t-9 40-7.5 45.5-6.5 42q-27 148-87.5 419.5t-77.5 355.5q-2 9-13 58t-20 90-16 83.5-6 57.5l1 18q17 4 185 31-3 44-16 99-11 0-32.5 1.5t-32.5 1.5q-29 0-87-10t-86-10q-138-2-206-2-51 0-143 9t-121 11z" /></symbol>'});s.add(r);e.exports=r},1222:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"open",use:"open-usage",viewBox:"10 25 80 50",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="10 25 80 50" id="open"><title>12.5</title><desc>Created with Sketch.</desc><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><path d="M84.3765045,45.2316481 L77.2336539,75.2316205 L77.2336539,75.2316205 C77.1263996,75.6820886 76.7239081,76 76.2608477,76 L17.8061496,76 C17.2538649,76 16.8061496,75.5522847 16.8061496,75 C16.8061496,74.9118841 16.817796,74.8241548 16.8407862,74.739091 L24.7487983,45.4794461 C24.9845522,44.607157 25.7758952,44.0012839 26.6794815,44.0012642 L83.4036764,44.0000276 L83.4036764,44.0000276 C83.9559612,44.0000156 84.4036862,44.4477211 84.4036982,45.0000058 C84.4036999,45.0780163 84.3945733,45.155759 84.3765045,45.2316481 L84.3765045,45.2316481 Z M15,24 L26.8277004,24 L26.8277004,24 C27.0616369,24 27.2881698,24.0820162 27.4678848,24.2317787 L31.799078,27.8411064 L31.799078,27.8411064 C32.697653,28.5899189 33.8303175,29 35,29 L75,29 C75.5522847,29 76,29.4477153 76,30 L76,38 L76,38 C76,38.5522847 75.5522847,39 75,39 L25.3280454,39 L25.3280454,39 C23.0690391,39 21.0906235,40.5146929 20.5012284,42.6954549 L14.7844016,63.8477139 L14.7844016,63.8477139 C14.7267632,64.0609761 14.5071549,64.1871341 14.2938927,64.1294957 C14.1194254,64.0823423 13.9982484,63.9240598 13.9982563,63.7433327 L13.9999561,25 L14,25 C14.0000242,24.4477324 14.4477324,24.0000439 15,24.0000439 L15,24 Z" /></g></g>\n\x3c!-- <text x="0" y="115" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Landan Lloyd</text><text x="0" y="120" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});s.add(r);e.exports=r},1223:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"save",use:"save-usage",viewBox:"0 0 362 372.5",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 362 372.5" fill-rule="evenodd" id="save"><g><path class="fil0" d="M24 0l54 0 0 114 206 0 0 -114 27 0 51 55 0 284c0,13 -10,23 -23,23l-315 0c-13,0 -24,-10 -24,-23l0 -315c0,-13 11,-24 24,-24zm24 152l266 0 0 189 -266 0 0 -189z" /><rect class="fil0" x="208" y="1" width="50.8754" height="78.352" /><rect class="fil0" x="79" y="181" width="204.238" height="22.2849" /><rect class="fil0" x="79" y="238" width="204.238" height="22.2849" /><rect class="fil0" x="79" y="294" width="204.238" height="22.2849" /></g>\n\x3c!-- <text x="0" y="377" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Ghiyats Mujtaba</text><text x="0" y="382" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});s.add(r);e.exports=r},1224:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"exclamation",use:"exclamation-usage",viewBox:"0 0 27.963 27.963",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 27.963 27.963" id="exclamation">\r\n<g>\r\n\t<g id="exclamation_c129_exclamation">\r\n\t\t<path d="M13.983,0C6.261,0,0.001,6.259,0.001,13.979c0,7.724,6.26,13.984,13.982,13.984s13.98-6.261,13.98-13.984\r\n\t\t\tC27.963,6.259,21.705,0,13.983,0z M13.983,26.531c-6.933,0-12.55-5.62-12.55-12.553c0-6.93,5.617-12.548,12.55-12.548\r\n\t\t\tc6.931,0,12.549,5.618,12.549,12.548C26.531,20.911,20.913,26.531,13.983,26.531z" />\r\n\t\t<polygon points="15.579,17.158 16.191,4.579 11.804,4.579 12.414,17.158 \t\t" />\r\n\t\t<path d="M13.998,18.546c-1.471,0-2.5,1.029-2.5,2.526c0,1.443,0.999,2.528,2.444,2.528h0.056c1.499,0,2.469-1.085,2.469-2.528\r\n\t\t\tC16.441,19.575,15.468,18.546,13.998,18.546z" />\r\n\t</g>\r\n</g>\r\n</symbol>'});s.add(r);e.exports=r},1225:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"book",use:"book-usage",viewBox:"0 0 490 490",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 490 490" id="book">\r\n<g>\r\n\t<path d="M457.237,268.54c0-55.995-37.268-103.405-88.283-118.842V72.963c-30.834-16.626-61.672-22.16-89.061-22.16\r\n\t\tc-54.542,0-95.416,21.944-95.416,21.944s-40.88-21.941-95.415-21.944C61.669,50.801,30.84,56.334,0,72.963v277.614\r\n\t\tc0,0,40.52-21.943,95.174-21.943c27.332,0,58.192,5.483,89.302,21.943c14.627-7.738,29.188-12.98,43.368-16.438\r\n\t\tc21.963,35.094,60.861,58.561,105.232,58.561c25.538,0,49.291-7.767,69.048-21.04l65.983,67.537L490,417.784l-64.788-66.315\r\n\t\tC445.047,329.457,457.237,300.431,457.237,268.54z M30.625,306.681V92.404c18.308-7.292,37.892-10.977,58.434-10.976\r\n\t\tc42.756,0.003,75.954,15.833,80.111,17.899v211.435c-23.53-8.321-48.256-12.754-73.996-12.754\r\n\t\tC70.577,298.008,48.457,301.916,30.625,306.681z M214.75,306.119c-5.027,1.378-10.016,2.88-14.955,4.551V99.324\r\n\t\tc4.712-2.335,37.702-17.897,80.097-17.897c20.544,0,40.129,3.685,58.436,10.976v52.228c-1.755-0.074-3.479-0.266-5.251-0.266\r\n\t\tc-68.473,0-124.175,55.702-124.175,124.175C208.902,281.639,210.972,294.255,214.75,306.119z M261.841,329.022\r\n\t\tc-7.228-8.498-12.908-18.31-16.748-29.009c-3.537-9.853-5.565-20.418-5.565-31.473c0-51.583,41.96-93.55,93.55-93.55\r\n\t\tc1.773,0,3.503,0.168,5.251,0.266c10.786,0.603,21.111,2.947,30.625,6.915c33.817,14.105,57.658,47.495,57.658,86.368\r\n\t\tc0,51.575-41.96,93.535-93.535,93.535C304.553,362.075,279.013,349.209,261.841,329.022z" />\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n</symbol>'});s.add(r);e.exports=r},1226:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"align-left",use:"align-left-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="align-left"><path d="M1792 1344v128q0 26-19 45t-45 19h-1664q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1664q26 0 45 19t19 45zm-384-384v128q0 26-19 45t-45 19h-1280q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1280q26 0 45 19t19 45zm256-384v128q0 26-19 45t-45 19h-1536q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1536q26 0 45 19t19 45zm-384-384v128q0 26-19 45t-45 19h-1152q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1152q26 0 45 19t19 45z" /></symbol>'});s.add(r);e.exports=r},1227:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"align-center",use:"align-center-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="align-center"><path d="M1792 1344v128q0 26-19 45t-45 19h-1664q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1664q26 0 45 19t19 45zm-384-384v128q0 26-19 45t-45 19h-896q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h896q26 0 45 19t19 45zm256-384v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zm-384-384v128q0 26-19 45t-45 19h-640q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h640q26 0 45 19t19 45z" /></symbol>'});s.add(r);e.exports=r},1228:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"align-right",use:"align-right-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="align-right"><path d="M1792 1344v128q0 26-19 45t-45 19h-1664q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1664q26 0 45 19t19 45zm0-384v128q0 26-19 45t-45 19h-1280q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1280q26 0 45 19t19 45zm0-384v128q0 26-19 45t-45 19h-1536q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1536q26 0 45 19t19 45zm0-384v128q0 26-19 45t-45 19h-1152q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1152q26 0 45 19t19 45z" /></symbol>'});s.add(r);e.exports=r},1229:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"vertical-align-bottom",use:"vertical-align-bottom-usage",viewBox:"0 0 100 125",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 125" id="vertical-align-bottom"><path d="M100,95.833V4.167C100,0,100,0,95.833,0H4.167C0,0,0,0,0,4.167v91.667C0,100,0,100,4.167,100h91.667  C100,100,100,100,100,95.833z M70.833,58.333L50,83.333l-20.833-25H70.833z M43.75,0h12.5v58.333h-12.5V0z" />\n\x3c!-- <text x="0" y="115" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Thomas Helbig</text><text x="0" y="120" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});s.add(r);e.exports=r},1230:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"vertical-align-center",use:"vertical-align-center-usage",viewBox:"0 0 100 125",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 125" id="vertical-align-center"><path d="M100,95.833V4.167C100,0,100,0,95.833,0H4.167C0,0,0,0,0,4.167v91.667C0,100,0,100,4.167,100h91.667  C100,100,100,100,100,95.833z M70.833,20.833L50,45.833l-20.833-25H70.833z M70.833,79.167H29.167l20.833-25L70.833,79.167z   M43.75,0h12.5v20.833h-12.5V0z M56.25,100h-12.5V79.167h12.5V100z" />\n\x3c!-- <text x="0" y="115" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Thomas Helbig</text><text x="0" y="120" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});s.add(r);e.exports=r},1231:function(e,t,n){var a=n(36),s=n(37),r=new a({id:"vertical-align-top",use:"vertical-align-top-usage",viewBox:"0 0 100 125",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 125" id="vertical-align-top"><path d="M100,95.833V4.167C100,0,100,0,95.833,0H4.167C0,0,0,0,0,4.167v91.667C0,100,0,100,4.167,100h91.667  C100,100,100,100,100,95.833z M56.25,100h-12.5V41.667h12.5V100z M70.833,41.667H29.167l20.833-25L70.833,41.667z" />\n\x3c!-- <text x="0" y="115" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Thomas Helbig</text><text x="0" y="120" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});s.add(r);e.exports=r},1232:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(227),i=n(91),l=n(67),o=n(73),c=n(47).getInVis,d=n(317),p=n(74);t.default=s.connect(function(e,t){return{marks:c(e,"marks."+t.groupId+".marks").map(function(t){return c(e,"marks."+t)})}},function(e,t){return{selectMark:function(t){e(i.selectMark(t))},deleteMark:function(n,a,s){n===a&&e(i.selectMark(t.groupId)),e(l.deleteMark(a)),s.preventDefault(),s.stopPropagation(),r.default.hide()},updateName:function(t,n){e(l.updateMarkProperty({property:"name",value:n},t))}}})(class extends a.Component{componentDidUpdate(){r.default.rebuild()}render(){const e=this.props,t=e.selectedId,n=e.selectedType;return a.createElement("div",null,a.createElement("li",{className:"header"},"Marks "),e.marks.map(function(s){if(!s)return;const r=s._id,l=s.name;return a.createElement("li",{key:r},a.createElement("div",{className:"name"+(t===r&&n===i.InspectorSelectedType.SELECT_MARK?" selected":""),onClick:e.selectMark.bind(null,r)},a.createElement(o.Icon,{glyph:p[s.type]}),a.createElement(d,{value:l,save:e.updateName.bind(null,r),onClick:e.selectMark.bind(null,r)}),a.createElement(o.Icon,{glyph:p.trash,className:"delete",onClick:e.deleteMark.bind(null,t,r),"data-tip":"Delete "+l,"data-place":"right"})))},this))}})},1236:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(227),i=n(91),l=n(73),o=n(224),c=n(143),d=n(142),p=n(317),u=n(74),m=n(72);t.default=s.connect(function(e,t){const n=d.getScaleInfoForGroup(e,t.groupId),a=e.getIn(["vega","isParsing"]),s=Boolean(!a&&m.view&&(n.xScaleName&&n.xFieldName||n.yScaleName&&n.yFieldName)),r=e.getIn(["vis","present","marks",String(t.groupId),"_interactions"]);return{interactions:r?r.map(function(t){return e.getIn(["vis","present","interactions",String(t)])}):[],canDemonstrate:s}},function(e){return{addInteraction:t=>{const n=o.Interaction({groupId:t});e(c.addInteraction(n))},selectInteraction:function(t){e(i.selectInteraction(t))},deleteInteraction:function(t,n,a,s){t===a&&e(i.selectMark(n)),e(c.deleteInteraction({groupId:n},a)),s.preventDefault(),s.stopPropagation(),r.default.hide()},updateName:function(t,n){e(c.updateInteractionName(n,t))}}})(class extends a.Component{componentDidUpdate(){r.default.rebuild()}render(){const e=this.props,t=e.selectedId,n=e.selectedType;return a.createElement("div",{className:"interaction-list"},a.createElement("li",{className:"header"},"Interactions ",this.props.canDemonstrate?a.createElement(l.Icon,{glyph:u.plus,onClick:()=>this.props.addInteraction(this.props.groupId)}):null),e.interactions.map(function(s){const r=s.id,o=s.name;return a.createElement("li",{key:r},a.createElement("div",{className:"name"+(t===r&&n===i.InspectorSelectedType.SELECT_INTERACTION?" selected":""),onClick:e.selectInteraction.bind(null,r)},a.createElement(l.Icon,{glyph:u.select}),a.createElement(p,{value:o,save:e.updateName.bind(null,r),onClick:e.selectInteraction.bind(null,r)}),a.createElement(l.Icon,{glyph:u.trash,className:"delete",onClick:e.deleteInteraction.bind(null,t,this.props.groupId,r),"data-tip":"Delete "+o,"data-place":"right"})))},this))}})},1237:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(227),i=n(91),l=n(73),o=n(226),c=n(142),d=n(317),p=n(74),u=n(72);t.default=s.connect(function(e,t){const n=c.getScaleInfoForGroup(e,t.groupId),a=e.getIn(["vega","isParsing"]),s=Boolean(!a&&u.view&&(n.xScaleName&&n.xFieldName||n.yScaleName&&n.yFieldName)),r=e.getIn(["vis","present","marks",String(t.groupId),"_widgets"]);return{widgets:r?r.map(function(t){return e.getIn(["vis","present","widgets",String(t)])}):[],canDemonstrate:s}},function(e){return{selectWidget:function(t){e(i.selectWidget(t))},deleteWidget:function(t,n,a,s){t===a&&e(i.selectMark(n)),e(o.deleteWidget({groupId:n},a)),s.preventDefault(),s.stopPropagation(),r.default.hide()},updateName:function(t,n){e(o.updateWidgetName(n,t))}}})(class extends a.Component{componentDidUpdate(){r.default.rebuild()}render(){const e=this.props,t=e.selectedId,n=e.selectedType;return a.createElement("div",{className:"interaction-list"},a.createElement("li",{className:"header"},"Widgets"),e.widgets.map(function(s){const r=s.id,o=s.name;return a.createElement("li",{key:r},a.createElement("div",{className:"name"+(t===r&&n===i.InspectorSelectedType.SELECT_WIDGET?" selected":""),onClick:e.selectWidget.bind(null,r)},a.createElement(l.Icon,{glyph:p.select}),a.createElement(d,{value:o,save:e.updateName.bind(null,r),onClick:e.selectWidget.bind(null,r)}),a.createElement(l.Icon,{glyph:p.trash,className:"delete",onClick:e.deleteWidget.bind(null,t,this.props.groupId,r),"data-tip":"Delete "+o,"data-place":"right"})))},this))}})},1238:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(91),i=n(269),l=n(377),o=n(88),c=n(272),d=n(91),p=n(67),u=n(23),m=n(72),g=n(47).getInVis;const h={startDragging:d.startDragging,stopDragging:d.stopDragging,selectScale:r.selectScale,setMarkVisual:p.setMarkVisual};t.default=s.connect(function(e,t){const n=e.getIn(["inspector","dragging"]),a=n&&n.scaleId?n:null;return{selectedId:e.getIn(["inspector","encodings","selectedId"]),scales:g(e,"scales"),dragging:a}},h)(class extends a.Component{constructor(){super(...arguments),this.handleDragStart=(e=>{const t=e.target.dataset.scale,n=e.target.dataset.field;this.props.startDragging(c.ScaleDraggingState({scaleId:t,fieldName:n})),i.default.set(o.MODE,"channels"),m.update()}),this.handleDragEnd=(()=>{const e=i.default.get(o.SELECTED),t=i.default.get(o.CELL),n=u.tupleid(e)&&u.tupleid(t);try{if(n){const n=+e.mark.role.split("lyra_")[1],a=l.channelName(t.key);this.props.setMarkVisual({property:a,def:{scale:this.props.dragging.scaleId,field:this.props.dragging.fieldName}},n)}}catch(e){console.error("Unable to bind primitive"),console.error(e)}this.props.stopDragging(),i.default.set(o.MODE,"handles"),i.default.set(o.CELL,{}),n||m.update()})}render(){const e=this.props,t=[...e.scales.values()];return a.createElement("div",{id:"scale-list"},a.createElement("h2",null,"Scales"),a.createElement("ul",null,t.map(t=>{const n=t.get("_id"),s=t.get("name"),r=t.get("_domain")&&t.get("_domain").length?t.get("_domain")[0].field:null;return a.createElement("li",{key:n,onClick:e.selectScale.bind(null,n)},a.createElement("div",{draggable:!0,className:e.selectedId===n?"selected scale name":"scale name",onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,"data-scale":t.get("_id"),"data-field":r},s))},this)))}})},1239:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(46),i=n(91),l=n(882),o=n(1240),c=n(1248),d=n(1251),p=n(1252),u=n(1253),m=n(1255),g=n(1261),h=n(1265),f=n(1266),y=n(91),v=n(270),_={AreaInspector:o.AreaInspector,GuideInspector:c.GuideInspector,LineInspector:d.LineInspector,RectInspector:p.RectInspector,ScaleInspector:u.ScaleInspector,SymbolInspector:h.SymbolInspector,TextInspector:f.TextInspector,InteractionInspector:m.InteractionInspector,WidgetInspector:g.WidgetInspector,GroupInspector:p.RectInspector},b=n(373),S=n(47).getInVis;const x={selectMark:y.selectMark};t.InspectorSidebar=s.connect(function(e,t){const n=e.getIn(["inspector","encodings"]),a=n.get("selectedId"),s=n.get("selectedType"),l=s===r.getType(i.baseSelectMark),o=s===r.getType(i.selectGuide),c=s===r.getType(i.selectScale),d=s===r.getType(i.selectInteraction),p=s===r.getType(i.selectWidget),u=l?S(e,`marks.${a}`):o?S(e,`guides.${a}`):c?S(e,`scales.${a}`):d?S(e,`interactions.${a}`):p?S(e,`widgets.${a}`):null;let m,g=[];return l&&(g=(g=[...(g=S(e,"interactions")).values()]).filter(e=>u._parent==e.get("groupId")).map(e=>e.get("name"))),u&&u.from&&u.from.data&&(m=S(e,"pipelines."+S(e,"datasets."+u.from.data).get("_parent")).get("name")),{selectedId:a,selected:u,isMark:l,isGuide:o,isScale:c,isInteraction:d,isWidget:p,name:u&&u.get("name"),from:m,markType:u&&u.get("type"),guideType:u&&u.get("_gtype"),interactionList:g}},x)(class extends a.Component{render(){const e=this.props,t=e.selectedId,n=e.selected,s=e.from;let r,i,o;t&&n&&(e.isMark&&e.markType?(r=b(e.markType),i=l.PrimType.MARKS):e.isGuide?(r="Guide",i=l.PrimType.GUIDES):e.isScale?(r="Scale",i=l.PrimType.SCALES):e.isInteraction?(r="Interaction",i=l.PrimType.INTERACTIONS):e.isWidget&&(r="Widget",i=l.PrimType.WIDGETS),o=_[r+"Inspector"]),o||e.selectMark(v.getClosestGroupId());const c=e.isMark?a.createElement("div",{className:"property-group property"},a.createElement("h3",{className:"label-long"},"Pipeline"),a.createElement("div",{className:"control"},s||"None")):null,d=this.props.interactionList.length&&e.isMark?a.createElement("div",{className:"property-group"},a.createElement("h3",{className:"label-long"},"Interactions"),a.createElement("div",{className:"property"},this.props.interactionList.length?this.props.interactionList.map(e=>a.createElement("span",{key:e,className:"interaction name"},e)):null)):null,p=o?a.createElement("div",{className:"inner"},c,a.createElement(o,{primId:t,primType:i,guideType:e.guideType}),d):null,u=e.name||"Properties";return a.createElement("div",{className:"sidebar",id:"inspector"},a.createElement("h2",null,u),p)}})},1240:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(883),s=n(13),r=n(33),i=n(108),l=n(884);t.AreaInspector=r.connect(function(e,t){const n=t.primId,a=e.getIn(["vis","present","marks",String(n),"encode","update","orient","signal"]);return{orient:e.getIn(["vis","present","signals",a,"value"])}})(class extends s.Component{render(){const e=this.props;return s.createElement("div",null,s.createElement("div",{className:"property-group"},s.createElement("h3",null,"X Position"),"vertical"===e.orient?s.createElement(i.Property,Object.assign({name:"x",label:"X",type:"number",droppable:!0},e)):s.createElement(l.ExtentProperty,Object.assign({exType:"x"},e))),s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Y Position"),"vertical"===e.orient?s.createElement(l.ExtentProperty,Object.assign({exType:"y"},e)):s.createElement(i.Property,Object.assign({name:"y",label:"Y",type:"number",droppable:!0},e))),s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Fill"),s.createElement(i.Property,Object.assign({name:"fill",label:"Color",type:"color",droppable:!0},e)),s.createElement(i.Property,Object.assign({name:"fillOpacity",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05",droppable:!0},e))),s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Stroke"),s.createElement(i.Property,Object.assign({name:"stroke",label:"Color",type:"color",droppable:!0},e)),s.createElement(i.Property,Object.assign({name:"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25",droppable:!0},e))),s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Line Strength"),s.createElement(i.Property,Object.assign({name:"interpolate",label:"Interpolate",type:"select",opts:a,droppable:!0},e)),s.createElement(i.Property,Object.assign({name:"tension",label:"Tension",type:"number",droppable:!0},e))))}})},1241:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47).getInVis,s='<span class="field source" contenteditable="false">',r='<span class="signal" contenteditable="false">',i="</span>",l="datum.",o='<span class="',c=new RegExp("("+s+"|"+r+").*"+i),d=n(13),p=n(1242),u=n(1243),m=n(33),g=n(67),h=n(143),f=n(604),y=n(1245);t.AutoComplete=m.connect(function(e,t){const n=a(e,"datasets."+t.dsId+"._schema"),s=e.getIn(["vis","present","interactions"]).valueSeq().toArray(),r=[].concat.apply([],s.filter(e=>e.signals.length).map(e=>e.signals.map(e=>e.signal))),i=e.getIn(["vis","present","widgets"]).valueSeq().toArray(),l=[].concat.apply([],i.filter(e=>e.signals.length).map(e=>e.signals.map(e=>e.signal)));return{fields:n?n.keySeq().toJS():[],signals:r.concat(l),dragging:e.getIn(["inspector","dragging"])}},function(e,t){return{setDsId(n){e(g.updateMarkProperty({property:"from",value:{data:n}},t.primId))},setSignalPush(t,n,a){e(h.setSignalPush({[t]:n},a))}}})(class extends d.Component{constructor(e){super(e),this.insertNodeAtCaret=window.insertNodeAtCaret=(e=>{const t=this.createElementFromHTML(e),n=p.getSelection(),a=this.getSelectedRangeWithinEl();a&&(a.collapse(!1),a.insertNode(t),a.collapseAfter(t),n.setSingleRange(a))}),this.replaceMaintainingCaret=((e,t)=>{this.ref&&[...this.ref.htmlEl.childNodes].forEach(n=>{if(n.nodeValue){const a=n.nodeValue.indexOf(e),s=a+e.length;if(-1===a)return;const r=document.createRange();r.setStart(n,a),r.setEnd(n,s),r.deleteContents(),this.insertNodeAtCaret(t)}})}),this.getHeadToCaret=window.getHeadToCaret=(()=>{if(this.ref){const e=this.getSelectedRangeWithinEl(),t=document.createRange();t.selectNodeContents(this.ref.htmlEl),t.setEnd(e.startContainer,e.startOffset);const n=t.cloneContents(),a=document.createElement("body");return a.appendChild(n),a.innerHTML}}),this.htmlToExpr=(e=>{this.props.fields.forEach(t=>{const n=s+t+i;e=e.replace(n,l+t)});const t=e.replace(/(<([^>]+)>)/gi,"");return this.decodeHtml(t)}),this.debounceUpdate=f.debounce(500,()=>{this.ref&&this.props.updateFn(this.fromHtml(this.ref.htmlEl.innerHTML))}),this.processTokens=(e=>{this.props.fields.forEach(t=>{e.includes(`:${t}:`)&&this.replaceMaintainingCaret(`:${t}:`,s+t+i)}),this.props.signals.forEach(t=>{e.includes(`:${t}:`)&&this.replaceMaintainingCaret(`:${t}:`,r+t+i)})}),this.handleChange=(e=>{let t=e.target.value||e.target.innerHTML||"";this.processTokens(t);const n=this.getHeadToCaret();if(n.match(/:\w*$/g)){const e=n.substring(n.lastIndexOf(":")+1);this.setState({searchPrefix:e})}else this.setState({searchPrefix:null});this.debounceUpdate()}),this.handleDragOver=(e=>(e.preventDefault&&e.preventDefault(),!1)),this.handleDrop=(()=>{const e=this.props;let t=e.dragging;if(t.dsId){const n=(t=t).fieldDef.name;this.insertNodeAtCaret(s+n+i),!e.dsId&&t.dsId&&"marks"===e.primType&&e.setDsId(t.dsId)}else if(t.signal){(t=t).interactionId&&this.props.setSignalPush(t.signal,!0,t.interactionId);const e=t.signal;this.insertNodeAtCaret(r+e+i)}this.debounceUpdate()}),this.onAutoCompleteSelect=(e=>{this.replaceMaintainingCaret(":"+this.state.searchPrefix,":"+e+":"),this.ref&&this.processTokens(this.ref.htmlEl.innerHTML),this.setState({searchPrefix:null}),this.debounceUpdate()}),this.onKeyDown=(e=>{null!==this.state.searchPrefix&&(38!==e.keyCode&&40!==e.keyCode||(e.preventDefault(),this.setState({keyCode:e.keyCode})),13===e.keyCode&&this.setState({keyCode:e.keyCode}))}),this.onKeyUp=(()=>{this.setState({keyCode:null})}),this.state={searchPrefix:null,keyCode:null}}getSelectedRangeWithinEl(){var e,t;const n=null===(e=this.ref)||void 0===e?void 0:e.htmlEl;var a=null,s=p.getSelection(),r=p.createRange();if(r.selectNodeContents(n),s.rangeCount&&(a=s.getRangeAt(0).intersection(r)),r.detach(),!a){if(null===(t=n.childNodes)||void 0===t?void 0:t.length){const e=n.childNodes[n.childNodes.length-1];r.setStartAfter(e),r.setEndAfter(e)}else r.selectNodeContents(n);return s.removeAllRanges(),s.addRange(r),r}return a}createElementFromHTML(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}toHtml(e){return"expr"===this.props.type?this.exprToHtml(e):"tmpl"===this.props.type?this.tmplToHtml(e):void 0}fromHtml(e){return"expr"===this.props.type?this.htmlToExpr(e):"tmpl"===this.props.type?this.htmlToTmpl(e):void 0}decodeHtml(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}htmlToTmpl(e){const t=[];let n=e,a=n.search(c);for(;-1!==a;){t.push({type:"literal",str:n.substring(0,a)});const e=a+o.length,l=n.substring(e),d=l.search(i);l.startsWith("signal")?t.push({type:"signal",str:l.substring(r.length-o.length,d)}):l.startsWith("field")&&t.push({type:"field",str:l.substring(s.length-o.length,d)}),a=(n=l.substring(d+i.length)).search(c)}return t.push({type:"literal",str:n}),t.map(e=>{switch(e.type){case"literal":return JSON.stringify(this.decodeHtml(e.str.replace(/(<([^>]+)>)/gi,"")));case"signal":return e.str;case"field":return l+e.str}}).join(" + ")}tmplToHtml(e){return e.split(" + ").map(e=>e.startsWith('"')&&e.endsWith('"')?JSON.parse(e):e.startsWith(l)?s+e.substring(l.length)+i:r+e+i).join("")}exprToHtml(e){const t=this.props.fields,n=this.props.signals,a=new RegExp(t.map(e=>l+e).join("|"),"g"),o=new RegExp(n.join("|"),"g");return e=(e=e.replace(a,e=>e?s+e.substring(l.length)+i:e)).replace(o,e=>e?r+e+i:e)}getDropdownPosition(){if(this.ref){const e=this.ref.htmlEl.getBoundingClientRect();return{top:e.bottom,left:e.left,minWidth:e.width-2}}return null}render(){return d.createElement("div",{className:"autocomplete-wrap",onDragOver:this.handleDragOver,onDrop:this.handleDrop,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp},d.createElement(u.default,{ref:e=>{this.ref=e},className:"autocomplete",html:this.toHtml(this.props.value||""),disabled:!1,onChange:this.handleChange,onKeyDown:e=>{"Enter"!==e.key&&13!==e.keyCode||e.preventDefault()}}),d.createElement(y.AutoCompleteList,{style:this.getDropdownPosition(),fields:this.props.fields,signals:this.props.signals,searchPrefix:this.state.searchPrefix,keyCode:this.state.keyCode,onSelected:this.onAutoCompleteSelect}))}})},1245:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13);t.AutoCompleteList=class extends a.Component{constructor(e){super(e),this.state={suggestions:[],selectedValue:null}}componentDidUpdate(e){if(e.fields!==this.props.fields||e.signals!==this.props.signals||e.searchPrefix!==this.props.searchPrefix){const e=null!==this.props.searchPrefix?this.props.fields.concat(this.props.signals).filter(e=>e.toLowerCase().startsWith(this.props.searchPrefix.toLowerCase())):[];this.setState({suggestions:e})}this.state.selectedValue&&!this.state.suggestions.includes(this.state.selectedValue)&&this.setSelectedValue(null),!e.keyCode&&this.props.keyCode&&(38===this.props.keyCode&&this.selectPrev(),40===this.props.keyCode&&this.selectNext(),13===this.props.keyCode&&this.state.selectedValue&&this.onSelected(this.state.selectedValue))}setSelectedValue(e){this.setState({selectedValue:e})}selectPrev(){if(!this.state.selectedValue&&this.state.suggestions.length)this.setSelectedValue(this.state.suggestions[this.state.suggestions.length-1]);else{const e=this.state.suggestions.indexOf(this.state.selectedValue);e>=0&&this.setSelectedValue(this.state.suggestions[(e-1+this.state.suggestions.length)%this.state.suggestions.length])}}selectNext(){if(!this.state.selectedValue&&this.state.suggestions.length)this.setSelectedValue(this.state.suggestions[0]);else{const e=this.state.suggestions.indexOf(this.state.selectedValue);e>=0&&this.setSelectedValue(this.state.suggestions[(e+1)%this.state.suggestions.length])}}onSelected(e){this.props.onSelected(e),this.setSelectedValue(null)}render(){return a.createElement("div",{className:"autocomplete-list "+(this.state.suggestions.length?"active":null),style:this.props.style},this.state.suggestions.map(e=>a.createElement("div",{key:e,className:"autocomplete-suggestion "+(this.state.selectedValue===e?"active":null),onClick:()=>this.onSelected(e),onMouseEnter:()=>this.setSelectedValue(e),onMouseLeave:()=>{this.state.selectedValue===e&&this.setSelectedValue(null)}},e)))}}},1246:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(317),s=n(47).getInVis,r=n(72),i=n(13),l=n(33),o=n(268),c=n(314),d=n(269),p=n(73);t.FormInputProperty=l.connect(function(e,t){const n=t.signal;return n?{value:s(e,"signals."+n+".value")}:{value:t.value}},function(e,t){const n=t.signal;return{setSignal:function(t){n&&e(o.setSignal(t,n))}}})(class extends i.Component{constructor(e){super(e),this.signal=((e,t)=>{this.props.setSignal(t),this.setState({value:t})}),this.state={value:e.value}}componentWillMount(){this.onSignal(!1)}componentWillReceiveProps(e){const t=this.props,n=t.signal,a=e.signal;n!==a&&(this.offSignal(n),a&&this.onSignal(a)),(a||e.value!==t.value)&&this.setState({value:a&&a.startsWith("lyra")?d.default.get(a):e.value})}componentWillUnmount(){this.offSignal(!1)}onSignal(e){(e=e||this.props.signal)&&c.onSignal(e,this.signal)}offSignal(e){(e=e||this.props.signal)&&c.offSignal(e,this.signal)}handleChange(e){const t=this.props,n=t.type,a=t.signal,s=e.target?e.target.value:e;let i=s;"number"!==n&&"range"!==n||(i=+s),a&&(d.default.set(a,i,!1),r.update()),this.setState({value:s})}ensureNumberFilled(){this.setState({value:+this.state.value})}colorSupport(){const e=document.createElement("input");return e.setAttribute("type","color"),"text"!==e.type}render(){const e=this.props,t=e.name,n=e.id,s=e.min,r=e.max,l=e.disabled||e.group,o=l?"":this.state.value,c=e.onChange||this.handleChange.bind(this),d=e.onBlur,u=e.onKeyPress,m=this.colorSupport();switch(e.type){case"checkbox":return i.createElement("input",{id:n,name:t,type:"checkbox",checked:o,disabled:l,onChange:c,onBlur:d,onKeyPress:u});case"text":return i.createElement("input",{id:n,name:t,type:"text",value:o,disabled:l,onChange:c,onBlur:d,onKeyPress:u});case"number":return i.createElement("input",{id:n,name:t,type:"number",value:o,min:s,max:r,disabled:l,onChange:c,onBlur:()=>{d&&d(),this.ensureNumberFilled()},onKeyPress:u});case"range":return i.createElement("div",null,i.createElement("input",{id:n,name:t,type:"range",value:o,min:s,max:r,step:e.step,disabled:l,onChange:c,onBlur:d,onKeyPress:u}),i.createElement(a,{value:o,save:c}));case"color":return i.createElement("div",null,i.createElement("input",{id:n,name:t,type:m?"color":"text",value:o,disabled:l,onChange:c,onBlur:d,onKeyPress:u}),m?i.createElement(a,{value:o,save:c}):null);case"select":return i.createElement("select",{id:n,name:t,value:o,disabled:l,onChange:c,onBlur:d,onKeyPress:u},e.opts.map(function(e){return i.createElement("option",{key:e,value:e},e)},this));case"toggle":const g=e.opts.find(function(e){return e!==o});return i.createElement("div",null,i.createElement("button",{type:"button",id:n,className:(o===e.opts[0]?"":"button-secondary ")+"button",onClick:c.bind(this,g)},i.createElement(p.Icon,{glyph:e.glyph})));case"selection":return i.createElement("div",null,e.opts.map(function(t,a){return i.createElement("button",{key:t,type:"button",id:n,className:(o===t?"button-secondary ":"")+"button",onClick:c.bind(this,t)},i.createElement(p.Icon,{glyph:e.glyphs[a]}))},this));default:return null}}})},1247:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47).getInVis,s=n(13),r=n(33),i=n(67);t.SpatialPreset=r.connect(function(e,t){const n=t.primId,s=t.name,r=a(e,"marks."+n+".encode.update."+s);return{field:r.field,band:r.band,group:r.group,scale:a(e,"scales."+r.scale)}},function(e,t){const n=t.primId;return{setPreset:function(t,a){e(i.setMarkVisual({property:t,def:a},n))},reset:function(t){e(i.resetMarkVisual(t,n))}}})(class extends s.Component{handleChange(e){const t=this.props,n=t.name,a=t.scale,s=n.indexOf("x")>=0?"width":"height";e.target.checked?t.setPreset(n,"width"===n||"height"===n?{scale:a.get("_id"),band:!0}:{group:s}):t.reset(n)}render(){const e=this.props,t=e.name,n=e.scale,a=t.indexOf("x")>=0?"width":"height";return e.field?null:"width"===t||"height"===t?n&&"ordinal"===n.get("type")&&!n.get("points")?s.createElement("label",null,s.createElement("input",{type:"checkbox",name:t,checked:e.band,onChange:e=>this.handleChange(e)})," Automatic"):null:s.createElement("label",null,s.createElement("input",{type:"checkbox",name:t,checked:e.group,onChange:e=>this.handleChange(e)})," Set to group ",a)}})},1248:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(1249),i=n(1250),l=n(312),o=n(201);t.GuideInspector=s.connect(function(e,t){const n=e.getIn(["vis","present","guides",String(t.primId)]),a="axis"===t.guideType?"scale":n.get("_type"),s=n.get(a),r=e.getIn(["vis","present","scales",s]);return{domainFields:r.get("_domain").map(e=>e.field).join(", "),scaleName:r.get("name")}},function(e){return{updateGuideProperty:function(t,n,a){e(o.updateGuideProperty({property:n,value:a},t))}}})(class extends a.Component{handleChange(e){const t=this.props.primId,n=e.target,a=n.name;let s="checkbox"===n.type?n.checked:n.value;s=""===s||isNaN(+s)?s:+s,this.props.updateGuideProperty(t,a,s)}render(){const e=this.props,t=e.guideType,n=e.guideType?a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Scale"),a.createElement("div",{className:"property"},a.createElement("div",{className:"label-long"},e.scaleName),a.createElement("div",{className:"control"},e.domainFields))):null;return t===l.GuideType.Axis?a.createElement("div",{className:"inner"},n,a.createElement(r.AxisInspector,Object.assign({},e,{handleChange:e=>this.handleChange(e)}))):t===l.GuideType.Legend?a.createElement("div",{className:"inner"},n,a.createElement(i.LegendInspector,Object.assign({},e,{handleChange:e=>this.handleChange(e)}))):null}})},1249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(605),i=n(108);t.AxisInspector=s.connect(function(e,t){const n=t.primId,a=e.getIn(["vis","present","guides",String(n)]).get("scale");return{scaleName:e.getIn(["vis","present","scales",a]).name}})(class extends a.Component{render(){const e=this.props,t=e.handleChange,n=["top","bottom","left","right"],s="encode.domain.update.",l="encode.title.update.",o="encode.labels.update.",c="encode.grid.update.",d="encode.ticks.update.";return a.createElement("div",null,a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Axis"),a.createElement(i.Property,Object.assign({name:"orient",label:"Orient",type:"select",opts:"x"===e.scaleName?n.slice(0,2):n.slice(2,4),onChange:t},e)),a.createElement(r.MoreProperties,{label:"Axis"},a.createElement(i.Property,Object.assign({name:s+"stroke.value",label:"Color",type:"color",onChange:t},e)),a.createElement(i.Property,Object.assign({name:s+"strokeWidth.value",label:"Width",type:"range",min:"0",max:"10",step:"0.25",onChange:t},e)))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Title"),a.createElement(i.Property,Object.assign({name:"title",label:"Text",type:"text",onChange:t},e)),a.createElement(i.Property,Object.assign({name:l+"fontSize.value",label:"Font Size",type:"number",onChange:t},e)),a.createElement(r.MoreProperties,{label:"Title"},a.createElement(i.Property,Object.assign({name:l+"fill.value",label:"Color",type:"color",onChange:t},e)),a.createElement(i.Property,Object.assign({name:l+"dx.value",label:"dx Offset",type:"number",onChange:t},e)),a.createElement(i.Property,Object.assign({name:l+"dy.value",label:"dy Offset",type:"number",onChange:t},e)))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Labels"),a.createElement(i.Property,Object.assign({name:o+"fontSize.value",label:"Font Size",type:"number",onChange:t},e)),a.createElement(i.Property,Object.assign({name:o+"angle.value",label:"Angle",type:"number",min:"0",max:"360",onChange:t},e)),a.createElement(r.MoreProperties,{label:"Label"},a.createElement(i.Property,Object.assign({name:o+"fill.value",label:"Fill",type:"color",onChange:t},e)))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Grid"),a.createElement(i.Property,Object.assign({name:"grid",label:"Grid",type:"checkbox",onChange:t},e)),a.createElement(i.Property,Object.assign({name:"layer",label:"Layer",type:"select",opts:["back","front"],onChange:t},e)),a.createElement(r.MoreProperties,{label:"Grid"},a.createElement(i.Property,Object.assign({name:c+"stroke.value",label:"Color",type:"color",onChange:t},e)),a.createElement(i.Property,Object.assign({name:c+"strokeOpacity.value",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05",onChange:t},e)),a.createElement(i.Property,Object.assign({name:c+"strokeWidth.value",label:"Width",type:"range",min:"0",max:"10",step:"0.25",onChange:t},e)))),a.createElement("div",{className:"property-group last"},a.createElement(r.MoreProperties,{label:"Ticks",header:"true"},a.createElement(i.Property,Object.assign({name:"tickCount",label:"Number of Ticks",type:"number",onChange:t},e)),a.createElement(i.Property,Object.assign({name:d+"stroke.value",label:"Color",type:"color",onChange:t},e)),a.createElement(i.Property,Object.assign({name:d+"strokeWidth.value",label:"Width",type:"range",min:"0",max:"10",step:"0.25",onChange:t},e)),a.createElement(i.Property,Object.assign({name:"tickSize",label:"Size",type:"number",onChange:t},e)))))}})},1250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47).getInVis,s=n(13),r=n(33),i=n(605),l=n(108),o=n(422);t.LegendInspector=r.connect(function(e,t){const n=a(e,"guides."+t.primId),s=n.get("_type");return{legendType:s,scaleType:a(e,"scales."+n.get(s)).get("type")}})(class extends s.Component{render(){const e=this.props,t=e.handleChange,n=e.legendType,a=e.scaleType,r="encode.legend.update.",c="encode.title.update.",d="encode.labels.update.",p="encode.gradient.update.",u="encode.symbols.update.",m=s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Labels"),s.createElement(l.Property,Object.assign({name:d+"fontSize.value",label:"Font Size",type:"number",onChange:t},e)),s.createElement(i.MoreProperties,{label:"Label"},s.createElement(l.Property,Object.assign({name:d+"fill.value",label:"Fill",type:"color",onChange:t},e))));return s.createElement("div",null,s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Legend"),s.createElement(l.Property,Object.assign({name:"orient",label:"Orient",type:"select",opts:["left","right"],onChange:t},e)),s.createElement(i.MoreProperties,{label:"Legend"},s.createElement(l.Property,Object.assign({name:r+"stroke.value",label:"Border Color",type:"color",onChange:t},e)),s.createElement(l.Property,Object.assign({name:r+"strokeWidth.value",label:"Border Width",onChange:t,type:"range",min:"0",max:"10",step:"0.25"},e)))),s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Title"),s.createElement(l.Property,Object.assign({name:"title",label:"Text",type:"text",onChange:t},e)),s.createElement(l.Property,Object.assign({name:c+"fontSize.value",label:"Font Size",type:"number",onChange:t},e)),s.createElement(i.MoreProperties,{label:"Title"},s.createElement(l.Property,Object.assign({name:c+"fill.value",label:"Color",type:"color",onChange:t},e)))),"fill"!==n&&"stroke"!==n||"ordinal"===a?s.createElement("div",null,s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Symbols"),"shape"!==n?s.createElement(l.Property,Object.assign({name:u+"shape.value",label:"Shape",type:"select",opts:o.SymbolShapes,onChange:t},e)):null,"size"!==n?s.createElement(l.Property,Object.assign({name:u+"size.value",label:"Size",type:"number",onChange:t},e)):null,"fill"!==n?s.createElement(l.Property,Object.assign({name:u+"fill.value",label:"Fill",type:"color",onChange:t},e)):null,"stroke"!==n?s.createElement(l.Property,Object.assign({name:u+"stroke.value",label:"Stroke",type:"color",onChange:t},e)):null,s.createElement(i.MoreProperties,{label:"Symbol"},s.createElement(l.Property,Object.assign({name:u+"opacity.value",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05",onChange:t},e)),s.createElement(l.Property,Object.assign({name:u+"strokeWidth.value",label:"Width",type:"range",min:"0",max:"10",step:"0.25",onChange:t},e)))),m):s.createElement("div",null,m,s.createElement("div",{className:"property-group"},s.createElement(i.MoreProperties,{label:"Gradient",header:"true"},s.createElement(l.Property,Object.assign({name:p+"stroke.value",label:"Border Color",type:"color",onChange:t},e)),s.createElement(l.Property,Object.assign({name:p+"strokeWidth.value",label:"Border Width",type:"range",min:"0",max:"10",step:"0.25",onChange:t},e))))))}})},1251:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(883),s=n(13),r=n(108);t.LineInspector=class extends s.Component{render(){const e=this.props;return s.createElement("div",null,s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Position"),s.createElement(r.Property,Object.assign({name:"x",label:"X",type:"number",droppable:!0},e)),s.createElement(r.Property,Object.assign({name:"y",label:"Y",type:"number",droppable:!0},e))),s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Stroke"),s.createElement(r.Property,Object.assign({name:"stroke",label:"Color",type:"color",droppable:!0},e)),s.createElement(r.Property,Object.assign({name:"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25",droppable:!0},e))),s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Line Strength"),s.createElement(r.Property,Object.assign({name:"interpolate",label:"Interpolate",type:"select",opts:a,droppable:!0},e)),s.createElement(r.Property,Object.assign({name:"tension",label:"Tension",type:"number",droppable:!0},e))))}}},1252:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(884),r=n(108);t.RectInspector=class extends a.Component{render(){const e=this.props;return a.createElement("div",null,a.createElement("div",{className:"property-group"},a.createElement("h3",null,"X Position"),a.createElement(s.ExtentProperty,Object.assign({exType:"x"},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Y Position"),a.createElement(s.ExtentProperty,Object.assign({exType:"y"},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Fill"),a.createElement(r.Property,Object.assign({name:"fill",label:"Color",type:"color",droppable:!0},e)),a.createElement(r.Property,Object.assign({name:"fillOpacity",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05",droppable:!0},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Stroke"),a.createElement(r.Property,Object.assign({name:"stroke",label:"Color",type:"color",droppable:!0},e)),a.createElement(r.Property,Object.assign({name:"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25",droppable:!0},e))))}}},1253:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(108),i=n(605),l=n(1254),o=n(271),c=n(424);t.ScaleInspector=s.connect(function(e,t){let n,a=e.getIn(["vis","present","scales",String(t.primId)]),s=a.get("_domain").map(e=>e.field),r=[""],i=new Map;return[...n]=e.getIn(["vis","present","datasets"]).keys(),n.forEach(t=>{let n=e.getIn(["vis","present","datasets",String(t),"_schema"]).keySeq().toJS();r=r.concat(n),i.set(t,n)}),{scale:a,fields:r=r.filter(e=>!s.includes(e)),fieldMap:i}},function(e){return{updateScaleProperty:function(t,n,a){e(o.updateScaleProperty({property:n,value:a},t))}}})(class extends a.Component{handleChange(e,t){if(e.key&&"Enter"!==e.key||e.keyCode&&13!==e.keyCode)return;const n=this.props.primId,a=e.target,s=a.name;let r="checkbox"===a.type?a.checked:t||a.value;"boolean"==typeof r||""===r||isNaN(+r)||Array.isArray(r)||(r=+r),this.props.updateScaleProperty(n,s,r)}filterOpts(e,t){return"y"===t.slice(0,1)?e.filter(e=>"height"===e):"x"===t.slice(0,1)||"size"==t.slice(0,4)?e.filter(e=>"width"===e):e}processValue(e,t){if("_domain"===t.name&&"select"===t.type){let n;return t.fieldMap.forEach((t,a)=>{n=t.includes(e)?a:null}),{data:Number(n),field:e}}return e}render(){const e=this.props,t=e.scale,n=t.get("name"),s=t.get("type"),o=t.get("_manual");return a.createElement("div",null,a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Type"),a.createElement(r.Property,Object.assign({name:"type",label:"Type",type:"select",opts:["linear","log","time","ordinal","band","point"].filter(e=>c.scaleTypeSimple(e)===c.scaleTypeSimple(s)),onChange:e=>this.handleChange(e)},e)),a.createElement(r.Property,Object.assign({name:"clamp",label:"Clamp",type:"checkbox",onChange:e=>this.handleChange(e)},e)),a.createElement(r.Property,Object.assign({name:"nice",label:"Nice",type:"checkbox",onChange:e=>this.handleChange(e)},e)),a.createElement(r.Property,Object.assign({name:"zero",label:"Zero",type:"checkbox",onChange:e=>this.handleChange(e)},e)),a.createElement(r.Property,Object.assign({name:"reverse",label:"Reverse",type:"checkbox",onChange:e=>this.handleChange(e)},e)),a.createElement(r.Property,Object.assign({name:"round",label:"Round",type:"checkbox",onChange:e=>this.handleChange(e)},e))),a.createElement("div",{className:"property-group"},a.createElement("div",null,a.createElement("h3",null,"Domain "),a.createElement(r.Property,Object.assign({name:"_manual",label:"Manual",type:"checkbox",onChange:e=>this.handleChange(e)},e))),!o&&a.createElement(l.MultiValueProperty,Object.assign({name:"_domain",label:"Fields",type:"select",subLabel:"field",onChange:(e,t)=>this.handleChange(e,t),opts:e.fields,valueProperty:"field",processValue:(e,t)=>this.processValue(e,t)},e)),c.scaleTypeSimple(s)===c.ScaleSimpleType.CONTINUOUS&&o&&a.createElement("div",null,a.createElement(r.Property,Object.assign({name:"domainMin",label:"Domain Min",type:"number",onChange:e=>this.handleChange(e)},e)),a.createElement(r.Property,Object.assign({name:"domainMax",label:"Domain Max",type:"number",onChange:e=>this.handleChange(e)},e))),c.scaleTypeSimple(s)===c.ScaleSimpleType.DISCRETE&&o&&a.createElement("div",null,a.createElement(l.MultiValueProperty,Object.assign({name:"_manualDomain",label:"Values",type:"text",onKeyPress:(e,t)=>this.handleChange(e,t)},e)))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Range"),"color"===n.slice(0,5)?a.createElement(r.Property,Object.assign({name:"range.scheme",label:"Range",type:"select",opts:["tableau10","category10","category20","tableau20"].concat(["blues","greens","oranges","reds","purples"]).concat(["blueorange","redblue","spectral"]),onChange:e=>this.handleChange(e)},e)):a.createElement(r.Property,Object.assign({name:"range",label:"Range",type:"select",opts:this.filterOpts(["width","height","symbol","category","diverging","ordinal","ramp","heatmap"],n),onChange:e=>this.handleChange(e)},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Padding"),a.createElement(r.Property,Object.assign({name:"padding",label:"Padding",type:"number",onChange:e=>this.handleChange(e)},e)),"band"===s&&a.createElement("div",null,a.createElement(i.MoreProperties,{label:"Scale"},a.createElement(r.Property,Object.assign({name:"paddingInner",label:"Padding Inner",type:"number",onChange:e=>this.handleChange(e)},e)),a.createElement(r.Property,Object.assign({name:"paddingOuter",label:"Padding Outer",type:"number",onChange:e=>this.handleChange(e)},e)),a.createElement(r.Property,Object.assign({name:"align",label:"Align",type:"number",onChange:e=>this.handleChange(e)},e))))))}})},1254:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(108);t.MultiValueProperty=s.connect(function(e,t){if(!t.primId)return{value:null};const n=e.getIn(["vis","present",t.primType,String(t.primId)]);let a=t.name;return{group:n.getIn([a,"group"]),signal:n.getIn([a,"signal"]),value:void 0===t.value?n.getIn([a]):void 0}},function(e,t){return{}})(class extends a.Component{constructor(e){super(e),this.state={}}handleChange(e){const t=this.props,n=t.type;let a=e.target?e.target.value:e;"number"!==n&&"range"!==n||(a=+a);let s=t.processValue?t.processValue(a,t):a,r=[...t.value];r.push(s),e.target.name=t.name,t.onBlur?t.onBlur(e,r):t.onKeyPress?t.onKeyPress(e,r):t.onChange(e,r)}handleUnBind(e){const t=this.props;let n=e.target?e.target.dataset.value:e;const a=t.processValue?t.processValue(n,t):n;let s=t.value.filter(e=>t.valueProperty?e[t.valueProperty]!==a[t.valueProperty]:e!==a);e.target.name=t.name,t.onBlur?t.onBlur(e,s):t.onKeyPress?t.onKeyPress(e,s):t.onChange(e,s)}render(){const e=this.props,t=e.label,n=e.valueProperty;let s=a.createElement("h3",null,t),i=[];return e.value.forEach((t,s)=>{i.push(a.createElement("div",{className:"property",key:s},a.createElement("div",{className:"label"},s+1),a.createElement("div",{className:"control"},a.createElement("div",{className:"scale","data-value":n?t[n]:t,onClick:e=>this.handleUnBind(e)},e.subLabel||"value"),a.createElement("div",{className:"field source","data-value":n?t[n]:t,onClick:e=>this.handleUnBind(e)},n?t[n]:t))))}),a.createElement("div",null,s,a.createElement("div",{className:"property"},i,a.createElement(r.Property,Object.assign({},e,{label:"Add",value:"",onChange:e.onChange?e=>this.handleChange(e):null,onBlur:e.onBlur?e=>this.handleChange(e):null,onKeyPress:e.onKeyPress?e=>this.handleChange(e):null}))))}})},1255:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(224),i=n(143),l=n(142),o=n(424),c=n(202),d=n(1256),p=n(23),u=n(1257),m=n(1258),g=n(872),h=n(267),f=n(1259),y=n(72),v=n(314);const _={setInput:i.setInput,setSelection:i.setSelection,toggleEnableApplicationType:i.toggleEnableApplicationType,setApplication:i.setApplication,removeApplication:i.removeApplication,setSignals:i.setSignals};function b(e,t,n){if(n){const t=[],n=r.IntervalSelection({id:"brush",label:"Brush"}),a=r.IntervalSelection({id:"brush_y",label:"Brush (y-axis)",encoding:"y"}),s=r.IntervalSelection({id:"brush_x",label:"Brush (x-axis)",encoding:"x"});return e.forEach(e=>{var r,i;const{mark:l,xScaleType:c,yScaleType:d}=e;switch(l.type){case"rect":c===o.ScaleSimpleType.DISCRETE||d===o.ScaleSimpleType.DISCRETE?(c===o.ScaleSimpleType.DISCRETE&&t.push(s),d===o.ScaleSimpleType.DISCRETE&&t.push(a)):(c===o.ScaleSimpleType.CONTINUOUS&&d===o.ScaleSimpleType.CONTINUOUS&&t.push(n),d===o.ScaleSimpleType.CONTINUOUS&&t.push(a),c===o.ScaleSimpleType.CONTINUOUS&&t.push(s));break;case"symbol":case"text":c===o.ScaleSimpleType.CONTINUOUS&&d===o.ScaleSimpleType.CONTINUOUS&&t.push(n),d===o.ScaleSimpleType.CONTINUOUS&&t.push(a),c===o.ScaleSimpleType.CONTINUOUS&&t.push(s);break;case"line":d===o.ScaleSimpleType.CONTINUOUS&&t.push(a),c===o.ScaleSimpleType.CONTINUOUS&&t.push(s);break;case"area":const e=null===(i=null===(r=l.toJS().encode)||void 0===r?void 0:r.update)||void 0===i?void 0:i.orient,p=e?e.value||g.signalLookup(e.signal):null;p&&("vertical"===p&&c?t.push(s):"horizontal"===p&&d&&t.push(a))}}),[...new Set(t)]}{let n="_vgsid_";if(t&&t.selection){const e=t.selection;e.field&&"_vgsid_"!==e.field&&(n=e.field)}if("_vgsid_"===n){const t=new Set;e.forEach(e=>{e.scaleFields.forEach(e=>{t.add(e)})}),t.size&&(n=t.values().next().value)}return[r.PointSelection({ptype:"single",id:"single",label:"Single point",field:"_vgsid_"}),r.PointSelection({ptype:"multi",id:"multi",label:"Multi point",field:"_vgsid_"}),r.PointSelection({ptype:"single",id:"single_project",label:"Single point (projected)",field:n,encoding:null}),r.PointSelection({ptype:"multi",id:"multi_project",label:"Multi point (projected)",field:n,encoding:null})]}}function S(e,t,n,a,s,i,l,o){const d=[];if(n.length){const e=n[0],a=n.find(e=>"symbol"===e.type);d.push(r.MarkApplication({id:"color_"+o,label:"Color",targetGroupName:t,targetMarkName:c.default(e.name),propertyName:"line"===e.type?"stroke":"fill",unselectedValue:"#797979"})),d.push(r.MarkApplication({id:"opacity_"+o,label:"Opacity",targetGroupName:t,targetMarkName:c.default(e.name),propertyName:"opacity",unselectedValue:"0.2"})),a&&d.push(r.MarkApplication({id:"size_"+o,label:"Size",targetGroupName:t,targetMarkName:c.default(a.name),propertyName:"size",unselectedValue:30}))}o&&d.push(r.ScaleApplication({id:"panzoom",label:"Pan and zoom",targetGroupName:t,scaleInfo:a}));const p=s.find(t=>t._id!==e);if(p){const e=p._id,t=i.get(e).find(e=>e.from&&e.from.data);if(t){const e=c.default(p.name),n=c.default(t.name),a=l.get(String(t.from.data)).name;d.push(r.TransformApplication({id:"filter_"+e+"_"+o,label:"Filter",targetGroupName:e,datasetName:a,targetMarkName:n}))}}return d}t.InteractionInspector=s.connect(function(e,t){const n=e.getIn(["vis","present","interactions",String(t.primId)]),a=n.get("groupId"),s=l.getScaleInfoForGroup(e,a),r=e.getIn(["vis","present","marks",String(a)]),i=c.default(r.name),d=e.getIn(["vis","present","marks"]).filter(e=>"group"===e.type).mapEntries(([e,t])=>[Number(e),t]),p=d.map(t=>l.getNestedMarksOfGroup(e,t)),u=(d.map(t=>l.getScaleInfoForGroup(e,t._id)),p.get(a)),m=e.getIn(["vis","present","datasets"]),g=l.getFieldsOfGroup(e,r._id),h=e.getIn(["vega","isParsing"]),f=Boolean(!h&&y.view&&(s.xScaleName&&s.xFieldName||s.yScaleName&&s.yFieldName)),v=n.input?"drag"===n.input.mouse:null;return{interaction:n,groups:d,scaleInfo:s,groupName:i,datasets:m,marksOfGroups:p,fieldsOfGroup:g,markScalesOfGroup:u.map(t=>{let n,a=null;if(t.encode&&t.encode.update&&t.encode.update.x&&t.encode.update.x.scale){const a=t.encode.update.x.scale,s=e.getIn(["vis","present","scales",String(a)]);n=o.scaleTypeSimple(s.get("type"))}if(t.encode&&t.encode.update&&t.encode.update.y&&t.encode.update.y.scale){const n=t.encode.update.y.scale,s=e.getIn(["vis","present","scales",String(n)]);a=o.scaleTypeSimple(s.get("type"))}const s=[];if(t.encode&&t.encode.update&&t.encode.update)for(const[e,n]of Object.entries(t.encode.update)){if("x"===e||"y"===e||!n)continue;const t=n.field;t&&s.push(t)}return{mark:t,xScaleType:n,yScaleType:a,scaleFields:s}}),canDemonstrate:f,isDemonstratingInterval:v}},_)(class extends a.Component{constructor(e){super(e),this.previewRefs={},this.mainViewSignalValues={},this.updateIsDemonstrating=p.debounce(250,()=>{const e=this.mainViewSignalValues[this.scopedSignalName("brush_x")]&&this.mainViewSignalValues[this.scopedSignalName("brush_y")]&&Math.abs(this.mainViewSignalValues[this.scopedSignalName("brush_x")][0]-this.mainViewSignalValues[this.scopedSignalName("brush_x")][1])>10&&Math.abs(this.mainViewSignalValues[this.scopedSignalName("brush_y")][0]-this.mainViewSignalValues[this.scopedSignalName("brush_y")][1])>10,t=this.mainViewSignalValues[this.scopedSignalName("points_tuple")]||this.mainViewSignalValues[this.scopedSignalName("points_tuple_projected")],n=e||this.props.isDemonstratingInterval&&!t;this.props.isDemonstratingInterval!==n&&(!this.props.interaction.selection||this.state.selectionPreviews.length&&this.props.interaction.selection.id===this.state.selectionPreviews[0].id&&!this.props.interaction.applications.length)&&this.initializeInteraction(n?"drag":"click")}),this.previousPointSignal=null,this.previousPointSignalTimeout=null,this.state={selectionPreviews:[],applicationPreviews:[]}}componentDidMount(){var e;if(null===(e=this.props.interaction)||void 0===e?void 0:e.input){const e=this.generatePreviews(this.props.isDemonstratingInterval);this.setState(e)}}generatePreviews(e){if(null===e)return{selectionPreviews:[],applicationPreviews:[]};const t=this.props.marksOfGroups.get(this.props.interaction.groupId);return{selectionPreviews:b(this.props.markScalesOfGroup,this.props.interaction,e),applicationPreviews:S(this.props.interaction.groupId,this.props.groupName,t,this.props.scaleInfo,this.props.groups,this.props.marksOfGroups,this.props.datasets,e)}}componentDidUpdate(e,t){var n,a,s,r;if(!e.canDemonstrate&&this.props.canDemonstrate&&(this.restoreMainViewSignals(this.props.groupName),this.restorePreviewSignals(),this.onSignal(this.props.groupName,this.scopedSignalName("points_tuple"),(e,t)=>this.onMainViewPointSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("points_tuple_projected"),(e,t)=>this.onMainViewPointSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("points_toggle"),(e,t)=>this.onMainViewPointSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("brush_x"),(e,t)=>this.onMainViewIntervalSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("brush_y"),(e,t)=>this.onMainViewIntervalSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("grid_translate_anchor"),(e,t)=>this.onMainViewGridSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("grid_translate_delta"),(e,t)=>this.onMainViewGridSignal(e,t)),(null===(a=null===(n=this.props.interaction)||void 0===n?void 0:n.signals)||void 0===a?void 0:a.length)&&this.props.interaction.signals.forEach(e=>{this.onSignal(this.props.groupName,e.signal,(e,t)=>this.updatePreviewSignals(e,t))})),(null===(s=this.props.interaction)||void 0===s?void 0:s.selection)&&!(null===(r=this.state.selectionPreviews)||void 0===r?void 0:r.find(e=>e.id===this.props.interaction.selection.id))){const e=this.generatePreviews(this.props.isDemonstratingInterval);this.setState(e)}}scopedSignalName(e){return`${e}_${this.props.interaction.id}`}restoreMainViewSignals(e){for(let t of["brush_x","brush_y","points_tuple","points_tuple_projected"].map(e=>this.scopedSignalName(e)))this.mainViewSignalValues[t]&&v.setSignalInGroup(y.view,e,t,this.mainViewSignalValues[t])}clearMainViewSignals(e){for(let t of["brush_x","brush_y","points_tuple","points_tuple_projected"].map(e=>this.scopedSignalName(e)))this.mainViewSignalValues[t]=null,v.setSignalInGroup(y.view,e,t,null)}restorePreviewSignals(){for(let e of["brush_x","brush_y","points_tuple","points_tuple_projected"].map(e=>this.scopedSignalName(e)))this.mainViewSignalValues[e]&&(setTimeout(()=>{this.updatePreviewSignals(e,this.mainViewSignalValues[e])},50),this.updatePreviewSignals(e,this.mainViewSignalValues[e]))}updatePreviewSignals(e,t){this.state.selectionPreviews.forEach(n=>{this.previewRefs[n.id]&&this.previewRefs[n.id].setPreviewSignal(e,t)}),this.state.applicationPreviews.forEach(n=>{this.previewRefs[n.id]&&this.previewRefs[n.id].setPreviewSignal(e,t)})}initializeInteraction(e,t){const n="drag"===e,a=this.generatePreviews(n);this.setState(a),t&&this.clearMainViewSignals(this.props.groupName),h.batchGroupBy.start();let s=this.props.interaction.input;if(this.props.interaction.input)s=Object.assign(Object.assign({},this.props.interaction.input),{mouse:e});else{const t=window._inputKeyboard;s={mouse:e,keycode:t?t.keycode:void 0,_key:t?t._key:void 0}}this.props.setInput(s,this.props.primId);let i=!1;(i=n?this.updateBrushXYHeuristic():this.updatePointMultiHeuristic())||this.props.setSelection(a.selectionPreviews[0],this.props.interaction.id);const l=r.getInteractionSignals(this.props.interaction.id,s,this.props.scaleInfo,this.props.fieldsOfGroup);this.props.setSignals(l,this.props.interaction.id),h.batchGroupBy.end()}updateBrushXYHeuristic(){if(this.props.interaction&&this.props.interaction.selection)return;const e=this.mainViewSignalValues[this.scopedSignalName("brush_x")],t=this.mainViewSignalValues[this.scopedSignalName("brush_y")];if(!e||!t)return;const n=Math.abs(e[1]-e[0]),a=Math.abs(t[1]-t[0]);if(!(Math.sqrt(a*a+n*n)>10))return;const s=180*Math.abs(Math.atan2(a,n))/Math.PI;if(s<=15){const e=this.state.selectionPreviews.find(e=>"brush_x"===e.id);if(e)return this.props.setSelection(e,this.props.interaction.id),!0}if(s>=75){const e=this.state.selectionPreviews.find(e=>"brush_y"===e.id);if(e)return this.props.setSelection(e,this.props.interaction.id),!0}}updatePointMultiHeuristic(){if(this.props.interaction&&this.props.interaction.selection)return;if(!this.mainViewSignalValues[this.scopedSignalName("points_tuple")]||!this.previousPointSignal)return;const e=this.state.selectionPreviews.find(e=>"multi"===e.id);return e?(this.props.setSelection(e,this.props.interaction.id),!0):void 0}onMainViewPointSignal(e,t){this.mainViewSignalValues[e]!==t&&(e.indexOf("points_tuple")>=0&&(clearTimeout(this.previousPointSignalTimeout),this.previousPointSignal=this.mainViewSignalValues[e],this.previousPointSignalTimeout=setTimeout(()=>{this.previousPointSignal=null},800)),this.mainViewSignalValues[e]=t,this.updateIsDemonstrating(),this.updatePreviewSignals(e,t))}onMainViewIntervalSignal(e,t){this.mainViewSignalValues[e]!==t&&(this.mainViewSignalValues[e]=t,this.updateIsDemonstrating(),this.updatePreviewSignals(e,t))}onMainViewGridSignal(e,t){this.mainViewSignalValues[e]=t,this.updatePreviewSignals(e,t)}onSignal(e,t,n){v.onSignalInGroup(y.view,e,t,n)}onClickInteractionPreview(e){switch(e.type){case"point":case"interval":this.props.interaction&&this.props.setSelection(e,this.props.interaction.id);break;case"mark":case"scale":case"transform":this.props.interaction&&(e=e,this.props.toggleEnableApplicationType(e,this.props.interaction.id),this.props.interaction.applications.some(t=>t.id===e.id)||this.props.setApplication(e,this.props.interaction.id))}}getProjectionOptions(e){const t=[a.createElement("option",{key:"_vgsid_",value:"_vgsid_"},"None"),...this.props.fieldsOfGroup.map(e=>a.createElement("option",{key:e,value:e},e))];return a.createElement("div",null,a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"project_fields"},"Field:"),a.createElement("div",{className:"control"},a.createElement("select",{name:"project_fields",value:e.field,onChange:t=>this.onSelectProjectionField(e,t.target.value)},t))),a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"project_encodings"},"Encoding:"),a.createElement("div",{className:"control"},a.createElement("select",{name:"project_encodings",value:e.encoding,onChange:t=>this.onSelectProjectionEncoding(e,t.target.value)},a.createElement("option",{key:"null",value:"null"},"None"),a.createElement("option",{key:"x",value:"x"},"x"),a.createElement("option",{key:"y",value:"y"},"y")))))}onSelectProjectionField(e,t){const n=e.set("field",t);this.props.setSelection(n,this.props.interaction.id)}onSelectProjectionEncoding(e,t){let n;switch(t){case"x":n=e.set("encoding","x");break;case"y":n=e.set("encoding","y");break;default:n=e.set("encoding",null)}this.props.setSelection(n,this.props.interaction.id)}render(){const e=this.props.interaction,t=e.applications;return a.createElement("div",null,a.createElement(u.InteractionInputType,{interactionId:e.id,input:e.input,initializeInteraction:e=>this.initializeInteraction(e,!0)}),e.input?a.createElement("div",null,a.createElement("div",{className:"preview-controller"},a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Selections"),a.createElement("div",{className:"preview-scroll"},this.state.selectionPreviews.map(t=>a.createElement("div",{key:t.id,className:e&&e.selection&&e.selection.id===t.id?"selected":"",onClick:()=>this.onClickInteractionPreview(t)},a.createElement("div",{className:"preview-label"},t.label),a.createElement(d.default,{ref:e=>this.previewRefs[t.id]=e,id:`preview-${t.id}`,interaction:this.props.interaction,groupName:this.props.groupName,applicationPreviews:this.state.applicationPreviews,preview:t,canDemonstrate:this.props.canDemonstrate})))),e&&e.selection&&e.selection.id.includes("project")?this.getProjectionOptions(e.selection):null),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Applications"),a.createElement("div",{className:"preview-scroll "+(this.state.applicationPreviews.length>4?"overflow":"")},this.state.applicationPreviews.map(t=>a.createElement("div",{key:t.id,className:e&&r.applicationIsEnabled(t,e)?"selected":""},a.createElement("div",{onClick:()=>this.onClickInteractionPreview(t)},a.createElement("div",{className:"preview-label"},t.label),a.createElement(d.default,{ref:e=>this.previewRefs[t.id]=e,id:`preview-${t.id}`,interaction:this.props.interaction,groupName:this.props.groupName,applicationPreviews:this.state.applicationPreviews,preview:t,canDemonstrate:this.props.canDemonstrate}))))),a.createElement(f.InteractionApplicationProperties,{interaction:this.props.interaction,applications:t,groups:this.props.groups,marksOfGroups:this.props.marksOfGroups}))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Signals"),a.createElement(m.InteractionSignals,{interactionId:this.props.interaction.id,fieldsOfGroup:this.props.fieldsOfGroup,input:this.props.interaction.input,scaleInfo:this.props.scaleInfo}))):null)}})},1256:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(23),r=n(142),i=n(314),l=n(72);class o extends a.Component{constructor(e){super(e),this.width=75,this.height=75}previewToSpec(e){const t=e.targetGroupName||this.props.groupName;let n=r.cleanSpecForPreview(l.export(!1),this.width,this.height,t,this.props.interaction.id);switch(e.type){case"point":let t;this.props.interaction.applications.length&&(t=this.props.interaction.applications.find(e=>"mark"===e.type)),!t&&this.props.applicationPreviews.length&&(t=this.props.applicationPreviews.find(e=>"mark"===e.type)),t&&(n=r.addApplicationToScene(n,this.props.groupName,this.props.interaction.id,this.props.interaction.input,t));case"interval":return r.addSelectionToScene(n,this.props.groupName,this.props.interaction.id,this.props.interaction.input,e);case"mark":case"scale":case"transform":return this.props.interaction.selection&&(n=r.addSelectionToScene(n,this.props.groupName,this.props.interaction.id,this.props.interaction.input,this.props.interaction.selection)),r.addApplicationToScene(n,this.props.groupName,this.props.interaction.id,this.props.interaction.input,e)}}componentDidMount(){const e=this.previewToSpec(this.props.preview);this.view=new s.View(s.parse(e),{renderer:"svg",container:`#${this.props.groupName}-${this.props.id}`}),this.view.width(this.width),this.view.height(this.height),this.view.runAsync()}componentDidUpdate(e){if(!e.canDemonstrate&&this.props.canDemonstrate||e.groupName!==this.props.groupName||e.interaction!==this.props.interaction){const e=this.previewToSpec(this.props.preview);this.view=new s.View(s.parse(e),{renderer:"svg",container:`#${this.props.groupName}-${this.props.id}`}),this.view.width(this.width),this.view.height(this.height),this.view.runAsync()}}scaleSignalValues(e,t){const n=this.width/640,a=this.height/360;return e.startsWith("brush_x")&&Array.isArray(t)?t.map(e=>e*n):e.startsWith("brush_y")&&Array.isArray(t)?t.map(e=>e*a):e.startsWith("grid_translate_delta")&&t?{x:t.x*n,y:t.y*a}:t}setPreviewSignal(e,t){if(this.view){const n=this.scaleSignalValues(e,t);i.setSignalInGroup(this.view,this.props.groupName,e,n),this.view.runAsync()}}getPreviewSignal(e){if(this.view)return i.getSignalInGroup(this.view,this.props.groupName,e)}render(){return a.createElement("div",{id:`${this.props.groupName}-${this.props.id}`,className:"interaction-preview"})}}t.InteractionPreview=o,t.default=o},1257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r={setInput:n(143).setInput};t.InteractionInputType=s.connect(null,r)(class extends a.Component{onKeyboardKeydown(e){const t=e.which||e.keyCode,n=32===t?"Space":e.key;if(t!==this.props.input.keycode&&this.props.setInput(Object.assign(Object.assign({},this.props.input),{keycode:t,_key:n}),this.props.interactionId),13===t)return e.preventDefault(),!1}clearKeyboard(){this.props.setInput(Object.assign(Object.assign({},this.props.input),{keycode:void 0,_key:void 0}),this.props.interactionId)}onMouseValueChange(e){const t=e.target&&e.target.value;(!this.props.input||t&&t!==this.props.input.mouse)&&this.props.initializeInteraction(t)}mouseValueMap(){const e={drag:"Drag",click:"Click",mouseover:"Hover"};return this.props.input||(e.none="Select an event"),e}setHoverNearest(e){const t=e.target&&e.target.checked;this.props.setInput(Object.assign(Object.assign({},this.props.input),{nearest:t}),this.props.interactionId)}render(){const e=this.props.input;return a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Input Event"),a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"mouse-input"},"Mouse"),a.createElement("div",{className:"control"},a.createElement("div",null,a.createElement("select",{id:"mouse-input",name:"mouse-input",value:e?e.mouse:"none",onChange:e=>this.onMouseValueChange(e)},Object.entries(this.mouseValueMap()).map(([e,t])=>a.createElement("option",{key:e,value:e},t),this))))),e&&"mouseover"===e.mouse?a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"nearest-input"},"Nearest"),a.createElement("div",{className:"control"},a.createElement("div",null,a.createElement("input",{type:"checkbox",name:"nearest-input",checked:e.nearest,onClick:e=>this.setHoverNearest(e)})))):null,e?a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"key-input"},"Keyboard"),a.createElement("div",{className:"control"},a.createElement("div",null,a.createElement("input",{ref:e=>(e||{}).onsearch=(e=>this.clearKeyboard()),className:"key-input",name:"key-input",type:"search",onKeyDown:e=>this.onKeyboardKeydown(e),value:e&&e._key?e._key:"None"})))):null)}})},1258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(272),i=n(88),l=n(91),o=n(67),c=n(23),d=n(269),p=n(377),u=n(224),m=n(143),g=n(72);const h={startDragging:l.startDragging,stopDragging:l.stopDragging,setMarkVisual:o.setMarkVisual,setSignalPush:m.setSignalPush};t.InteractionSignals=s.connect(function(e){const t=e.getIn(["inspector","dragging"]);return{dragging:t&&t.signal?t:null,marks:e.getIn(["vis","present","marks"])}},h)(class extends a.Component{constructor(e){super(e),this.handleDragStart=(e=>{const t=this.props.interactionId,n=e.target.dataset.signal;this.props.startDragging(r.SignalDraggingState({interactionId:t,signal:n})),d.default.set(i.MODE,"channels"),g.update()}),this.handleDragEnd=(()=>{var e,t;const n=d.default.get(i.SELECTED),a=d.default.get(i.CELL),s=c.tupleid(n)&&c.tupleid(a);try{if(s){this.props.setSignalPush({[this.props.dragging.signal]:!0},this.props.dragging.interactionId);const s=+n.mark.role.split("lyra_")[1],r=p.channelName(a.key);let i=this.props.dragging.signal;if("text"===r){const n=null===(t=null===(e=this.props.marks.get(String(s)).encode)||void 0===e?void 0:e.update)||void 0===t?void 0:t.text;if(n){let e=n.signal||n.value||"";i=(e='"Text"'===e?"":e)+(e.endsWith('"')?" + ":" ")+i}}this.props.setMarkVisual({property:r,def:{signal:i}},s)}}catch(e){console.error("Unable to bind primitive"),console.error(e)}this.props.stopDragging(),d.default.set(i.MODE,"handles"),d.default.set(i.CELL,{}),s||g.update()})}render(){const e=u.getInteractionSignals(this.props.interactionId,this.props.input,this.props.scaleInfo,this.props.fieldsOfGroup);return a.createElement("div",{className:"signals-container"},e.map(e=>a.createElement("div",{key:e.label,draggable:!0,className:"signal",onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,"data-signal":e.signal},e.label)))}})},1259:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(224),i=n(143),l=n(202),o=n(142),c=n(1260),d=n(73),p=n(74);const u={setApplication:i.setApplication,removeApplication:i.removeApplication};t.InteractionApplicationProperties=s.connect(function(e,t){const n=t.interaction.get("groupId"),a=e.getIn(["vis","present","marks",String(n)]);return{scaleInfoOfGroups:t.groups.map(t=>o.getScaleInfoForGroup(e,t._id)),group:a}},u)(class extends a.Component{constructor(){super(...arguments),this.counter=0}canTargetMultiple(e){if("scale"===e.type)return!1;const t=e.targetGroupName,n=this.props.groups.find(e=>l.default(e.name)===t),a=this.props.marksOfGroups.get(n._id),s=this.props.groups.valueSeq().toArray().filter(t=>!e.id.startsWith("filter")||t._id!==this.props.group._id);return 1!==a.length||1!==s.length}getTargetMarkOptions(e){if("scale"===e.type)return null;const t=e.targetGroupName,n=this.props.groups.find(e=>l.default(e.name)===t),s=this.props.marksOfGroups.get(n._id);let r;return r=1===s.length?a.createElement("div",null,s[0].name):a.createElement("select",{name:"target_mark",value:e.targetMarkName,onChange:t=>this.onSelectTargetMarkName(e,t.target.value)},s.map(t=>{if(e.id.startsWith("size")&&"symbol"!==t.type)return null;const n=l.default(t.name);return a.createElement("option",{key:n,value:n},t.name)})),a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"target_mark"},"Mark:"),a.createElement("div",{className:"control"},r))}onSelectTargetMarkName(e,t){let n=e.set("targetMarkName",t);if(e.id.startsWith("color")){const e=this.props.marksOfGroups.get(this.props.group._id).find(e=>l.default(e.name)===t);n=n.set("propertyName","line"===e.type?"stroke":"fill")}this.props.setApplication(n,this.props.interaction.id)}getTargetGroupOptions(e){if("scale"===e.type)return null;const t=this.props.groups.valueSeq().toArray().filter(t=>!e.id.startsWith("filter")||t._id!==this.props.group._id);let n;return n=1===t.length?a.createElement("div",null,t[0].name):a.createElement("select",{name:"target_group",value:e.targetGroupName,onChange:t=>this.onSelectTargetGroup(e,t.target.value)},t.map(e=>{const t=l.default(e.name);return a.createElement("option",{key:t,value:t},e.name)})),a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"target_group"},"Group:"),a.createElement("div",{className:"control"},n))}onSelectTargetGroup(e,t){let n=e.set("targetGroupName",t);const a=this.props.groups.find(e=>l.default(e.name)==t);this.props.marksOfGroups.get(a._id).length&&(n=n.set("targetMarkName",l.default(this.props.marksOfGroups.get(a._id)[0].name))),e.scaleInfo&&(n=n.set("scaleInfo",this.props.scaleInfoOfGroups.get(a._id))),this.props.setApplication(n,this.props.interaction.id)}addApplication(e,t){const n=e.id;let a=n;for(;this.props.interaction.applications.some(e=>e.id==a);)a=n+this.counter++;const s=e.set("id",a);this.props.setApplication(s,t)}render(){const e=this.props.interaction,t=this.props.applications.filter(t=>r.applicationIsEnabled(t,e)).sort((e,t)=>e.type===t.type?e.id.localeCompare(t.id):"mark"===e.type?-1:"mark"===t.type?1:"scale"===e.type?-1:"scale"===t.type?1:void 0),n=t.map(e=>e.label).filter((e,t,n)=>t===n.indexOf(e));return a.createElement("div",{className:"application-options-wrap"},n.map(n=>{const s=t.filter(e=>e.label===n),r=s[0],i=this.canTargetMultiple(r);return a.createElement("div",{key:n},a.createElement("h5",{className:"application-options-label"},s[0].label,i?a.createElement("span",{className:"new",onClick:()=>this.addApplication(s[0],e.id)},a.createElement(d.Icon,{glyph:p.plus})):null),a.createElement("div",{className:"application-options-property-group"},s.map((t,n)=>{const r=this.getTargetGroupOptions(t),l=this.getTargetMarkOptions(t),o="mark"===t.type?a.createElement("div",null,a.createElement(c.InteractionMarkApplicationProperty,{interactionId:e.id,markApplication:t})):null;return a.createElement("div",{key:n,className:"application-options"},i&&s.length>1?a.createElement(d.Icon,{glyph:p.close,className:"delete",onClick:()=>{this.props.removeApplication(t,e.id)},"data-html":!0,"data-place":"right"}):null,r,l,o)})))}))}})},1260:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(202),i=n(143),l=n(108),o=n(142);t.InteractionMarkApplicationProperty=s.connect(function(e,t){const n=e.getIn(["vis","present","marks"]);let a=r.default(t.markApplication.targetGroupName);if(!a){const s=e.getIn(["vis","present","interactions",String(t.interactionId)]).groupId,i=n.get(String(s));a=r.default(i.name)}const s=n.find(e=>r.default(e.name)===a);return{targetMark:o.getNestedMarksOfGroup(e,s).find(e=>r.default(e.name)===t.markApplication.targetMarkName)}},function(e){return{setApplication:(t,n)=>{e(i.setApplication(t,n))}}})(class extends a.Component{constructor(e){super(e)}onUnselectedValueChange(e){const t=e.target&&e.target.value;t&&this.props.setApplication(this.props.markApplication.set("unselectedValue",t),this.props.interactionId)}render(){const e=this.props.markApplication.propertyName,t=this.props.targetMark,n=this.props.markApplication.unselectedValue,s={primId:t._id,primType:"marks"};switch(e){case"size":s.type="number",s.min="0",s.max="500";break;case"stroke":case"fill":s.type="color";break;case"opacity":s.type="range",s.min="0",s.max="1",s.step="0.05"}return a.createElement("div",null,a.createElement(l.Property,Object.assign({name:e,label:"Selected "+e,droppable:!0},s)),a.createElement(l.Property,Object.assign({name:"unselected"+e,label:"Unselected "+e,onChange:e=>this.onUnselectedValueChange(e),value:n,disabled:!1},s)))}})},1261:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(224),i=n(226),l=n(142),o=n(202),c=n(599),d=n(1262),p=n(1263),u=n(1264),m=n(72),g=n(314);const h={setSelection:i.setSelection,setApplication:i.setApplication,removeApplication:i.removeApplication,setSignals:i.setSignals};function f(e){return"nominal"===e.field.mtype||"ordinal"===e.field.mtype?[c.WidgetSelection({type:"radio",id:"radio",label:"Radio",comparator:"=="}),c.WidgetSelection({type:"select",id:"select",label:"Select",comparator:"=="})]:"temporal"===e.field.mtype||"quantitative"===e.field.mtype?[c.WidgetSelection({type:"range",id:"range",label:"Range",step:1,comparator:"=="})]:void 0}function y(e){const t=[];if(e.length){const n=e[0];t.push(r.MarkApplication({id:"color",label:"Color",targetMarkName:o.default(n.name),propertyName:"line"===n.type?"stroke":"fill",unselectedValue:"#797979"})),t.push(r.MarkApplication({id:"opacity",label:"Opacity",targetMarkName:o.default(n.name),propertyName:"opacity",unselectedValue:"0.2"})),"symbol"===n.type&&t.push(r.MarkApplication({id:"size",label:"Size",targetMarkName:o.default(n.name),propertyName:"size",unselectedValue:30}))}return t}t.WidgetInspector=s.connect(function(e,t){const n=e.getIn(["vis","present","widgets",String(t.primId)]),a=n.get("groupId"),s=l.getScaleInfoForGroup(e,a),r=e.getIn(["vis","present","marks",String(a)]),i=o.default(r.name),c=e.getIn(["vis","present","marks"]).filter(e=>"group"===e.type).mapEntries(([e,t])=>[Number(e),t]),d=c.map(t=>l.getNestedMarksOfGroup(e,t)),p=d.get(a),u=e.getIn(["vis","present","datasets"]);let g=[];if(p.length&&p[0].from&&p[0].from.data){const e=String(p[0].from.data);g=u.get(e).get("_schema").keySeq().toArray()}const h=e.getIn(["vega","isParsing"]),v=Boolean(!h&&m.view&&(s.xScaleName&&s.xFieldName||s.yScaleName&&s.yFieldName)),{selectionPreviews:_,applicationPreviews:b}=function(e,t,n){const a=t.get(e);return{selectionPreviews:f(n),applicationPreviews:y(a)}}(a,d,n);return{widget:n,groups:c,scaleInfo:s,group:r,groupName:i,datasets:u,marksOfGroups:d,fieldsOfGroup:g,canDemonstrate:v,selectionPreviews:_,applicationPreviews:b}},h)(class extends a.Component{constructor(){super(...arguments),this.previewRefs={},this.mainViewSignalValues={}}componentDidMount(){if(this.props.selectionPreviews&&this.props.selectionPreviews.length){const e=this.props.selectionPreviews.map(e=>e.id);this.props.widget.selection&&!e.every(e=>e!==this.props.widget.selection.id)||this.props.setSelection(this.props.selectionPreviews[0],this.props.widget.id)}if(this.props.applicationPreviews&&this.props.applicationPreviews.length){const e=this.props.applicationPreviews.map(e=>e.id);this.props.widget.applications.length&&!e.every(e=>this.props.widget.applications.map(e=>e.id).includes(e))||this.props.setApplication(this.props.applicationPreviews[0],this.props.widget.id)}this.props.setSignals(this.getInteractionSignals(this.props.widget),this.props.widget.id),this.restoreMainViewSignals(),this.restorePreviewSignals(),g.onSignal(`widget_${this.props.widget.id}`,(e,t)=>this.onMainViewWidgetSignal(e,t))}componentDidUpdate(e,t){!e.canDemonstrate&&this.props.canDemonstrate&&(this.restoreMainViewSignals(),this.restorePreviewSignals(),g.onSignal(`widget_${this.props.widget.id}`,(e,t)=>this.onMainViewWidgetSignal(e,t)))}restoreMainViewSignals(){const e=`widget_${this.props.widget.id}`;this.mainViewSignalValues[e]&&(m.view.signal(e,this.mainViewSignalValues[e]),m.view.runAsync())}restorePreviewSignals(){const e=`widget_${this.props.widget.id}`;this.mainViewSignalValues[e]&&(setTimeout(()=>{this.updatePreviewSignals(e,this.mainViewSignalValues[e])},50),this.updatePreviewSignals(e,this.mainViewSignalValues[e]))}updatePreviewSignals(e,t){this.props.applicationPreviews.forEach(n=>{this.previewRefs[n.id]&&this.previewRefs[n.id].setPreviewSignal(e,t)})}onMainViewWidgetSignal(e,t){this.mainViewSignalValues[e]!==t&&(this.mainViewSignalValues[e]=t,this.updatePreviewSignals(e,t))}onClickWidgetPreview(e){this.props.widget&&this.props.setSelection(e,this.props.widget.id)}onClickApplicationPreview(e){this.props.widget&&(this.widgetHasApplication(e)?this.props.removeApplication(e,this.props.widget.id):this.props.setApplication(e,this.props.widget.id))}widgetHasApplication(e){return this.props.widget.applications.some(t=>t.id===e.id)}getComparatorOptions(e){const t=["==","<",">","<=",">="].map(e=>a.createElement("option",{key:e,value:e},e));return a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"widget_comparator"},"Comparator:"),a.createElement("div",{className:"control"},a.createElement("select",{name:"widget_comparator",value:e.comparator,onChange:t=>this.onSelectComparator(e,t.target.value)},t)))}onSelectComparator(e,t){const n=e.set("comparator",t);this.props.setSelection(n,this.props.widget.id)}getTargetMarkOptions(e){const t=this.props.marksOfGroups.get(this.props.group._id);if(1===t.length)return null;const n=t.map(e=>{const t=o.default(e.name);return a.createElement("option",{key:t,value:t},t)});return a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"target_mark"},"Target Mark:"),a.createElement("div",{className:"control"},a.createElement("select",{name:"target_mark",value:e.targetMarkName,onChange:t=>this.onSelectTargetMarkName(e,t.target.value)},n)))}onSelectTargetMarkName(e,t){let n=e.set("targetMarkName",t);if(e.id.startsWith("color")){const e=this.props.marksOfGroups.get(this.props.group._id).find(e=>o.default(e.name)===t);n=n.set("propertyName","line"===e.type?"stroke":"fill")}this.props.setApplication(n,this.props.widget.id)}getInteractionSignals(e){return[{signal:`widget_${e.id}`,label:`widget_${e.field.name}`}]}render(){const e=this.props.widget,t=e.applications;return a.createElement("div",null,a.createElement("div",null,a.createElement("div",{className:"preview-controller"},a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Selections"),a.createElement("div",{className:"preview-scroll"},this.props.selectionPreviews.map(t=>a.createElement("div",{key:t.id,className:e&&e.selection&&e.selection.id===t.id?"selected":"",onClick:()=>this.onClickWidgetPreview(t)},a.createElement("div",{className:"preview-label"},t.label),a.createElement(d.default,{id:`preview-${t.id}`,groupName:this.props.groupName,widget:this.props.widget,preview:t})))),e&&e.selection?this.getComparatorOptions(e.selection):null),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Applications"),a.createElement("div",{className:"preview-scroll"},this.props.applicationPreviews.map(t=>a.createElement("div",{key:t.id,className:e&&this.widgetHasApplication(t)?"selected":""},a.createElement("div",{onClick:()=>this.onClickApplicationPreview(t)},a.createElement("div",{className:"preview-label"},t.label),a.createElement(d.default,{ref:e=>this.previewRefs[t.id]=e,id:`preview-${t.id}`,groupName:this.props.groupName,widget:this.props.widget,preview:t}))))),t.map(t=>"mark"===t.type?a.createElement("div",null,this.getTargetMarkOptions(t),a.createElement(p.WidgetMarkApplicationProperty,{widgetId:e.id,groupId:e.groupId,markApplication:t})):null))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Signals"),a.createElement(u.WidgetSignals,{widgetId:this.props.widget.id,signals:this.props.widget.signals}))))}})},1262:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(23),r=n(142),i=n(72);n(314);class l extends a.Component{constructor(){super(...arguments),this.width=75,this.height=75}previewToSpec(e){const t=this.props.groupName;let n=r.cleanSpecForPreview(i.export(!1),this.width,this.height,t,this.props.widget.id);return this.props.widget.selection&&(n=r.addWidgetSelectionToScene(n,this.props.widget,this.props.widget.selection)),r.addWidgetApplicationToScene(n,this.props.groupName,this.props.widget,e)}componentDidMount(){if(this.props.preview.targetMarkName){const e=this.previewToSpec(this.props.preview);this.view=new s.View(s.parse(e),{renderer:"svg",container:`#${this.props.groupName}-${this.props.id}`}),this.view.width(this.width),this.view.height(this.height),this.view.runAsync()}}componentDidUpdate(e){if(this.props.preview.targetMarkName&&(e.groupName!==this.props.groupName||e.widget!==this.props.widget||e.widget.selection!==this.props.widget.selection)){const e=this.previewToSpec(this.props.preview);this.view=new s.View(s.parse(e),{renderer:"svg",container:`#${this.props.groupName}-${this.props.id}`}),this.view.width(this.width),this.view.height(this.height),this.view.runAsync()}}widgetPreview(){const e=r.widgetParams(this.props.widget.field,this.props.widget.dsId);switch(this.props.preview.type){case"radio":return e.options?e.options.map((e,t)=>a.createElement("div",{key:e},a.createElement("input",{type:"radio",name:this.props.preview.id,value:e,checked:0===t||null}),a.createElement("label",{htmlFor:this.props.preview.id},e))):null;case"range":return a.createElement("div",null,a.createElement("input",Object.assign({type:"range"},e)),a.createElement("label",{htmlFor:this.props.preview.id},this.props.widget.field.name));case"select":return a.createElement("select",{value:e.options&&e.options.length?e.options[0]:null},e.options?e.options.map(e=>a.createElement("option",{value:e},e)):null)}}setPreviewSignal(e,t){this.view&&(this.view.signal(e,t),this.view.runAsync())}render(){const e=this.props.preview.targetMarkName;return a.createElement("div",{id:`${this.props.groupName}-${this.props.id}`,className:"interaction-preview"},e?null:this.widgetPreview())}}t.WidgetPreview=l,t.default=l},1263:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(43),r=n(33),i=n(202),l=n(226),o=n(108),c=n(142);t.WidgetMarkApplicationProperty=r.connect(function(e,t){const n=e.getIn(["vis","present","marks",String(t.groupId)]);return{marks:s.Map(c.getNestedMarksOfGroup(e,n).map(e=>[i.default(e.name),e]))}},function(e){return{setApplication:(t,n)=>{e(l.setApplication(t,n))}}})(class extends a.Component{constructor(e){super(e)}onUnselectedValueChange(e){const t=e.target&&e.target.value;t&&this.props.setApplication(this.props.markApplication.set("unselectedValue",t),this.props.widgetId)}render(){const e=this.props.markApplication.propertyName,t=this.props.markApplication.targetMarkName,n=this.props.marks.filter((e,n)=>n===t).valueSeq().first(),s=this.props.markApplication.unselectedValue,r={primId:n._id,primType:"marks"};switch(e){case"size":r.type="number",r.min="0",r.max="500";break;case"stroke":case"fill":r.type="color";break;case"opacity":r.type="range",r.min="0",r.max="1",r.step="0.05"}return a.createElement("div",null,a.createElement(o.Property,Object.assign({name:e,label:"Selected "+e,droppable:!0},r)),a.createElement(o.Property,Object.assign({name:"unselected"+e,label:"Unselected "+e,onChange:e=>this.onUnselectedValueChange(e),value:s,disabled:!1},r)))}})},1264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(272),i=n(88),l=n(91),o=n(67),c=n(23),d=n(269),p=n(377),u=n(72);const m={startDragging:l.startDragging,stopDragging:l.stopDragging,setMarkVisual:o.setMarkVisual};t.WidgetSignals=s.connect(function(e){const t=e.getIn(["inspector","dragging"]);return{dragging:t&&t.signal?t:null}},m)(class extends a.Component{constructor(e){super(e),this.handleDragStart=(e=>{const t=e.target.dataset.signal;this.props.startDragging(r.SignalDraggingState({signal:t})),d.default.set(i.MODE,"channels"),u.update()}),this.handleDragEnd=(()=>{const e=d.default.get(i.SELECTED),t=d.default.get(i.CELL),n=c.tupleid(e)&&c.tupleid(t);try{if(n){const n=+e.mark.role.split("lyra_")[1],a=p.channelName(t.key);this.props.setMarkVisual({property:a,def:{signal:this.props.dragging.signal}},n)}}catch(e){console.error("Unable to bind primitive"),console.error(e)}this.props.stopDragging(),d.default.set(i.MODE,"handles"),d.default.set(i.CELL,{}),n||u.update()})}render(){return a.createElement("div",{className:"signals-container"},this.props.signals.map(e=>a.createElement("div",{key:e.signal,draggable:!0,className:"signal",onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,"data-signal":e.signal},e.label)))}})},1265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(108),r=n(422);t.SymbolInspector=class extends a.Component{render(){const e=this.props;return a.createElement("div",null,a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Position"),a.createElement(s.Property,Object.assign({name:"x",label:"X",type:"number",droppable:!0},e)),a.createElement(s.Property,Object.assign({name:"y",label:"Y",type:"number",droppable:!0},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Geometry"),a.createElement(s.Property,Object.assign({name:"shape",label:"Shape",type:"select",opts:r.SymbolShapes,droppable:!0},e)),a.createElement(s.Property,Object.assign({name:"size",label:"Size",type:"number",droppable:!0},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Fill"),a.createElement(s.Property,Object.assign({name:"fill",label:"Color",type:"color",droppable:!0},e)),a.createElement(s.Property,Object.assign({name:"fillOpacity",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05",droppable:!0},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Stroke"),a.createElement(s.Property,Object.assign({name:"stroke",label:"Color",type:"color",droppable:!0},e)),a.createElement(s.Property,Object.assign({name:"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25",droppable:!0},e))))}}},1266:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(74),s=n(47).getInVis,r=n(13),i=n(33),l=n(67),o=n(582),c=n(108);t.TextInspector=i.connect(function(e,t){const n=t.primId;return{dsId:s(e,`marks.${n}.from.data`),text:s(e,`marks.${n}.encode.update.text.signal`)}},function(e,t){return{updateTextAttributes:function(n,a){e(l.setMarkVisual({property:n,def:{signal:a}},t.primId))},updateText:function(n){e(l.setMarkVisual({property:"text",def:{signal:n}},t.primId))}}})(class extends r.Component{constructor(e){super(e)}render(){const e=this.props,t=e.dsId;return r.createElement("div",null,r.createElement("div",{className:"property-group"},r.createElement(c.Property,Object.assign({name:"text.signal",value:e.text,type:"autocomplete",autoType:"tmpl",droppable:!0,dsId:t,onChange:e.updateText},e),r.createElement("h3",{className:"label"},"Text"))),r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Font"),r.createElement(c.Property,Object.assign({name:"font",label:"Face",type:"select",opts:o.TextFonts,droppable:!0},e)),r.createElement(c.Property,Object.assign({name:"fontSize",label:"Size",type:"number",droppable:!0},e)),r.createElement(c.Property,Object.assign({name:"fontWeight",label:"Weight",type:"toggle",glyph:a.bold,opts:o.TextFontWeights.map(e=>String(e)),droppable:!0},e)),r.createElement(c.Property,Object.assign({name:"fontStyle",label:"Style",type:"toggle",glyph:a.italic,opts:o.TextFontStyles,droppable:!0},e)),r.createElement(c.Property,Object.assign({name:"fill",label:"Color",type:"color",droppable:!0},e)),r.createElement(c.Property,Object.assign({name:"fillOpacity",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05",droppable:!0},e))),r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Position"),r.createElement(c.Property,Object.assign({name:"x",label:"X",type:"number",droppable:!0},e)),r.createElement(c.Property,Object.assign({name:"y",label:"Y",type:"number",droppable:!0},e))),r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Offset"),r.createElement(c.Property,Object.assign({name:"dx",label:"X",type:"number",droppable:!0},e)),r.createElement(c.Property,Object.assign({name:"dy",label:"Y",type:"number",droppable:!0},e))),r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Align"),r.createElement(c.Property,Object.assign({name:"align",label:"Horizontal",type:"selection",glyphs:[a["align-left"],a["align-center"],a["align-right"]],opts:o.TextAlignments,droppable:!0},e)),r.createElement(c.Property,Object.assign({name:"baseline",label:"Vertical",type:"selection",glyphs:[a["vertical-align-top"],a["vertical-align-center"],a["vertical-align-bottom"]],opts:o.TextBaselines,droppable:!0},e)),r.createElement(c.Property,Object.assign({name:"angle",label:"Rotation",type:"number",droppable:!0},e))))}})},1267:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(1268),r=n(1284);t.PipelinesToolbar=class extends a.PureComponent{constructor(e){super(e),this.openModal=(()=>this.setState({modalIsOpen:!0})),this.closeModal=(()=>this.setState({modalIsOpen:!1})),this.state={modalIsOpen:!1}}render(){return a.createElement("div",{id:"pipeline-toolbar"},a.createElement("h2",null,"Data Pipelines"),a.createElement(s.PipelineList,{openModal:this.openModal}),a.createElement(r.default,{modalIsOpen:this.state.modalIsOpen,closeModal:this.closeModal}))}}},1268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(91),i=n(315),l=n(73),o=n(1269),c=n(47).getInVis,d=n(317),p=n(74);const u={selectPipeline:r.selectPipeline,updatePipeline:i.updatePipelineProperty};t.PipelineList=s.connect(function(e){return{pipelines:c(e,"pipelines"),selectedId:e.getIn(["inspector","pipelines","selectedId"])}},u)(class extends a.Component{render(){const e=this.props.pipelines.keySeq().toArray(),t=this.props.pipelines.valueSeq().toArray(),n=this.props.selectedId?this.props.selectedId:e.length?e[0]:this.props.selectedId;return a.createElement("div",{id:"pipeline-list",style:{marginTop:t.length?-20:-15}},a.createElement("div",{className:"pipeline-tabs"},t.length?t.map(e=>{const t=e._id,s=e.name;return a.createElement(d,{key:t,className:"header "+(n===t?"selected":""),value:s,save:this.props.updatePipeline.bind(this,t,"name"),onClick:()=>this.props.selectPipeline(t)})}):null,a.createElement("span",{className:"new",onClick:this.props.openModal},a.createElement(l.Icon,{glyph:p.plus})," New")),e.length?e.map(e=>a.createElement(o.PipelineInspector,{key:e,id:e,selectedId:n})):a.createElement("div",{id:"pipeline-hint",onClick:this.props.openModal},"Add a new data pipeline to get started."))}})},1269:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(1270),i=n(47).getInVis;t.PipelineInspector=s.connect(function(e,t){const n=t.id;return{pipeline:i(e,"pipelines."+n)}})(class extends a.Component{render(){const e=this.props,t=e.pipeline,n=e.id;let s;const i=+e.selectedId==+n;return i&&(s=a.createElement("div",null,a.createElement(r.default,{id:t._source,fieldsCount:6}),t._aggregates.entrySeq().map(function(e,t){return a.createElement("div",{key:t,className:"aggregate"},a.createElement("p",{className:"source"},"Group By: ",e[0].split("|").join(", ")),a.createElement(r.default,{id:e[1],fieldsCount:6}))}))),a.createElement("div",{className:"pipeline"+(i?" selected":"")},s)}})},1270:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(1271),s=n(13),r=n(33),i=n(604),l=n(885),o=n(47).getInVis;t.default=r.connect(function(e,t){const n=t.id;return{dataset:o(e,"datasets."+n)}})(class extends s.Component{constructor(e){super(e),this.onPage=this.onPage.bind(this),this.state={page:0,scroll:0}}onPage(e){this.setState({page:e})}onScroll(e){e!==this.state.scroll&&this.setState({scroll:e})}render(){const e=this.props,t=e.id,n=e.dataset.get("_schema").keySeq().toArray(),r=~~(n.length/e.fieldsCount),o=Math.ceil(n.length/(r+1)),c=[];for(let e=0;e<=r;e++)c.push(s.createElement(l.default,{key:e,id:this.props.id,first:0===e,last:e===r,fieldsIndex:e,fieldsCount:o,limit:20,page:this.state.page,onPage:this.onPage,scroll:this.state.scroll,onScroll:i.throttle(250,e=>this.onScroll(e))}));return c.push(s.createElement("div",{key:"TransformList",className:"datatable-container"},s.createElement(a.default,{dsId:t}))),s.createElement("div",{className:"datatable-multi"},c)}})},1271:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(1272),i=n(47).getInVis;t.default=s.connect(function(e,t){return{transforms:i(e,"datasets."+t.dsId+".transform")}})(class extends a.Component{constructor(e){super(e),this.state={expandedIndex:null}}setExpandedIndex(e){this.setState({expandedIndex:e})}render(){const e=this.props,t=e.transforms.filter(e=>"aggregate"!==e.type),n=!!t&&1===t.length&&"aggregate"===t[0].type,s=e.dsId;return t&&t.length&&!n?a.createElement("div",{className:"transform-list"},t.map(function(e,t){return"identifier"===e.type?null:a.createElement(r.default,{key:t,index:t,dsId:s,def:e,expanded:this.state.expandedIndex===t,setExpandedIndex:e=>this.setExpandedIndex(e)})},this)):null}})},1272:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(141),i=n(1273),l=n(1274),o=n(1275),c=n(373);class d extends a.Component{constructor(){super(...arguments),this.Filter=i.Filter,this.Formula=l.Formula,this.Lookup=o.default,this.timer=null,this.resetTimer=(()=>{window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{},1e4)}),this.expand=(()=>{this.props.setExpandedIndex(this.props.index),this.resetTimer()}),this.updateTransform=(e=>{this.props.updateTransform(e),this.resetTimer()})}componentDidMount(){this.resetTimer()}componentWillUnmount(){window.clearTimeout(this.timer)}render(){const e=this.props,t=c(e.def.type),n=this[t];return this.props.expanded?a.createElement("div",{className:"transform-inspector"},a.createElement(n,Object.assign({update:this.updateTransform},e))):a.createElement("div",{className:"transform-button",onClick:this.expand},t)}}t.TransformInspector=d,t.default=s.connect(null,function(e,t){return{updateTransform:function(n){e(r.updateTransform({index:t.index,transform:n},t.dsId))}}})(d)},1273:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(85),r=n(108),i=n(72);t.Filter=class extends a.Component{constructor(){super(...arguments),this.updateFilter=(e=>{let t=e.target?e.target.value:e;if(i.view)try{s.default(t,{getSignal:e=>i.view.signal(e),signalRef:()=>null}),this.props.update({type:"filter",expr:t})}catch(e){console.warn(e)}else setTimeout(()=>{this.updateFilter(e)},100)})}render(){const e=this.props,t=e.dsId;return a.createElement(r.Property,{type:"autocomplete",droppable:!0,autoType:"expr",label:"Filter",primType:"datasets",primId:t,name:"transform."+e.index+".expr",dsId:t,onChange:this.updateFilter})}}},1274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(85),r=n(108),i=n(72);t.Formula=class extends a.Component{constructor(){super(...arguments),this.updateFormula=(e=>{const t=this.props,n=t.def,a=e.target?e.target.value:n.as,r=e.target?n.expr:e;if(i.view)try{s.default(r,{getSignal:e=>i.view.signal(e),signalRef:()=>null}),t.update({type:"formula",as:a,expr:r})}catch(e){}else setTimeout(()=>{this.updateFormula(e)},100)})}render(){const e=this.props,t=this.updateFormula,n=e.dsId;return a.createElement("div",null,a.createElement(r.Property,{type:"autocomplete",droppable:!0,label:"Calculate",autoType:"expr",primType:"datasets",primId:n,name:"transform."+e.index+".expr",dsId:n,onChange:t}),a.createElement(r.Property,{type:"text",label:"As",primType:"datasets",primId:n,name:"transform."+e.index+".as",onChange:t}))}}},1275:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(108);class i extends a.Component{constructor(e){super(e),this.state={from:+e.def.from,values:e.def.fields},this.handleFromChange=this.handleFromChange.bind(this),this.handleValuesChange=this.handleValuesChange.bind(this),this.updateLookupTransform=this.updateLookupTransform.bind(this)}handleFromChange(e){const t=+e.target.value;this.setState({from:t}),this.updateLookupTransform(t)}handleValuesChange(e){const t=[];for(const n of e.target.options)n.selected&&t.push(n.value);this.setState({values:t}),this.updateLookupTransform(null,t)}updateLookupTransform(e,t){const n=this.state,a=this.props,s=a.def;e=e||n.from,t=t||n.values;const r=a.pipelines.find(t=>t.id===e).name,i=t.map(e=>`${r}_${e}`);a.update({type:"lookup",fields:s.fields,from:""+e,key:s.key,values:t,as:i})}render(){const e=this.props,t=e.pipelines.find(e=>e.id===this.state.from).fields;return a.createElement("div",null,a.createElement(r.Property,{type:"select",label:"Lookup",primType:"datasets",primId:e.dsId,name:"transform."+e.index+".fields.0",opts:e.fields,onChange:this.updateLookupTransform}),a.createElement(r.Property,{type:"select",label:"Pipeline"},a.createElement("div",{className:"control"},a.createElement("select",{value:this.state.from,onChange:this.handleFromChange},e.pipelines.map(e=>a.createElement("option",{value:e.id},e.name))))),a.createElement(r.Property,{type:"select",label:"Key",primType:"datasets",primId:e.dsId,name:"transform."+e.index+".key",opts:t,onChange:this.updateLookupTransform}),a.createElement(r.Property,{type:"select",label:"Fields"},a.createElement("div",{className:"control"},a.createElement("select",{value:this.state.values,multiple:!0,onChange:this.handleValuesChange},t.map(e=>a.createElement("option",null,e))))))}}t.Lookup=i,t.default=s.connect(function(e,t){return{pipelines:e.getIn(["vis","present","pipelines"]).valueSeq().toJS().map(t=>({id:t._source,name:t.name,fields:e.getIn(["vis","present","datasets",String(t._source),"_schema"]).keySeq().toJS()})),fields:e.getIn(["vis","present","datasets",String(t.dsId),"_schema"]).keySeq().toJS()}})(i)},1276:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(227),i=n(23),l=n(377),o=n(91),c=n(269),d=n(272),p=n(88),u=n(313),m=n(73),g=n(1277),h=n(1279),f=n(1280),y=n(1281),v=n(1282),_=n(72),b=n(47).getInVis,S=n(74),x=n(886).QUANTITATIVE;const E={bindChannel:l.default,startDragging:o.startDragging,stopDragging:o.stopDragging};t.default=s.connect(function(e,t){return{srcId:b(e,"pipelines."+b(e,"datasets."+t.dsId+"._parent")+"._source")}},E)(class extends a.Component{constructor(e){super(e),this.handleDragStart=(e=>{const t=e.target.classList;this.setState(e=>Object.assign(Object.assign({},e),{bindField:u.default(this.state.fieldDef),showAggregates:t.contains("aggregate-field")}));const n=this.props.dsId,a=this.state.fieldDef;this.props.startDragging(d.FieldDraggingState({dsId:n,fieldDef:a})),c.default.set(p.MODE,"channels"),_.update()}),this.handleDragEnd=((e,t)=>{const n=this.props,a=c.default.get(p.SELECTED),s=c.default.get(p.CELL),r=this.state.bindField,l=i.tupleid(a)&&i.tupleid(s),o=r.source?n.srcId:n.dsId;try{if(l){const e=+a.mark.role.split("lyra_")[1];i.extend(r,t),n.bindChannel(o,r,e,s.key)}}catch(e){console.error("Unable to bind primitive"),console.error(e)}n.stopDragging(),c.default.set(p.MODE,"handles"),c.default.set(p.CELL,{}),this.setState({bindField:null}),l||_.update()}),this.toggleTransforms=(e=>{this.setState({showAggregates:!this.state.showAggregates})}),this.state={fieldDef:null,offsetTop:null,bindField:null,showAggregates:!1}}componentWillReceiveProps(e){const t=e.def,n=e.schema;this.setState(e=>t?Object.assign(Object.assign({},e),{fieldDef:n.get(t.name),offsetTop:t.offsetTop,showAggregates:!1}):Object.assign(Object.assign({},e),{fieldDef:null,showAggregates:!1}))}componentDidUpdate(){r.default.rebuild()}render(){const e=this.props.dsId,t=this.state,n=document.querySelector(".field.source"),s=n?n.getBoundingClientRect():{height:1,width:1},r=t.fieldDef,i={top:t.offsetTop,display:r?"block":"none"},l={top:(this.props.dataTableTop||0)+t.offsetTop,left:(this.props.dataTableLeft||0)-50,display:r&&t.showAggregates?"block":"none"},o={display:i.display,top:t.offsetTop-18,height:s.height+26,width:2*s.width},c={onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd},d=r?a.createElement("div",null,a.createElement(h.default,{dsId:e,field:r}),r.mtype===x?a.createElement(m.Icon,{onClick:this.toggleTransforms,glyph:S.aggregate,width:"10",height:"10","data-tip":"Show aggregations"}):null,a.createElement("span",{className:"fieldName"},r.name),a.createElement(f.default,{dsId:e,field:r}),a.createElement(y.default,{dsId:e,field:r}),a.createElement(v.default,{dsId:e,field:r})):null;return a.createElement("div",{onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd},a.createElement("div",{className:"buffer full",style:o}),a.createElement("div",{style:i,draggable:!0,className:"full field "+(r&&r.source?"source":"derived")},d),a.createElement(g.AggregateList,Object.assign({handlers:c,style:l,field:r},this.props)))}})},1277:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(1278),r=n(596),i=5;t.AggregateList=class extends a.Component{constructor(e){super(e),this.expand=(()=>{this.setState({fullList:!0})}),this.state={fullList:!1}}componentWillReceiveProps(e){e.field!==this.props.field&&this.setState({fullList:!1})}render(){const e=this.props,t=this.state.fullList,n=r.slice(0,t?void 0:i);return a.createElement("div",{className:"aggregates-list",style:e.style},n.map(function(t,n){return a.createElement(s.default,Object.assign({op:t,key:n,field:e.field},e.handlers))}),t?null:a.createElement("div",{className:"more full field derived",onClick:this.expand},"+ More"))}}},1278:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13);n(596);t.default=class extends a.Component{constructor(){super(...arguments),this.onDragEnd=(e=>{const t=this.props;t.onDragEnd(e,{aggregate:t.op})})}render(){const e=this.props,t=e.field,n=t?t.name:null;return a.createElement("div",{className:"full field derived aggregate-field",draggable:!0,onDragStart:e.onDragStart,onDragEnd:this.onDragEnd},a.createElement("strong",null,e.op),"_",n)}}},1279:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(227),i=n(141),l=n(73),o=n(373),c=n(886),d=n(74);t.default=s.connect(null,function(e,t){return{changeType:function(){const n=t.field;let a=c.indexOf(n.mtype);a=(a+1)%c.length,e(i.changeFieldMType({field:n.name,mtype:c[a]},t.dsId))}}})(class extends a.Component{componentDidUpdate(){r.default.rebuild()}render(){const e=this.props,t=e.field.mtype;return a.createElement(l.Icon,{onClick:e.changeType,glyph:d[t],width:"10",height:"10","data-tip":o(t)+" field"})}})},1280:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(141),i=n(73),l=n(74);class o extends a.Component{render(){return a.createElement(i.Icon,{onClick:this.props.filter,glyph:l.filter,width:"10",height:"10","data-tip":"Filter"})}}t.FilterIcon=o,t.default=s.connect(null,function(e,t){return{filter:function(){e(r.addTransform({type:"filter",expr:"datum."+t.field.name},t.dsId))}}})(o)},1281:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(141),i=n(73),l=n(74);class o extends a.Component{render(){return a.createElement(i.Icon,{onClick:this.props.formula,glyph:l.formula,width:"10",height:"10","data-tip":"Calculate a new field"})}}t.FormulaIcon=o,t.default=s.connect(null,function(e,t){return{formula:function(){const n=t.field.name;e(r.addTransform({type:"formula",as:"calc_"+n,expr:"datum."+n},t.dsId))}}})(o)},1282:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(141),i=n(73),l=n(74);class o extends a.Component{render(){const e=this.props;return e.size>1?a.createElement(i.Icon,{onClick:()=>e.lookup(e.from),glyph:l.lookup,height:"10","data-tip":"Lookup record on another pipeline"}):null}}t.LookupIcon=o,t.default=s.connect(function(e,t){const n=e.getIn(["vis","present","pipelines"]),a=n.first();return{size:n.size,from:a._source}},function(e,t){return{lookup:function(n){const a=t.field.name;e(r.addTransform({type:"lookup",from:""+n,key:a,fields:[a],values:[],as:[]},t.dsId))}}})(o)},1283:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(594);t.default=class extends a.Component{render(){const e=this.props,t=e.event;if(!t)return null;const n=s.select(t.target),r=n.node(),i=r.parentNode.firstChild,l=i.getBoundingClientRect(),o=i.offsetLeft+l.width,c=n.classed("odd")?"odd":"even",d={display:"block",left:r.offsetLeft-e.scrollLeft+o,top:i.offsetTop};return a.createElement("div",{className:"full value "+c,style:d},n.text())}}},1284:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(1285),r=n(33),i=n(315),l=n(374),o=n(583),c=n(225),d=n(606),p=n(885),u=n(1294),m=/([\w\d_-]*)\.?[^\\\/]*$/i,g=n(1295),h=[{label:"Cars",name:"cars.json",description:"Vehicular data which consists of names, cylinders and displacement"},{label:"Seattle Weather",name:"seattle-weather.csv",description:"Seattle weather data, including temperature, precipitation, and type of weather"},{label:"Stocks",name:"stocks.csv",description:"Stock data including symbols, dates, and prices"},{label:"Budgets",name:"budgets.json",description:"Projected and real U.S. national budgets, from NYTs Amanda Cox"},{label:"S&P 500",name:"sp500.csv",description:"Date and price data for the S&P 500 stock index"}],f=Object.keys(g).filter(e=>e.endsWith(".csv")||e.endsWith(".tsv")||e.endsWith(".json")).filter(e=>![...h.map(e=>e.name),"annual-precip.json","miserables.json","londonBoroughs.json","us-10m.json","volcano.json","weather.json","world-110m.json","movies.json","budget.json","earthquakes.json"].includes(e)).sort(),y=f.map(e=>g[e].url);const v={addPipeline:i.addPipeline,derivePipeline:i.derivePipeline};class _ extends a.Component{constructor(e){super(e),this.initialState={error:null,success:null,loading:!1,showPreview:!1,selectedExample:null,selectedVegaDataset:y.length?y[0]:"",name:null,pipeline:null,dataset:null,values:null,isDerived:!1},this.state=this.initialState,this.loadURL=this.loadURL.bind(this),this.fopen=this.fopen.bind(this)}createPipeline(e){const t=e.match(m)[1];this.setState({name:t,pipeline:o.Pipeline({name:t})})}createDataset(e){const t=c.parseRaw(e),n=t.values;this.setState({values:n,dataset:l.Dataset({name:this.state.name,format:t.format,_schema:c.schema(n)})})}success(e,t){this.setState({error:null,success:e||null,showPreview:!0,selectedExample:t,isDerived:!1})}error(e){this.setState({error:e.statusText||e.message||"An error occurred!",success:null,selectedExample:null,isDerived:!1})}done(e){const t=this.state;e&&null===t.error&&(this.state.isDerived?this.props.derivePipeline(t.pipeline._id):this.props.addPipeline(t.pipeline,t.dataset,t.values)),this.setState(this.initialState),this.props.closeModal()}loadURL(e,t){this.createPipeline(e),this.setState({loading:!0}),d.get(e,(n,a)=>{this.setState({loading:!1}),a?this.error(a):(this.createDataset(n),this.success(t?null:`Successfully imported ${e}`),this.setState({selectedExample:e}))})}selectPipelineToDerive(e){const t=this.props.datasets.get(String(e._source));this.setState({name:e.name,pipeline:e,dataset:t,values:c.output(t._id),isDerived:!0,showPreview:!0,selectedExample:String(e._id)})}fopen(e){d.read(e.target.files,(e,t)=>{this.createPipeline(t.name),this.createDataset(e),this.success(`Successfully imported ${t.name}`)})}render(){const e=this.props,t=this.state,n=t.loading,r=t.error,i=t.success,l=t.showPreview,o=this.done.bind(this,!1);return a.createElement(s,{isOpen:e.modalIsOpen,onRequestClose:o,contentLabel:"Pipeline Modal",style:{overlay:{display:"flex",alignItems:"center",justifyContent:"center"},content:{overflow:"hidden",top:null,bottom:null,left:null,right:null,width:"550px",height:"auto",padding:null}}},a.createElement("div",{className:"pipelineModal"},a.createElement("span",{className:"closeModal",onClick:o},"close"),a.createElement("div",{className:"row"},a.createElement("div",{className:"examples"},a.createElement("h2",null,"Example Datasets"),a.createElement("ul",null,h.map(function(e){const n=e.label,s=e.description,r=g[e.name].url,i=t.selectedExample===r?"selected":null;return a.createElement("li",{key:n,onClick:this.loadURL.bind(this,r,!0),className:i},a.createElement("p",{className:"example-name"},n),a.createElement("p",null,s))},this),a.createElement("li",{className:y.includes(t.selectedExample)?"selected":null,onClick:this.loadURL.bind(this,t.selectedVegaDataset,!0)},a.createElement("p",{className:"example-name"},"More Example Datasets"),a.createElement("select",{value:t.selectedVegaDataset,onChange:e=>{this.setState({selectedVegaDataset:e.target.value})}},f.map(e=>a.createElement("option",{key:e,value:g[e].url},e)))))),a.createElement("div",{className:"load"},a.createElement("h2",null,"Import a Dataset"),a.createElement("p",null,"Data must be in a tabular form. Supported import formats include ",a.createElement("abbr",{title:"JavaScript Object Notation"},"json"),", ",a.createElement("abbr",{title:"Comma-Separated Values"},"csv")," and ",a.createElement("abbr",{title:"Tab-Separated Values"},"tsv")),a.createElement("p",null,a.createElement("input",{type:"file",accept:".json,.tsv,.csv",onChange:this.fopen})),a.createElement("p",null,"or"),a.createElement(u.default,{loadURL:this.loadURL}))),this.props.pipelines.length?a.createElement("div",{className:"row"},a.createElement("div",{className:"derive"},a.createElement("h2",null,"Derive from Existing Dataset"),a.createElement("ul",null,this.props.pipelines.map(function(e){const n=e.name,s=t.selectedExample===String(e._id)?"selected":null;return a.createElement("li",{key:n,onClick:()=>this.selectPipelineToDerive(e),className:s},a.createElement("p",{className:"pipeline-name"},n))},this)))):null,r?a.createElement("div",{className:"error-message"},r):null,i?a.createElement("div",{className:"success-message"},i):null,!l&&n?a.createElement("div",{className:"loading-message"},"Loading dataset..."):null,!l||r?null:a.createElement("div",{className:"row"},a.createElement("div",{className:"preview"},a.createElement("h2",null,"Preview"),n?a.createElement("div",{className:"loading-message"},"Loading dataset..."):null,a.createElement(p.default,{className:"source",values:t.values,schema:t.dataset._schema,limit:20}),a.createElement("button",{className:"button button-success",onClick:this.done.bind(this,!0)},"Import")))))}}t.PipelineModal=_,t.default=r.connect(function(e){return{pipelines:e.getIn(["vis","present","pipelines"]).valueSeq().toArray(),datasets:e.getIn(["vis","present","datasets"])}},v)(_)},1294:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13);t.default=class extends a.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(e){this.props.loadURL(e.target.url.value),e.preventDefault()}render(){return a.createElement("form",{onSubmit:this.handleSubmit},a.createElement("input",{type:"text",name:"url",placeholder:"Enter url"}),a.createElement("button",{type:"submit",value:"Submit",className:"button"},"Load"))}}},1296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(73),r=n(1297),i=n(1298),l=n(1299),o=n(1300),c=n(1301),d=n(1302),p=n(74);t.Toolbar=class extends a.PureComponent{render(){return a.createElement("div",{className:"toolbar"},a.createElement("div",{className:"toolbar-menu"},a.createElement("input",{type:"checkbox",id:"nav-trigger",className:"nav-trigger"}),a.createElement("label",{htmlFor:"nav-trigger"},a.createElement(s.Icon,{glyph:p.hamburger})),a.createElement("div",{className:"menu"},a.createElement(r.AddMarks,null),a.createElement(i.AddInteractions,null),a.createElement(c.UndoRedo,null),a.createElement(o.Persist,null),a.createElement(l.Export,null),a.createElement("br",null),a.createElement("br",null),a.createElement(d.Feedback,null))))}}},1297:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(67),i=n(421),l=n(73),o=n(270),c=n(74),d=["rect","symbol","text","line","area"];t.AddMarks=s.connect(null,function(e,t){return{addMark:t=>{const n=o.getClosestGroupId();if(1===n)return;const a=i.Mark(t,{_parent:n});e(r.addMark(a))}}})(class extends a.Component{render(){return a.createElement("ul",{className:"add-marks"},d.map(function(e,t){return a.createElement("li",{key:e,onClick:this.props.addMark.bind(null,e)},a.createElement(l.Icon,{glyph:c[e]})," ",e)},this))}})},1298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(143),i=n(73),l=n(224),o=n(270),c=n(142),d=n(74),p=n(72);t.AddInteractions=s.connect(function(e){const t=o.getClosestGroupId(),n=c.getScaleInfoForGroup(e,t),a=e.getIn(["vega","isParsing"]);return{groupId:t,canDemonstrate:Boolean(!a&&p.view&&(n.xScaleName&&n.xFieldName||n.yScaleName&&n.yFieldName))}},function(e){return{addInteraction:t=>{const n=l.Interaction({groupId:t});e(r.addInteraction(n))}}})(class extends a.Component{render(){return this.props.canDemonstrate&&1!==this.props.groupId?a.createElement("ul",{className:"add-interactions"},a.createElement("li",{onClick:()=>this.props.addInteraction(this.props.groupId)},a.createElement(i.Icon,{glyph:d.select})," Interaction")):null}})},1299:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(23),r=n(592),i=n(606),l=n(73),o=n(74),c={png:"canvas",svg:"svg"};t.Export=class extends a.Component{toImageURL(e){const t=r.exporter(),n=new s.View(s.parse(t),{renderer:c[e]});n.runAsync().then(()=>n.toImageURL(e).then(t=>i.download(t,e)))}toJSONURL(){const e=JSON.stringify(r.exporter(),null,2);return i.toBlob(e,"json")}toHTMLURL(){const e=JSON.stringify(r.exporter(),null,2),t=o.scaffold.replace("INJECT_SPEC",e);return i.toBlob(t,"html")}render(){return a.createElement("ul",null,a.createElement("li",null,a.createElement(l.Icon,{glyph:o.export})," Export",a.createElement("ul",null,a.createElement("li",{onClick:this.toImageURL.bind(null,"png")},"As PNG"),a.createElement("li",{onClick:this.toImageURL.bind(null,"svg")},"As SVG"),a.createElement("li",{onClick:this.toJSONURL},"As JSON"),a.createElement("li",{onClick:this.toHTMLURL},"As HTML"))))}}},1300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(423),i=n(606),l=n(73),o=n(74);t.Persist=s.connect(null,{hydrate:r.hydrate})(class extends a.Component{constructor(e){super(e),this.open=this.open.bind(this)}open(){return i.fopen("json",this.props.hydrate)}save(){const e=r.persist();return i.toBlob(JSON.stringify(e),"json")}render(){return a.createElement("ul",{className:"persist"},a.createElement("li",{onClick:this.open},a.createElement(l.Icon,{glyph:o.open,className:"open",width:"15"})),a.createElement("li",{onClick:this.save},a.createElement(l.Icon,{glyph:o.save,className:"save"})))}})},1301:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(74),s=n(13),r=n(33),i=n(307),l=n(73);class o extends s.PureComponent{render(){const e=this.props;return s.createElement("ul",{className:"undo-redo"},s.createElement("li",{onClick:e.canUndo?e.undo:null,className:e.canUndo?"":"grey"},s.createElement(l.Icon,{glyph:a.undo,className:"undo",width:"12",height:"12"})),s.createElement("li",{onClick:e.canRedo?e.redo:null,className:e.canRedo?"":"grey"},s.createElement(l.Icon,{glyph:a.redo,className:"redo",width:"12",height:"12"})))}}t.BaseUndoRedo=o,t.UndoRedo=r.connect(function(e){const t=e.vis;return{canUndo:t.past.length>0,canRedo:t.future.length>0}},i.ActionCreators)(o)},1302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(73),r=n(74);t.Feedback=class extends a.Component{render(){return a.createElement("ul",{className:"feedback"},a.createElement("a",{href:"https://github.com/vega/lyra/issues/new",target:"_blank"},a.createElement("li",null,a.createElement(s.Icon,{glyph:r.exclamation,width:"18"})," Feedback")))}}},1303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),s=n(33),r=n(226),i=n(142),l=n(270),o=n(599),c=n(72);const d={addWidget:r.addWidget};t.default=s.connect(function(e){const t=l.getClosestGroupId(),n=i.getScaleInfoForGroup(e,t),a=e.getIn(["vega","isParsing"]),s=Boolean(!a&&c.view&&(n.xScaleName&&n.xFieldName||n.yScaleName&&n.yFieldName)),r=e.getIn(["inspector","dragging"]);return{dragging:r&&r.dsId?r:null,groupId:t,canDemonstrate:s}},d)(class extends a.Component{constructor(){super(...arguments),this.handleDragOver=(e=>(e.preventDefault&&e.preventDefault(),!1)),this.handleDrop=(()=>{this.props.addWidget(o.Widget({groupId:this.props.groupId,field:this.props.dragging.fieldDef,dsId:this.props.dragging.dsId}))})}render(){return this.props.dragging&&this.props.canDemonstrate?a.createElement("div",{className:"interaction-widget",onDragOver:e=>this.handleDragOver(e),onDrop:()=>this.handleDrop()},a.createElement("div",null,a.createElement("i",null,"Drop field to add query widget"))):null}})},1346:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const a=n(307),s=n(23),r=n(67),i=n(223),l=n(203),o=n(421),c=n(862);n(1542),n(1176),n(857),n(1177);const d=e.store=l.store,p=e.ctrl=n(72),u=n(1178);d.subscribe(u.createStoreListener(d,p)),d.dispatch(i.createScene(c.Scene())),d.dispatch(r.addMark(o.Mark("group",{_parent:1}))),n(1179),d.dispatch(a.ActionCreators.clearHistory()),e.vega=s}).call(this,n(122))},141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(167);t.addDataset=function(e,n){return function(a,r){const i=e._id||s.assignId(a,r());e.transform.filter(e=>"identifier"===e.type).length>0||e.transform.push({type:"identifier",as:"_vgsid_"}),a(t.baseAddDataset(e.merge({_id:i}),n))}},t.baseAddDataset=a.createStandardAction("ADD_DATASET")(),t.deleteDataset=a.createStandardAction("DELETE_DATASET")(),t.changeFieldMType=a.createStandardAction("CHANGE_FIELD_MTYPE")(),t.sortDataset=a.createStandardAction("SORT_DATASET")(),t.summarizeAggregate=a.createStandardAction("SUMMARIZE_AGGREGATE")(),t.addTransform=a.createStandardAction("ADD_DATA_TRANSFORM")(),t.updateTransform=a.createStandardAction("UPDATE_DATA_TRANSFORM")()},142:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(313),s=n(584),r=n(225);function i(e,t,n){const s=a.default(e);return s.marks=s.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&(e.signals=d(e.signals,n)),e)),s}function l(e,t,n,s){return(e=a.default(e)).marks=e.marks.map(e=>e.name&&e.name===t&&"group"===e.type?g(e,e=>{if(e.name===n){for(let[t,n]of Object.entries(s))"encode"!==t&&(e[t]=n);if(s.encode&&s.encode.update)for(let[t,n]of Object.entries(s.encode.update)){const a=e.encode.update[t];a&&(Array.isArray(a)&&a.length?(a[0].test&&!n[0].test.includes(a[0].test)&&(n[0].test=n[0].test+" && "+a[0].test),n[0]=Object.assign(Object.assign({},a[0]),n[0])):n[0]=Object.assign(Object.assign({},n[0]),a)),e.encode.update[t]=n}}return e}):e),e}function o(e,t){return(e=a.default(e)).marks=e.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&(e.marks=e.marks.filter(e=>!(e.name&&e.name.startsWith("lyra_brush")))),e)),e}function c(e){const{xScaleName:t,yScaleName:n,xFieldName:a,yFieldName:s}=e;return{ifXElse:(e,n)=>t&&a?e:n,ifYElse:(e,t)=>n&&s?e:t,ifXY:e=>t&&a&&n&&s?e:""}}function d(e,t){return e.filter(e=>t.every(t=>t.name!==e.name)).concat(t)}t.addDatasetsToScene=function(e,t,n){const s=a.default(e),r=s.data||(s.data=[]);return s.data=[...r,{name:`brush_store_${t}_${n}`},{name:`grid_store_${t}_${n}`},{name:`points_store_${t}_${n}`}],s},t.addInputsToScene=function(e,t,n,s,r,l,o){const{xScaleName:d,yScaleName:p,xFieldName:u,yFieldName:m}=r,{ifXElse:g,ifYElse:h,ifXY:f}=c(r);return e=i(e,t,[{name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]},{name:`key_modifier_${n}`,value:!s||!s.keycode,on:[{events:[{source:"window",type:"keydown"}],update:s&&s.keycode?`event.keyCode === ${s.keycode}`:o?"false":"true"},{events:[{source:"window",type:"keyup"}],update:s&&s.keycode?"false":"true"}]},{name:`mouse_x_${n}`,on:[{events:"mousemove",update:`key_modifier_${n} ? x(unit) : mouse_x_${n}`}]},{name:`mouse_y_${n}`,on:[{events:"mousemove",update:`key_modifier_${n} ? y(unit) : mouse_y_${n}`}]}]),d&&u&&(e=i(e,t,[{name:`mouse_${u}_${n}`,on:[{events:"mousemove",update:`key_modifier_${n} ? invert("${d}", mouse_x_${n}) : mouse_${u}_${n}`}]}])),p&&m&&(e=i(e,t,[{name:`mouse_${m}_${n}`,on:[{events:"mousemove",update:`key_modifier_${n} ? invert("${p}", mouse_x_${n}) : mouse_${m}_${n}`}]}])),e=i(e,t,[{name:`points_${n}`,update:`vlSelectionResolve("points_store_${t}_${n}")`},{name:`lyra_is_point_projecting_${n}`,init:"false"},{name:`lyra_points_tuple_${n}`,update:`lyra_is_point_projecting_${n} ? points_tuple_projected_${n} : points_tuple_${n}`},{name:`points_tuple_${n}`,on:[{events:[Object.assign({source:"scope",type:s&&"drag"!==s.mouse?s.mouse:"click"},s&&s.mouse&&"mouseover"===s.mouse&&s.nearest?{markname:`voronoi_${n}`}:{})],update:`datum && !datum.manipulator && item().mark.marktype !== 'group' ? (key_modifier_${n} ? {unit: "layer_0", fields: points_tuple_fields_${n}, values: [(item().isVoronoi ? datum.datum : datum)['_vgsid_']], datum: (item().isVoronoi ? datum.datum : datum)} : points_tuple_${n} ) : null`,force:!0},{events:[{source:"scope",type:"dblclick"}],update:"null"}]},{name:`points_tuple_projected_${n}`,on:[{events:[Object.assign({source:"scope",type:s&&"drag"!==s.mouse?s.mouse:"click"},s&&s.mouse&&"mouseover"===s.mouse&&s.nearest?{markname:`voronoi_${n}`}:{})],update:`datum && !datum.manipulator && item().mark.marktype !== 'group' ? (key_modifier_${n} ? {unit: "layer_0", fields: points_tuple_fields_${n}, values: [(item().isVoronoi ? datum.datum : datum)['_vgsid_']], datum: (item().isVoronoi ? datum.datum : datum)} : points_tuple_projected_${n} ) : null`,force:!0},{events:[{source:"scope",type:"dblclick"}],update:"null"}]},{name:`points_tuple_fields_${n}`,value:[{type:"E",field:"_vgsid_"}]},{name:`points_modify_${n}`,update:`modify("points_store_${t}_${n}", lyra_points_tuple_${n}, true, null)`}]),e=i(e,t,l.map(e=>({name:`point_${e}_${n}`,on:[{events:{signal:`lyra_points_tuple_${n}`},update:`lyra_points_tuple_${n} && lyra_points_tuple_${n}.datum ? lyra_points_tuple_${n}.datum["${e}"] : null`}]}))),e=i(e=function(e,t,n,s){const{ifXElse:r,ifYElse:i,ifXY:l}=c(s);return(e=a.default(e)).marks=e.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&(e.marks=[...e.marks,{name:`lyra_brush_brush_bg_${n}`,type:"rect",clip:!0,encode:{enter:{fill:{value:"#333"},fillOpacity:{value:.125}},update:{x:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},r({signal:`lyra_brush_x_${n}[0]`},{value:"0"})),{value:0}],y:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},i({signal:`lyra_brush_y_${n}[0]`},{value:"0"})),{value:0}],x2:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},r({signal:`lyra_brush_x_${n}[1]`},{signal:"width"})),{value:0}],y2:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},i({signal:`lyra_brush_y_${n}[1]`},{signal:"height"})),{value:0}]}}},{name:`lyra_brush_brush_${n}`,type:"rect",clip:!0,encode:{enter:{fill:{value:"transparent"}},update:{x:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},r({signal:`lyra_brush_x_${n}[0]`},{value:"0"})),{value:0}],y:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},i({signal:`lyra_brush_y_${n}[0]`},{value:"0"})),{value:0}],x2:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},r({signal:`lyra_brush_x_${n}[1]`},{signal:"width"})),{value:0}],y2:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},i({signal:`lyra_brush_y_${n}[1]`},{signal:"height"})),{value:0}],stroke:[{test:r(`lyra_brush_x_${n}[0] !== lyra_brush_x_${n}[1]`,"")+l(" && ")+i(`lyra_brush_y_${n}[0] !== lyra_brush_y_${n}[1]`,""),value:"white"},{value:null}]}}}]),e)),e}(e,t,n,r),t,[{name:`brush_x_start_${n}`,on:[{events:{signal:`lyra_brush_x_${n}`},update:`lyra_brush_x_${n}[0]`}]},{name:`brush_x_end_${n}`,on:[{events:{signal:`lyra_brush_x_${n}`},update:`lyra_brush_x_${n}[1]`}]},{name:`brush_y_start_${n}`,on:[{events:{signal:`lyra_brush_y_${n}`},update:`lyra_brush_y_${n}[0]`}]},{name:`brush_y_end_${n}`,on:[{events:{signal:`lyra_brush_y_${n}`},update:`lyra_brush_y_${n}[1]`}]},{name:g(`brush_${u}_${d}_start_${n}`,`brush_x_field_undefined_start_${n}`),on:[{events:{signal:g(`brush_${u}_${d}_${n}`,`brush_x_field_undefined_${n}`)},update:g(`brush_${u}_${d}_${n} && brush_${u}_${d}_${n}.length ? brush_${u}_${d}_${n}[0] : null`,"null")}]},{name:g(`brush_${u}_${d}_end_${n}`,`brush_x_field_undefined_end_${n}`),on:[{events:{signal:g(`brush_${u}_${d}_${n}`,`brush_x_field_undefined_${n}`)},update:g(`brush_${u}_${d}_${n} && brush_${u}_${d}_${n}.length ? brush_${u}_${d}_${n}[1] : null`,"null")}]},{name:h(`brush_${m}_${p}_start_${n}`,`brush_y_field_undefined_start_${n}`),on:[{events:{signal:h(`brush_${m}_${p}_${n}`,`brush_y_field_undefined_${n}`)},update:h(`brush_${m}_${p}_${n} && brush_${m}_${p}_${n}.length ? brush_${m}_${p}_${n}[0] : null`,"null")}]},{name:h(`brush_${m}_${p}_end_${n}`,`brush_y_field_undefined_end_${n}`),on:[{events:{signal:h(`brush_${m}_${p}_${n}`,`brush_y_field_undefined_${n}`)},update:h(`brush_${m}_${p}_${n} && brush_${m}_${p}_${n}.length ? brush_${m}_${p}_${n}[1] : null`,"null")}]},{name:`lyra_brush_is_x_encoding_${n}`,init:"false"},{name:`lyra_brush_is_y_encoding_${n}`,init:"false"},{name:`lyra_brush_x_${n}`,update:`lyra_brush_is_y_encoding_${n} ? [width, 0] : brush_x_${n}`},{name:`lyra_brush_y_${n}`,update:`lyra_brush_is_x_encoding_${n} ? [0, height] : brush_y_${n}`},{name:`brush_${n}`,update:`vlSelectionResolve("brush_store_${t}_${n}")`},{name:`grid_${n}`,update:`vlSelectionResolve("grid_store_${t}_${n}")`},{name:`brush_x_${n}`,value:[],on:[{events:{source:"scope",type:"mousedown",filter:[`!event.item || event.item.mark.name !== "lyra_brush_brush_${n}"`]},update:`key_modifier_${n} ? [x(unit), x(unit)] : brush_x_${n}`},{events:{source:"window",type:"mousemove",consume:!0,between:[{source:"scope",type:"mousedown",filter:[`!event.item || event.item.mark.name !== "lyra_brush_brush_${n}"`]},{source:"window",type:"mouseup"}]},update:`key_modifier_${n} ? [brush_x_${n}[0], clamp(x(unit), 0, width)] : brush_x_${n}`},{events:{signal:`brush_scale_trigger_${n}`},update:g(`isArray(brush_${u}_${d}_${n}) && length(brush_${u}_${d}_${n}) == 2 ? [scale("${d}", brush_${u}_${d}_${n}[0]), scale("${d}", brush_${u}_${d}_${n}[1])] : [0, 0]`,"[width, 0]")},{events:{signal:`brush_translate_delta_${n}`},update:`clampRange(panLinear(brush_translate_anchor_${n}.extent_x, brush_translate_delta_${n}.x / span(brush_translate_anchor_${n}.extent_x)), 0, width)`},{events:{signal:`brush_zoom_delta_${n}`},update:`clampRange(zoomLinear(brush_x_${n}, brush_zoom_anchor_${n}.x, brush_zoom_delta_${n}), 0, width)`},{events:[{source:"scope",type:"dblclick"}],update:"[0, 0]"}]},{name:g(`brush_${u}_${d}_${n}`,`brush_x_field_undefined_${n}`),on:g([{events:{signal:`lyra_brush_x_${n}`},update:g(`lyra_brush_x_${n}[0] === lyra_brush_x_${n}[1] ? null : invert("${d}", lyra_brush_x_${n})`,"")}],[])},{name:`brush_y_${n}`,value:[],on:[{events:{source:"scope",type:"mousedown",filter:[`!event.item || event.item.mark.name !== "lyra_brush_brush_${n}"`]},update:`key_modifier_${n} ? [y(unit), y(unit)] : brush_y_${n}`},{events:{source:"window",type:"mousemove",consume:!0,between:[{source:"scope",type:"mousedown",filter:[`!event.item || event.item.mark.name !== "lyra_brush_brush_${n}"`]},{source:"window",type:"mouseup"}]},update:`key_modifier_${n} ? [brush_y_${n}[0], clamp(y(unit), 0, height)] : brush_y_${n}`},{events:{signal:`brush_scale_trigger_${n}`},update:h(`isArray(brush_${m}_${p}_${n}) && length(brush_${m}_${p}_${n}) == 2 ? [scale("${p}", brush_${m}_${p}_${n}[0]), scale("${p}", brush_${m}_${p}_${n}[1])] : [0, 0]`,"[0, height]")},{events:{signal:`brush_translate_delta_${n}`},update:`clampRange(panLinear(brush_translate_anchor_${n}.extent_y, brush_translate_delta_${n}.y / span(brush_translate_anchor_${n}.extent_y)), 0, height)`},{events:{signal:`brush_zoom_delta_${n}`},update:`clampRange(zoomLinear(brush_y_${n}, brush_zoom_anchor_${n}.y, brush_zoom_delta_${n}), 0, height)`},{events:[{source:"scope",type:"dblclick"}],update:"[0, 0]"}]},{name:h(`brush_${m}_${p}_${n}`,`brush_y_field_undefined_${n}`),on:h([{events:{signal:`lyra_brush_y_${n}`},update:h(`lyra_brush_y_${n}[0] === lyra_brush_y_${n}[1] ? null : invert("${p}", lyra_brush_y_${n})`,"")}],[])},{name:`brush_scale_trigger_${n}`,value:{},on:[{events:[].concat(g([{scale:"x"}],[])).concat(h([{scale:"y"}],[])),update:g(`(!isArray(brush_${u}_${d}_${n}) || (+invert("${d}", lyra_brush_x_${n})[0] === +brush_${u}_${d}_${n}[0] && +invert("${d}", lyra_brush_x_${n})[1] === +brush_${u}_${d}_${n}[1]))`,"")+f(" && ")+h(`(!isArray(brush_${m}_${p}_${n}) || (+invert("${p}", lyra_brush_y_${n})[0] === +brush_${m}_${p}_${n}[0] && +invert("${p}", lyra_brush_y_${n})[1] === +brush_${m}_${p}_${n}[1]))`,"")+` ? brush_scale_trigger_${n} : {}`}]},{name:`brush_tuple_${n}`,on:[{events:[{signal:g(`brush_${u}_${d}_${n}`,"")+f(" || ")+h(`brush_${m}_${p}_${n}`,"")}],update:g(`brush_${u}_${d}_${n}`,"")+f(" && ")+h(`brush_${m}_${p}_${n}`,"")+` ? {unit: "", fields: brush_tuple_fields_${n}, values: [`+g(`brush_${u}_${d}_${n}`,"")+f(",")+h(`brush_${m}_${p}_${n}`,"")+"]} : null"}]},{name:`brush_tuple_fields_${n}`,value:[].concat(g([{field:u,channel:"x",type:"R"}],[])).concat(h([{field:m,channel:"y",type:"R"}],[]))},{name:`brush_translate_anchor_${n}`,value:{},on:[{events:[{source:"scope",type:"mousedown",markname:`lyra_brush_brush_${n}`}],update:`key_modifier_${n} ? {x: x(unit), y: y(unit), extent_x: slice(lyra_brush_x_${n}), extent_y: slice(lyra_brush_y_${n})} : brush_translate_anchor_${n}`}]},{name:`brush_translate_delta_${n}`,value:{},on:[{events:[{source:"window",type:"mousemove",consume:!0,between:[{source:"scope",type:"mousedown",markname:`lyra_brush_brush_${n}`},{source:"window",type:"mouseup"}]}],update:`key_modifier_${n} ? {x: brush_translate_anchor_${n}.x - x(unit), y: brush_translate_anchor_${n}.y - y(unit)} : brush_translate_delta_${n}`}]},{name:`brush_zoom_anchor_${n}`,on:[{events:[{source:"scope",type:"wheel",consume:!0,markname:`lyra_brush_brush_${n}`}],update:`key_modifier_${n} ? {x: x(unit), y: y(unit)} : brush_zoom_anchor_${n}`}]},{name:`brush_zoom_delta_${n}`,on:[{events:[{source:"scope",type:"wheel",consume:!0,markname:`lyra_brush_brush_${n}`}],force:!0,update:`key_modifier_${n} ? pow(1.001, event.deltaY * pow(16, event.deltaMode)) : brush_zoom_delta_${n}`}]},{name:`brush_modify_${n}`,update:`modify("brush_store_${t}_${n}", brush_tuple_${n}, true)`},{name:g(`lyra_grid_${u}_${d}_${n}`,`lyra_grid_x_field_undefined_${n}`),update:g(`lyra_brush_is_y_encoding_${n} ? grid_translate_anchor_${n}.extent_x : grid_${u}_${d}_${n}`,`grid_x_field_undefined_${n}`)},{name:h(`lyra_grid_${m}_${p}_${n}`,`lyra_grid_y_field_undefined_${n}`),update:h(`lyra_brush_is_x_encoding_${n} ? grid_translate_anchor_${n}.extent_y : grid_${m}_${p}_${n}`,`grid_y_field_undefined_${n}`)},{name:g(`grid_${u}_${d}_${n}`,`grid_x_field_undefined_${n}`),on:g([{events:{signal:`grid_translate_delta_${n}`},update:`panLinear(grid_translate_anchor_${n}.extent_x, -grid_translate_delta_${n}.x / width)`},{events:{signal:`grid_zoom_delta_${n}`},update:`zoomLinear(domain("${d}"), grid_zoom_anchor_${n}.x, grid_zoom_delta_${n})`},{events:[{source:"scope",type:"dblclick"}],update:"null"}],[])},{name:h(`grid_${m}_${p}_${n}`,`grid_y_field_undefined_${n}`),on:h([{events:{signal:`grid_translate_delta_${n}`},update:`panLinear(grid_translate_anchor_${n}.extent_y, grid_translate_delta_${n}.y / height)`},{events:{signal:`grid_zoom_delta_${n}`},update:`zoomLinear(domain("${p}"), grid_zoom_anchor_${n}.y, grid_zoom_delta_${n})`},{events:[{source:"scope",type:"dblclick"}],update:"null"}],[])},{name:`grid_tuple_${n}`,on:[{events:[{signal:g(`lyra_grid_${u}_${d}_${n}`,"")+f(" || ")+h(`lyra_grid_${m}_${p}_${n}`,"")}],update:g(`lyra_grid_${u}_${d}_${n}`,"")+f(" && ")+h(`lyra_grid_${m}_${p}_${n}`,"")+`? {unit: "", fields: brush_tuple_fields_${n}, values: [`+g(`lyra_grid_${u}_${d}_${n}`,"")+f(",")+h(`lyra_grid_${m}_${p}_${n}`,"")+"]} : null"}]},{name:`grid_translate_anchor_${n}`,value:{},on:[{events:[{source:"scope",type:"mousedown"}],update:`key_modifier_${n} ? {x: x(unit), y: y(unit)`+g(`, extent_x: domain("${d}")`,"")+h(`, extent_y: domain("${p}")`,"")+`} : grid_translate_anchor_${n}`}]},{name:`grid_translate_delta_${n}`,value:{},on:[{events:[{source:"window",type:"mousemove",consume:!0,between:[{source:"scope",type:"mousedown"},{source:"window",type:"mouseup"}]}],update:`key_modifier_${n} ? {x: grid_translate_anchor_${n}.x - x(unit), y: grid_translate_anchor_${n}.y - y(unit)} : grid_translate_delta_${n}`}]},{name:`grid_zoom_anchor_${n}`,on:[{events:[{source:"scope",type:"wheel",consume:!0}],update:`key_modifier_${n} ? {`+g(`x: invert("${d}", x(unit))`,"")+f(", ")+h(`y: invert("${p}", y(unit))`,"")+`} : grid_zoom_anchor_${n}`}]},{name:`grid_zoom_delta_${n}`,on:[{events:[{source:"scope",type:"wheel",consume:!0}],force:!0,update:`key_modifier_${n} ? pow(1.001, event.deltaY * pow(16, event.deltaMode)) : grid_zoom_delta_${n}`}]},{name:`grid_modify_${n}`,update:`modify("grid_store_${t}_${n}", grid_tuple_${n}, true)`}])},t.addSelectionToScene=function(e,t,n,a,s){switch(s.type){case"point":const r=(s=s).field;switch(e=i(e=o(e,t),t,[{name:`lyra_is_point_projecting_${n}`,init:r&&"_vgsid_"!==r?"true":"false"},{name:`points_tuple_projected_${n}`,on:[{events:[Object.assign({source:"scope",type:a&&"drag"!==a.mouse?a.mouse:"click"},a&&a.mouse&&"mouseover"===a.mouse&&a.nearest?{markname:`voronoi_${n}`}:{})],update:`datum && !datum.manipulator && item().mark.marktype !== 'group' ? (key_modifier_${n} ? {unit: "layer_0", fields: points_tuple_fields_${n}, values: [(item().isVoronoi ? datum.datum : datum)['${r||"_vgsid_"}']], datum: (item().isVoronoi ? datum.datum : datum)} : points_tuple_projected_${n} ) : null`,force:!0},{events:[{source:"scope",type:"dblclick"}],update:"null"}]},{name:`points_tuple_fields_${n}`,value:[Object.assign({type:"E",field:r||"_vgsid_"},s.encoding?{channel:s.encoding}:{})]}]),s.ptype){case"single":break;case"multi":e=i(e,t,[{name:`points_toggle_${n}`,value:!1,on:[{events:[Object.assign({source:"scope",type:a&&"drag"!==a.mouse?a.mouse:"click"},a&&a.mouse&&"mouseover"===a.mouse&&a.nearest?{markname:`voronoi_${n}`}:{})],update:"event.shiftKey"},{events:[{source:"scope",type:"dblclick"}],update:"false"}]}])}return e;case"interval":switch((s=s).encoding){case"x":return i(e,t,[{name:`lyra_brush_is_x_encoding_${n}`,init:"true"},{name:`lyra_brush_is_y_encoding_${n}`,init:"false"}]);case"y":return i(e,t,[{name:`lyra_brush_is_y_encoding_${n}`,init:"true"},{name:`lyra_brush_is_x_encoding_${n}`,init:"false"}]);default:return e}}},t.addApplicationToScene=function(e,t,n,s,r){const i="drag"===s.mouse;let c,d;switch(r.type){case"mark":c=(r=r).targetGroupName,d=r.targetMarkName;const s=r.unselectedValue;return e=l(e,c,d,{encode:{update:{[r.propertyName]:[{test:i?`!(length(data("brush_store_${t}_${n}"))) || (vlSelectionTest("brush_store_${t}_${n}", datum))`:`!(length(data("points_store_${t}_${n}"))) || (vlSelectionTest("points_store_${t}_${n}", datum))`},{value:s}]}}});case"scale":c=t;const p=(r=r).scaleInfo;return function(e,t,n){return(e=a.default(e)).marks=e.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&e.scales.forEach(e=>{n.forEach(t=>{if(e.name===t.name)for(let[n,a]of Object.entries(t))"_axis"!==n&&(e[n]=a)})}),e)),e}(e=function(e,t){return(e=a.default(e)).marks=e.marks.map(e=>e.name&&e.name===t&&"group"===e.type?g(e,e=>(e.clip=!0,e)):e),e}(e=o(e,t),t),c,[{_axis:"x",name:p.xScaleName,domainRaw:{signal:`grid_${n}["${p.xFieldName}"]`},zero:!1},{_axis:"y",name:p.yScaleName,domainRaw:{signal:`grid_${n}["${p.yFieldName}"]`},zero:!1}]);case"transform":const u=(r=r).datasetName,m=u+"_filter_"+(c=r.targetGroupName);e=l(e,c,d=r.targetMarkName,{from:{data:m}});const{source:h,transform:f}=function e(t,n,a){const s=t.data.filter(e=>e.name===n)[0],r=a.concat(s.transform),i=r.map(e=>JSON.stringify(e)),l=r.filter((e,t)=>i.indexOf(JSON.stringify(e))===t);return s.source?e(t,s.source,l):{source:n,transform:l}}(e,u,[]);return e=function(e,t){const n=((e=a.default(e)).data||(e.data=[])).filter(e=>e.name!==t.name);return e.data=[...n,t],e}(e,{name:m,source:h,transform:[{type:"filter",expr:i?`!(length(data("brush_store_${t}_${n}"))) || (vlSelectionTest("brush_store_${t}_${n}", datum))`:`!(length(data("points_store_${t}_${n}"))) || (vlSelectionTest("points_store_${t}_${n}", datum))`},...f]})}},t.pushSignalsInScene=function(e,t,n){return e=a.default(e),n.forEach(n=>{n.push&&(e.signals=e.signals||[],e.signals=d(e.signals,[{name:n.signal}]),e.marks=e.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&(e.signals=e.signals.map(e=>e.name===n.signal?Object.assign(Object.assign({},e),{push:"outer"}):e)),e)))}),e},t.addWidgetSelectionToScene=function(e,t,n){switch((e=a.default(e)).signals=e.signals||[],n.type){case"select":return e.signals=d(e.signals,[{name:`widget_${t.id}`,bind:Object.assign({name:t.field.name,input:"select"},u(t.field,t.dsId))}]),e;case"radio":return e.signals=d(e.signals,[{name:`widget_${t.id}`,bind:Object.assign({name:t.field.name,input:"radio"},u(t.field,t.dsId))}]),e;case"range":const s=u(t.field,t.dsId);return e.signals=d(e.signals,[{name:`widget_${t.id}`,bind:{name:t.field.name,input:"range",min:s.min,max:s.max,step:n.step||s.step}}]),e;default:return e}},t.addWidgetApplicationToScene=function(e,t,n,a){if(!n.selection)return e;const s=a.targetMarkName,r=a.unselectedValue;return l(e,t,s,{encode:{update:{[a.propertyName]:[{test:`datum.${n.field.name} ${n.selection.comparator} widget_${n.id}`},{value:r}]}}})},t.addVoronoiMark=function(e,t,n,s,r,i){return(e=a.default(e)).marks=e.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&e.marks.find(e=>e.name===s)&&(e.marks=e.marks.filter(e=>e.name!==`voronoi_${r}`),e.marks=[...e.marks,{name:`voronoi_${r}`,type:"path",interactive:!0,from:{data:s},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}}},transform:[{type:"voronoi",x:{expr:"y"===n?"0":"datum.datum.x || 0"},y:{expr:"x"===n?"0":"datum.datum.y || 0"},size:[{signal:"width"},{signal:"height"}]}]}]),e)),e},t.getFieldsOfGroup=function(e,t){const n=e.getIn(["vis","present","marks",String(t)]);let a=[];const s=m(e,n).find(e=>e.from&&e.from.data);if(s){const t=String(s.from.data);a=e.getIn(["vis","present","datasets",String(t)]).get("_schema").keySeq().toArray()}return a},t.getScaleInfoForGroup=function(e,t){const{scaleRecordX:n,scaleRecordY:a}=function(e,t){const n={scaleRecordX:null,scaleRecordY:null},a=e.getIn(["vis","present","marks",String(t)]).get("marks").map(t=>e.getIn(["vis","present","marks",String(t)]));if(!a.length)return n;const s=a[0];if(s.encode&&s.encode.update){if(s.encode.update.x){const{scale:t}=s.encode.update.x;n.scaleRecordX=e.getIn(["vis","present","scales",String(t)])}if(s.encode.update.y){const{scale:t}=s.encode.update.y;n.scaleRecordY=e.getIn(["vis","present","scales",String(t)])}}return n}(e,t);return{xScaleName:n?n.get("name"):null,xFieldName:n&&n.get("_domain").length>0?n.get("_domain")[0].field:null,yScaleName:a?a.get("name"):null,yFieldName:a&&a.get("_domain").length>0?a.get("_domain")[0].field:null}},t.cleanSpecForPreview=function(e,t,n,s,r){const i=a.default(e);return i.autosize="none",i.marks=i.marks.map(e=>{var a,r,i,l,o,c;if(e.name&&"group"===e.type){const d=(null===(i=null===(r=null===(a=e.encode)||void 0===a?void 0:a.update)||void 0===r?void 0:r.width)||void 0===i?void 0:i.value)||640,p=(null===(c=null===(o=null===(l=e.encode)||void 0===l?void 0:l.update)||void 0===o?void 0:o.height)||void 0===c?void 0:c.value)||360,u=t/d,m=n/p;e.axes=e.axes.map(e=>Object.assign(Object.assign({},e),{title:"",labels:!1,ticks:!1,domain:!1})),e.legends=[],e.encode.update.x={value:0},e.encode.update.y={value:0},e.encode.update.width={signal:"width"},e.encode.update.height={signal:"height"},(e=g(e,e=>{var t,n,a,s,r,i,l,o,c,d,p,g,h,f,y,v,_,b,S,x,E,w;return"symbol"===e.type&&(null===(n=null===(t=e.encode)||void 0===t?void 0:t.update)||void 0===n?void 0:n.size)&&(Array.isArray(e.encode.update.size)&&2==(null===(s=null===(a=e.encode)||void 0===a?void 0:a.update)||void 0===s?void 0:s.size.length)?e.encode.update.size=e.encode.update.size.map(e=>e.value?Object.assign(Object.assign({},e),{value:e.value*(u+m)/2}):e):e.encode.update.size.value&&(e.encode.update.size.value*=(u+m)/2)),"text"===e.type&&((null===(l=null===(i=null===(r=e.encode)||void 0===r?void 0:r.update)||void 0===i?void 0:i.fontSize)||void 0===l?void 0:l.value)&&(e.encode.update.fontSize.value/=2),(null===(d=null===(c=null===(o=e.encode)||void 0===o?void 0:o.update)||void 0===c?void 0:c.dx)||void 0===d?void 0:d.value)&&(e.encode.update.dx.value*=u),(null===(h=null===(g=null===(p=e.encode)||void 0===p?void 0:p.update)||void 0===g?void 0:g.dy)||void 0===h?void 0:h.value)&&(e.encode.update.dy.value*=m),(null===(v=null===(y=null===(f=e.encode)||void 0===f?void 0:f.update)||void 0===y?void 0:y.x)||void 0===v?void 0:v.value)&&(e.encode.update.x.value*=u),(null===(S=null===(b=null===(_=e.encode)||void 0===_?void 0:_.update)||void 0===b?void 0:b.y)||void 0===S?void 0:S.value)&&(e.encode.update.y.value*=m)),"line"===e.type&&(null===(w=null===(E=null===(x=e.encode)||void 0===x?void 0:x.update)||void 0===E?void 0:E.strokeWidth)||void 0===w?void 0:w.value)&&(e.encode.update.strokeWidth.value/=2),e})).name!==s&&(e.encode.update.x={value:-999},e.encode.update.y={value:-999}),e.scales=e.scales.map(t=>{if(t.range){const n=t.range;Array.isArray(n)&&2==n.length&&!n.some(isNaN)&&(t.range=n.map(e=>e/10)),n.step&&n.step.signal&&(e.signals=e.signals.map(e=>(e.name===n.step.signal&&(e.value/=2),e)))}return t})}return e}),function(e,t,n){const s=a.default(e),r=p.map(e=>"width"===e.name||"height"===e.name?e:Object.assign(Object.assign({},e),{name:`${e.name}_${n}`}));return s.marks=s.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&(e.signals=d(e.signals,r)),e)),s}(i,s,r)},t.editSignals=d;const p=[{name:"width",init:"75"},{name:"height",init:"75"},{name:"mouse_x",init:"null"},{name:"mouse_y",init:"null"},{name:"brush_x",init:"[0, 0]"},{name:"brush_y",init:"[0, 0]"},{name:"brush_zoom_anchor",init:"null"},{name:"brush_zoom_delta",init:"null"},{name:"grid_zoom_anchor",init:"null"},{name:"grid_zoom_delta",init:"null"},{name:"points_tuple",init:"null"},{name:"grid_translate_anchor",init:{}},{name:"grid_translate_delta",init:{}}];function u(e,t){const n=e.mtype;let a=r.output(t).map(t=>t[e.name]);if(n===s.NOMINAL||n===s.ORDINAL)return(a=[...new Set(a)]).length>50&&(a=a.slice(0,50)),{options:a};if(n===s.QUANTITATIVE||n===s.TEMPORAL){const e=(a=a.sort((e,t)=>e-t)).length,t=a.every(e=>Number.isInteger(e));return{max:a[e-1],min:a[0],step:t?1:.1}}}function m(e,t){return t?t.marks.map(n=>{const a=e.getIn(["vis","present","marks",String(n)]);return"group"===a.type?m(e,t):a}).filter(e=>!e.name.startsWith("lyra")):[]}function g(e,t){return(e=a.default(e)).marks=e.marks.map(e=>e.name&&e.name.startsWith("lyra")?e:"group"===e.type?g(e,t):t(e)),e}t.widgetParams=u,t.getNestedMarksOfGroup=m,t.mapNestedMarksOfGroup=g},143:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(316),r=n(167),i=n(880),l=n(267);t.addInteraction=function(e){return function(n,a){const o=e.id||r.assignId(n,a());(e=e.set("id",o)).get("name")||(e=e.set("name",i.recordName(a(),"interactions","Interaction"))),l.batchGroupBy.start(),n(t.baseAddInteraction(e,o)),n(s.addInteractionToGroup(o,e.groupId)),l.batchGroupBy.end()}},t.baseAddInteraction=a.createStandardAction("ADD_INTERACTION")(),t.setInput=a.createStandardAction("SET_INPUT")(),t.setSelection=a.createStandardAction("SET_SELECTION")(),t.setSignals=a.createStandardAction("SET_INTERACTION_SIGNALS")(),t.setSignalPush=a.createStandardAction("SET_INTERACTION_SIGNAL_PUSH")(),t.toggleEnableApplicationType=a.createStandardAction("TOGGLE_ENABLE_APPLICATION_TYPE")(),t.setApplication=a.createStandardAction("SET_APPLICATION")(),t.removeApplication=a.createStandardAction("REMOVE_APPLICATION")(),t.deleteInteraction=a.createStandardAction("DELETE_INTERACTION")(),t.updateInteractionName=a.createStandardAction("UPDATE_INTERACTION_NAME")()},1542:function(e,t){},167:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(855);t.assignId=function(e,t){const n=t.getIn(["lyra","idCounter"]);return e(a.incrementCounter()),n}},168:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),s=n(222);t.propSg=function(e,t,n){return s(t+"_"+e+"_"+n)},t.convertValuesToSignals=function(e,n,s,r){return e?Object.keys(e).reduce(function(e,i){return void 0===e[i]||void 0===e[i].value?e:(e[i]=a.extend({},{signal:t.propSg(s,n,r?r+"_"+i:i)},e[i]._disabled?{_disabled:!0}:{}),e)},e):e}},201:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(167);t.addGuide=function(e){return function(n,a){const r=e._id||s.assignId(n,a());n(t.baseAddGuide(e.merge({_id:r}),r))}},t.baseAddGuide=a.createStandardAction("ADD_GUIDE")(),t.deleteGuide=a.createStandardAction("DELETE_GUIDE")(),t.updateGuideProperty=a.createStandardAction("UPDATE_GUIDE_PROPERTY")()},202:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.replace(/\s/g,"_")}},203:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(615),r=n(1098),i=n(1099),l=n(879),o=n(272),c=n(88),d=n(600),p=n(881),u=n(598),m=a.Record({vis:{past:[],present:a.Map({pipelines:a.Map(),datasets:a.Map(),scene:a.Map(),scales:a.Map(),guides:a.Map(),marks:a.Map(),interactions:a.Map(),widgets:a.Map(),signals:c.defaultSignalState}),future:[]},vega:d.VegaReparse(),lyra:u.LyraGlobals(),inspector:o.Inspector(),walkthrough:p.Walkthrough(),hints:l.Hints()},"LyraState");var g;t.defaultState=m(),t.store=(g=t.defaultState,s.createStore(i.default,g,s.applyMiddleware(r.default)))},222:function(e,t,n){"use strict";n(857);e.exports=function(e){return e.startsWith("lyra_")?e:"lyra_"+e}},223:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(267),r=n(67),i=n(167),l=n(47).getInVis;t.createScene=function(e){return function(n,a){const s=e._id||i.assignId(n,a());n(t.baseCreateScene({props:e.merge({_id:s}),name:"Scene"},s))}},t.baseCreateScene=a.createStandardAction("CREATE_SCENE")(),t.clearScene=function(){return function(e,t){const n=t(),a=l(n,"scene._id"),i=l(n,"marks."+a+".marks");s.batchGroupBy.start(),i.forEach(function(t){e(r.deleteMark(t))}),s.batchGroupBy.end()}}},224:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.PointSelection=a.Record({type:"point",ptype:null,id:null,label:null,field:null,encoding:null},"LyraPointSelection"),t.IntervalSelection=a.Record({type:"interval",id:null,label:null,encoding:null},"LyraIntervalSelection"),t.MarkApplication=a.Record({type:"mark",id:null,label:null,targetGroupName:null,targetMarkName:null,propertyName:null,unselectedValue:null},"LyraMarkApplication"),t.ScaleApplication=a.Record({type:"scale",id:null,label:null,targetGroupName:null,scaleInfo:null},"LyraScaleApplication"),t.TransformApplication=a.Record({type:"transform",id:null,label:null,targetGroupName:null,targetMarkName:null,datasetName:null},"LyraTransformApplication"),t.Interaction=a.Record({id:null,name:null,groupId:null,input:null,selection:null,applications:[],_applicationTypeIsEnabled:a.Map(),signals:[]},"LyraInteraction"),t.applicationIsEnabled=function(e,t){return Boolean(t._applicationTypeIsEnabled.get(e.label))},t.getInteractionSignals=function(e,t,n,a){if(!t)return[];const{xScaleName:s,yScaleName:r,xFieldName:i,yFieldName:l}=n,o=[];switch(t.mouse){case"drag":s&&(o.push({signal:`brush_x_start_${e}`,label:"brush_x (start)"}),o.push({signal:`brush_x_end_${e}`,label:"brush_x (end)"}),i&&(o.push({signal:`brush_${i}_${s}_start_${e}`,label:`brush_${i} (start)`}),o.push({signal:`brush_${i}_${s}_end_${e}`,label:`brush_${i} (end)`}))),r&&(o.push({signal:`brush_y_start_${e}`,label:"brush_y (start)"}),o.push({signal:`brush_y_end_${e}`,label:"brush_y (end)"}),l&&(o.push({signal:`brush_${l}_${r}_start_${e}`,label:`brush_${l} (start)`}),o.push({signal:`brush_${l}_${r}_end_${e}`,label:`brush_${l} (end)`})));break;case"click":a.forEach(t=>{o.push({signal:`point_${t}_${e}`,label:`point_${t}`})});break;case"mouseover":o.push({signal:`mouse_x_${e}`,label:"mouse_x"}),o.push({signal:`mouse_y_${e}`,label:"mouse_y"}),i&&o.push({signal:`mouse_${i}_${e}`,label:`mouse_${i}`}),l&&o.push({signal:`mouse_${l}_${e}`,label:`mouse_${l}`}),a.forEach(t=>{o.push({signal:`point_${t}_${e}`,label:`point_${t}`})})}return o}},225:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(23),r=n(203),i=n(374),l=n(584),o={boolean:l.NOMINAL,number:l.QUANTITATIVE,integer:l.QUANTITATIVE,date:l.TEMPORAL,string:l.NOMINAL},c=n(425),d=(n(1126),n(47).getInVis);let p={};function u(e,t){const n=e._id;if(p[n])return p[n];t?p[n]=t:void 0!==e.source?p[n]=p[e.source]:p[n]=null}function m(){p={}}function g(e){return arguments.length?p=e:p}function h(e){return p[e]||[]}function f(e){const t=n(72),a=function(e){return d(r.store.getState(),"datasets."+e)}(e);return a&&t.view&&t.view.data(a.name)||h(e)||[]}function y(e){const t={parse:"auto",type:null};let n;try{return t.type="json",{format:t,values:c.read(e,t)}}catch(a){if(t.type="csv",n=c.read(e,t),Object.keys(n[0]).length>1)return{format:t,values:n};if(t.type="tsv",n=c.read(e,t),Object.keys(n[0]).length>1)return{format:t,values:n};throw Error("Raw data is in an unsupported format. Only JSON, CSV, or TSV may be imported.")}}function v(e){if(c.isNumber(e))throw Error("Dataset schemas are now available in the store.");if(c.isArray(e)){const t=c.type.inferAll(e);return c.keys(t).reduce(function(e,n){return e.set(n,i.Column({name:n,type:t[n],mtype:o[t[n]],source:!0}))},a.Map())}throw Error("Expected an array of raw values.")}function _(e,t){const n=t.groupby.reduce((t,n)=>t.set(n,e.get(n)),a.Map());return s.array(t.as).reduce((e,t)=>e.set(t,i.Column({name:t,type:"number",mtype:o.number,source:!1})),n)}t.init=u,t.reset=m,t.persist=g,t.input=h,t.output=f,t.parseRaw=y,t.schema=v,t.aggregateSchema=_,e.exports={init:u,reset:m,persist:g,input:h,output:f,parseRaw:y,schema:v,aggregateSchema:_}},226:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(316),r=n(167),i=n(880),l=n(267);t.addWidget=function(e){return function(n,a){const o=e.id||r.assignId(n,a());(e=e.merge({id:o})).get("name")||(e=e.set("name",i.recordName(a(),"widgets","Widget"))),l.batchGroupBy.start(),n(t.baseAddWidget(e,o)),n(s.addWidgetToGroup(o,e.groupId)),l.batchGroupBy.end()}},t.baseAddWidget=a.createStandardAction("ADD_WIDGET")(),t.setSelection=a.createStandardAction("SET_WIDGET_SELECTION")(),t.setApplication=a.createStandardAction("SET_WIDGET_APPLICATION")(),t.removeApplication=a.createStandardAction("REMOVE_WIDGET_APPLICATION")(),t.setSignals=a.createStandardAction("SET_WIDGET_SIGNALS")(),t.deleteWidget=a.createStandardAction("DELETE_WIDGET")(),t.updateWidgetName=a.createStandardAction("UPDATE_WIDGET_NAME")()},267:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(307),s=n(46),r=n(141),i=n(201),l=n(268);t.batchGroupBy={_group:[],start(){return this._group.push(Date.now())},end(){return this._group.pop()},init(e){const t=a.groupByActionTypes(e);return e=>this._group.length?this._group.join("|"):t(e)}},t.default={limit:15,filter:a.excludeAction([s.getType(r.baseAddDataset)]),groupBy:t.batchGroupBy.init([s.getType(l.baseSetSignal),s.getType(i.updateGuideProperty)])}},268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(420),r=n(23);t.initSignal=a.createStandardAction("INIT_SIGNAL")(),t.baseSetSignal=a.createStandardAction("SET_SIGNAL")();const i=r.debounce(500,e=>{e(s.invalidateVega(!0))});t.setSignal=function(e,n){return function(a,s){n.startsWith("lyra_group")&&(n.endsWith("width")||n.endsWith("height")||n.endsWith("x")||n.endsWith("y"))&&(s().getIn(["vega","isParsing"])||i(a)),a(t.baseSetSignal(e,n))}},t.setSignalStreams=a.createStandardAction("SET_SIGNAL_STREAMS")(),t.unsetSignal=a.createStandardAction("UNSET_SIGNAL")()},269:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(268),s=n(203),r=n(88),i=n(222),l=n(47).getInVis;function o(){return l(s.store.getState(),"signals").toJS()}function c(e){return r.signalNames.includes(e)}t.api=o,o.init=function(e,t){s.store.dispatch(a.initSignal(t,e))},o.reference=function(e){return{signal:i(e)}},o.isDefault=c,o.get=function(e){let t,a=n(72).view,r=function(e){return l(s.store.getState(),"signals."+i(e))}(e);return a&&"function"==typeof a.signal&&(t=a.signal(i(e))),t||r.get("value")},o.set=function(e,t,r){void 0===r&&(r=!0);const l=n(72).view;c(e)||!1===r||s.store.dispatch(a.setSignal(t,e)),l&&"function"==typeof l.signal&&l.signal(i(e),t)},o.delete=function(e){s.store.dispatch(a.unsetSignal(null,e))},o.streams=function(e,t){s.store.dispatch(a.setSignalStreams(e,t))},t.default=o,window.sg=o},27:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),s=n(88),r=n(313),i=n(202),l=n(222);t.default=function(e,t){const n=`${i.default(e.name)}_manipulators`,a=`peek(data("${n}"))`,r=Object.keys(e.encode.update).filter(e=>"text"!==e).map(t=>e.encode.update[t]).filter(e=>e&&!!e.signal).map(e=>({signal:e.signal}));return[t,{type:"group",data:[{name:n,transform:[{type:l("manipulators_"+e.type),lyra_id:e._id,lyra_selected:{signal:s.SELECTED},lyra_mode:{signal:s.MODE},signals:r},{type:"window",ops:["min","max","min","max"],fields:["x","x","y","y"]}]},{name:"voronoi",source:n,transform:[{type:"voronoi",x:"x",y:"y",as:"lyra_cell_path",extent:[{signal:`data("${n}")[0] ? [${a}.min_x - 100, ${a}.min_y - 50] : [0, 0]`},{signal:`data("${n}")[0] ? [${a}.max_x + 100, ${a}.max_y + 50] : [0, 0]`}]}]},d("handle",n),d("connector",n),d("arrow",n),d("span",n),d("border",n)],marks:[m,g,h("arrow"),h("span"),u(t),p]}]},t.LARGE=40,t.SMALL=20,t.PADDING=7,t.ARROWHEAD=7,t.coords=function(e,t){const n={topLeft:{x:e.x1,y:e.y1,cursor:"nw-resize"},topCenter:{x:e.x1+e.width()/2,y:e.y1,cursor:"n-resize"},topRight:{x:e.x2,y:e.y1,cursor:"ne-resize"},midLeft:{x:e.x1,y:e.y1+e.height()/2,cursor:"w-resize"},midCenter:{x:e.x1+e.width()/2,y:e.y1+e.height()/2,cursor:"move"},midRight:{x:e.x2,y:e.y1+e.height()/2,cursor:"e-resize"},bottomLeft:{x:e.x1,y:e.y2,cursor:"sw-resize"},bottomCenter:{x:e.x1+e.width()/2,y:e.y2,cursor:"s-resize"},bottomRight:{x:e.x2,y:e.y2,cursor:"se-resize"}};if(t)for(const[s,r]of Object.entries(n))n[s]=a.extend({},{size:o(e),key:s,manipulator:t},r);return n};const o=e=>e.width()<t.SMALL||e.height()<t.SMALL?t.SMALL:t.LARGE,c=(e,t)=>[Object.assign({test:`${s.CELL}.key === datum.key`},e),t],d=(e,t)=>({name:e,source:t,transform:[{type:"filter",expr:`datum.manipulator === "${e}"`}]}),p={type:"path",from:{data:"voronoi"},role:s.CELL,encode:{update:{path:{field:"lyra_cell_path"},key:{field:"key"},tooltip:{field:"tooltip"},strokeWidth:{value:.35},stroke:{value:"transparent"},fill:[{test:'datum.manipulator === "handle"',value:null},{value:"transparent"}]},hover:{cursor:[{test:'datum.manipulator === "handle"',field:"cursor"},{value:null}]}}};function u(e){const t=r.default(e.encode.update),n=e.type,a="line"===n||"area"===n;for(const e of Object.keys(t))t[e]={field:e};return delete t.fill,t.stroke=c({value:"lightsalmon"},{value:"cyan"}),t.strokeWidth={value:"text"===n?1:3},a&&(delete t.x,delete t.y,t.path={field:"path"}),{type:a?"path":n,role:"border",from:{data:"border"},encode:{update:t}}}const m={type:"symbol",from:{data:"handle"},role:"handle",encode:{update:{x:{field:"x"},y:{field:"y"},shape:{value:"square"},size:{field:"size"},fill:{value:"white"},stroke:{value:"black"},strokeWidth:{value:.5}},hover:{cursor:{field:"cursor"}}}},g={type:"symbol",from:{data:"connector"},role:"connector",encode:{update:{x:{field:"x"},y:{field:"y"},shape:{value:"diamond"},size:{field:"size"},fill:{value:"white"},stroke:c({value:"lightsalmon"},{value:"cyan"}),strokeWidth:{value:.5}}}},h=e=>({type:"group",role:e,from:{facet:{data:e,name:"facet",groupby:"key"}},marks:[{type:"line",from:{data:"facet"},encode:{update:{x:{field:"x"},y:{field:"y"},fill:c({value:"lightsalmon"},{value:"cyan"}),stroke:c({value:"lightsalmon"},{value:"cyan"}),strokeWidth:{value:3}}}}]});t.BUBBLE_CURSOR={type:"line",from:{data:"bubble_cursor"},interactive:!1,encode:{update:{x:{field:"x"},y:{field:"y"},fill:{value:"lightsalmon"},fillOpacity:{value:.2}}}},t.BUBBLE_CURSOR_TIP=[{type:"text",interactive:!1,encode:{update:{x:{signal:`${s.MOUSE}.x`},y:{signal:`${s.MOUSE}.y`},dy:{value:35},text:{signal:`${s.CELL}.tooltip`},align:{value:"center"},baseline:{value:"bottom"},stroke:{value:"white"},strokeWidth:{value:4},fontSize:{value:12},fontFamily:{value:"Lato"},fontWeight:{value:"bold"}}}},{type:"text",interactive:!1,encode:{update:{x:{signal:`${s.MOUSE}.x`},y:{signal:`${s.MOUSE}.y`},dy:{value:35},text:{signal:`${s.CELL}.tooltip`},align:{value:"center"},baseline:{value:"bottom"},fill:{value:"lightsalmon"},fontSize:{value:12},fontFamily:{value:"Lato"},fontWeight:{value:"bold"}}}}]},270:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(203),s=n(30).Bounds,r=n(47).getInVis;function i(e,t){return t=t||a.store.getState(),r(t,"marks."+e._parent)||null}function l(e,t){if(!e)return[];let n=e.get("_parent")&&i(e,t);if(!n)return[];const a=[n];for(;n&&n._parent;)(n=i(n,t))&&a.push(n);return a}function o(e){return e.reduce(function(e,t){return"group"===t.get("type")&&e.push(t.get("_id")),e},[])}function c(e,t){return t=t||a.store.getState(),o(l(r(t,"marks."+e),t))}function d(e,t){t=t||a.store.getState();const n=e||t.getIn(["inspector","encodings","selectedId"]);let s=r(t,"marks."+n);if(!s){const e=t.getIn(["vis","present","interactions",String(n)]);if(e&&e.groupId)return e.groupId;const a=t.getIn(["vis","present","widgets",String(n)]);if(a&&a.groupId)return a.groupId;const s=t.getIn(["vis","present","marks"]).filter(e=>"group"===e.type);return 1===s.size?s.first()._id:r(t,"scene._id")}return"group"===s.get("type")||"scene"===s.get("type")?s.get("_id"):d(s.get("_parent"),t)}t.getParentGroupIds=c,t.getClosestGroupId=d,e.exports={getParent:i,getParentGroupIds:c,getParents:l,getGroupIds:o,getClosestGroupId:d,findInItemTree:function(e,t){const n=document.querySelector(".vis-container"),a={x:0,y:0};let r,i,l,o=+Number.MAX_VALUE,c=+Number.MAX_VALUE;for(let n=t.length-1;n>=0;--n){const s=t[n];a.x+=+e.x||0,a.y+=+e.y||0;for(let t=e.items,n=0,a=t.length;n<a&&null===(e=(l=t[n].role)&&+l.split("lyra_")[1]===s?t[n].items[0]:null);++n);if(null===e)break}const d=new s({x1:n.scrollLeft,x2:300+n.scrollLeft,y1:n.scrollTop,y2:200+n.scrollTop});if(e&&e.mark.items.length>1)for(let t=0,n=e.mark.items,a=n.length;t<a;++t){const a=(e=n[t]).bounds,s=a&&(a.x1<o||a.y1<c);if(!a)break;if(d.encloses(a)){i=r=null;break}d.intersects(a)&&s?(r=e,o=a.x1,c=a.y1):s&&(i=e,o=a.x1,c=a.y1)}return r||i||e}}},271:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(167);t.addScale=function(e){return function(n,a){const r=e._id||s.assignId(n,a());n(t.baseAddScale(e.merge({_id:r}),r))}},t.baseAddScale=a.createStandardAction("ADD_SCALE")(),t.updateScaleProperty=a.createStandardAction("UPDATE_SCALE_PROPERTY")(),t.amendDataRef=a.createStandardAction("AMEND_DATA_REF")(),t.deleteScale=a.createStandardAction("DELETE_SCALE")()},272:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.EncodingState=a.Record({selectedId:null,selectedType:null,expandedLayers:{}},"LyraEncodingState"),t.FieldDraggingState=a.Record({dsId:null,fieldDef:null},"LyraFieldDraggingState"),t.SignalDraggingState=a.Record({interactionId:null,signal:null},"LyraSignalDraggingState"),t.ScaleDraggingState=a.Record({scaleId:null,fieldName:null},"LyraScaleDraggingState"),t.Inspector=a.Record({pipelines:{selectedId:null},encodings:t.EncodingState(),dragging:null},"LyraInspector")},312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s={x:"bottom",y:"left"};var r;!function(e){e.Axis="axis",e.Legend="legend"}(r=t.GuideType||(t.GuideType={})),function(e){e.fill="fill",e.opacity="opacity",e.shape="shape",e.size="size",e.stroke="stroke",e.strokeDash="strokeDash"}(t.LegendForType||(t.LegendForType={})),t.Axis=a.Record({_gtype:r.Axis,_id:null,orient:null,scale:null,tickCount:12,tickSize:0,grid:!0,title:null,zindex:0,encode:{domain:{update:{stroke:{value:"#000000"},strokeWidth:{value:0}}},title:{update:{fontSize:{value:10},fill:{value:"#000000"},dx:{value:0},dy:{value:0}}},labels:{update:{fontSize:{value:10},angle:{value:0},fill:{value:"#000000"}}},grid:{update:{stroke:{value:"#000000"},strokeOpacity:{value:.5},strokeWidth:{value:.25}}},ticks:{update:{stroke:{value:"#000000"},strokeWidth:{value:0}}}}},"LyraAxis"),t.Legend=a.Record({_id:null,_type:null,_gtype:r.Legend,fill:null,opacity:null,shape:null,size:null,stroke:null,strokeWidth:null,strokeDash:null,symbolFillColor:"#ffffff",strokeColor:"#ffffff",titleFontSize:10,encode:{title:{update:{fontSize:{value:10},fill:{value:"#000000"}}},legend:{update:{stroke:{value:"#000000"},strokeWidth:{value:0}}},labels:{update:{fontSize:{value:10},fill:{value:"#000000"}}},gradient:{update:{stroke:{value:"#000000"},strokeWidth:{value:0}}},symbols:{update:{strokeWidth:{value:1},opacity:{value:1},size:{value:100}}}},title:null,orient:"right"},"LyraLegend"),t.Guide=function(e,n,a){const i=a._id?String(a._id):String(a);return e===r.Axis?t.Axis({orient:s[n],scale:i}):e===r.Legend?t.Legend({_type:n,[n]:i}):void 0},t.isAxis=function(e){return e&&e._gtype===r.Axis},t.isLegend=function(e){return e&&e._gtype===r.Legend}},313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return JSON.parse(JSON.stringify(e))}},314:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(594),s=n(307),r=n(46),i=n(91),l=n(67),o=n(203),c=n(88),d=n(270),p=n(269),u=(n(1142),n(72));e.exports={onSignal:h,offSignal:f,onSignalInGroup:v,offSignalInGroup:_,setSignalInGroup:b,getSignalInGroup:S,register:x};const m={},g={};function h(e,t){return m[e]=m[e]||[],m[e].push(t),u.view&&u.view.addSignalListener(e,t),u}function f(e,t){m[e]=m[e]||[];const n=m[e];for(let e=n.length;--e>=0;)t&&n[e]!==t||n.splice(e,1);return u.view&&u.view.removeSignalListener(e,t),u}function y(e,t,n){const a=e._scenegraph.root.items[0];for(const e of a.items)if(e.name&&"group"===e.marktype&&e.name===t&&e.items&&e.items.length){const t=e.items[0].context.signals;for(const e of Object.keys(t))if(e===n)return t[e]}return null}function v(e,t,n,a){const s=y(e,t,n);if(s){const r=function(){a(n,s.value)};r.handler=a,g[t]=g[t]||{},g[t][n]=g[t][n]||[],g[t][n].push({operator:s,handler:r}),e.on(s,null,r)}}function _(e,t,n,a){if(y(e,t,n)){g[t]=g[t]||{},g[t][n]=g[t][n]||[];const e=g[t][n];for(let t=e.length;--t>=0;)a&&e[t].handler!==a||(e[t].operator._targets.remove(a),e.splice(t,1))}}function b(e,t,n,a){const s=y(e,t,n);e.update(s,a),e.runAsync()}function S(e,t,n){const a=y(e,t,n);return a?a.value:null}function x(){const e=a.select(window);e.on("dragover.altchan")||e.on("dragover.altchan",function(){const e=p.default.get(c.MODE),t=a.event.shiftKey,n="channels"===e,s="altchannels"===e;(n||s)&&(n&&t?(p.default.set(c.MODE,"altchannels"),u.update()):s&&!t&&(p.default.set(c.MODE,"channels"),u.update()))}),u.view&&(u.view.addSignalListener(c.SELECTED,function(e,t){const n=t.mark.role,a=n&&+n.split("lyra_")[1],s=o.store.getState(),r=s.getIn(["inspector","encodings","selectedId"]),l=s.getIn(["inspector","encodings","selectedType"]);if(r===a||l===i.InspectorSelectedType.SELECT_INTERACTION)return;const c=d.getParentGroupIds(a,s);a&&(o.store.dispatch(i.baseSelectMark(a,c)),o.store.dispatch(i.expandLayers(c)))}),Object.keys(m).forEach(function(e){u.view._signals[e]?m[e].forEach(function(t){u.view.addSignalListener(e,t)}):m[e]=[]}),Object.keys(g).forEach(function(e){Object.keys(g[e]).forEach(function(t){y(u.view,e,t)?g[e][t].forEach(function(e){u.view.on(e.operator,null,e.handler)}):g[e][t]=[]})}))}function E(e){const t=e.srcElement||e.target,n=t.tagName.toUpperCase();return("INPUT"===n||"TEXTAREA"===n||"true"===t.contentEditable)&&(!t.readOnly&&!t.disabled)}a.select(window).on("keydown",function(){const e=a.event;window._inputKeyboard={keycode:e.keyCode,_key:e.key},function(e){const t=e.keyCode;if(!E(e)&&!0===e.metaKey||!0===e.ctrlKey){if(89===t)return o.store.dispatch(s.ActionCreators.redo()),e.preventDefault(),!1;if(90===t)o.store.dispatch(e.shiftKey?s.ActionCreators.redo():s.ActionCreators.undo()),e.preventDefault()}}(e),function(e){if(!E(e)&&8===e.keyCode){const t=o.store.getState(),n=t.getIn(["inspector","encodings"]),a=n.get("selectedType"),s=n.get("selectedId"),c=t.getIn(["vis","present","marks",String(s),"_parent"]);if(a===r.getType(i.baseSelectMark))e.preventDefault(),o.store.dispatch(i.selectMark(c)),o.store.dispatch(l.deleteMark(s))}}(e)}).on("keyup",function(){window._inputKeyboard=null}).on("beforeunload",function(){{const e="You have unsaved changed in Lyra.";return a.event.returnValue=e,e}}),t.onSignal=h,t.offSignal=f,t.onSignalInGroup=v,t.offSignalInGroup=_,t.setSignalInGroup=b,t.getSignalInGroup=S,t.registerSignalListeners=x},315:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(47).getInVis;const a=n(46),s=n(374),r=n(583),i=n(225),l=n(141),o=n(91),c=n(167);t.addPipeline=function(e,n,a){return function(s,r){const i=e._id||c.assignId(s,r()),d=c.assignId(s,r()),p=n.merge({_id:d,name:`${e.name}_source_${d}`,_parent:i});s(l.addDataset(p,a)),s(t.baseAddPipeline(e.merge({_id:i,_source:d}),i)),s(o.selectPipeline(i))}},t.derivePipeline=function(e){return function(n,a){const i=a(),d=i.getIn(["vis","present","pipelines",String(e)]),p=d._source,u=i.getIn(["vis","present","datasets",String(p),"_schema"]),m=c.assignId(n,a()),g=c.assignId(n,a()),h=s.Dataset({_id:m,name:d.get("name")+"_derived_"+m,source:String(p),transform:[],_schema:u,_parent:g}),f=r.Pipeline({_id:g,name:`${d.name}_derived`,_source:m});n(t.baseAddPipeline(f,g)),n(l.addDataset(h,null)),n(o.selectPipeline(g))}},t.aggregatePipeline=function(e,n){return function(a,r){const o=r(),d=o.getIn(["vis","present","pipelines",String(e)]),p=d._source,u=o.getIn(["vis","present","datasets",String(p),"_schema"]),m=i.aggregateSchema(u,n),g=n.groupby.join("|"),h=d._aggregates.get("");if(h){const r=s.Dataset({_id:h,name:d.get("name")+"_groupby_"+g,source:String(p),transform:[n],_schema:m,_parent:e});a(l.addDataset(r,null)),a(t.baseAggregatePipeline({dsId:void 0,key:""},e)),a(t.baseAggregatePipeline({dsId:n._id=h,key:g},e))}else{const i=c.assignId(a,r()),o=s.Dataset({_id:i,name:d.get("name")+"_groupby_"+g,source:String(p),transform:[n],_schema:m,_parent:e});a(l.addDataset(o,null)),a(t.baseAggregatePipeline({dsId:n._id=i,key:g},e))}}},t.baseAddPipeline=a.createStandardAction("ADD_PIPELINE")(),t.baseAggregatePipeline=a.createStandardAction("AGGREGATE_PIPELINE")(),t.updatePipelineProperty=a.createStandardAction("UPDATE_PIPELINE_PROPERTY")()},316:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46);t.addScaleToGroup=a.createStandardAction("ADD_SCALE_TO_GROUP")(),t.addAxisToGroup=a.createStandardAction("ADD_AXIS_TO_GROUP")(),t.addLegendToGroup=a.createStandardAction("ADD_LEGEND_TO_GROUP")(),t.addInteractionToGroup=a.createStandardAction("ADD_INTERACTION_TO_GROUP")(),t.addWidgetToGroup=a.createStandardAction("ADD_WIDGET_TO_GROUP")()},317:function(e,t,n){"use strict";var a=n(13),s=n(426),r=n(117),i=n(603)({displayName:"ContentEditable",propTypes:{value:r.oneOfType([r.string,r.number]),save:r.func},getInitialState:function(){return{edit:!1}},componentDidMount:function(){this._el=s.findDOMNode(this)},componentDidUpdate:function(){this.state.edit&&this._el.focus()},componentWillUnmount:function(){this._el=null},start:function(){this.setState({edit:!0})},stop:function(){this.setState({edit:!1}),this.props.save&&this.props.save(this._el.textContent.trim())},handleEnter:function(e){(!e.keyCode||e.keyCode&&13===e.keyCode)&&this._el.blur()},render:function(){var e=this.props;return a.createElement("div",{style:e.style,className:(e.className||"")+" content-editable",contentEditable:this.state.edit,onClick:e.onClick||this.start,onDoubleClick:e.onDoubleClick||this.start,onBlur:this.stop,onKeyDown:this.handleEnter},e.value)}});e.exports=i},371:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),s=n(88),r=n(202);t.default=function(e,t,n){const i=`${s.ANCHOR}.target`;let l=`(${s.ANCHOR} && ${i} && ${i}.datum && `;return`${l+=n?`${i}.datum.mode === ${a.stringValue(t)}  && `+`${i}.datum.lyra_id === ${e._id} && `+`test(regexp(${a.stringValue(n)}, "i"), ${i}.datum.key)`:`${i}.mark && ${i}.mark.name === ${a.stringValue(r.default(e.name))}`})`}},372:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(88);t.default=function(e,t,n,s){return`if( ${a.SELECTED}.mark.role == "lyra_${s}" && (${e}), ${t}, ${n} )`}},374:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.Column=a.Record({name:null,type:null,mtype:null,source:null},"ColumnDescription"),t.Dataset=a.Record({_id:null,_parent:null,_schema:null,name:null,source:null,transform:[]},"LyraDataset")},377:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(1144),s=n(267),r=n(313),i=n(67),l=n(1146),o=n(1147),c=n(1148),d=n(1149),p=n(1150),u=n(596),m=n(47).getInVis,g=n(225),h={rect:"bar",symbol:"circle",text:"text",line:"line",area:"area"};function f(e){switch(e){case"x":case"x+":case"x2":case"width":return"x";case"y":case"y+":case"y2":case"height":return"y";case"fill":case"stroke":return"color";case"size":case"text":case"detail":return e}}t.CELLW=517,t.CELLH=392,t.default=function(e,n,u,v){return function(_,b){const S=b(),x=m(S,"marks."+u),E=x.type,w=function(e){return e._vlUnit||{mark:h[e.type],data:{values:[]},encoding:{},config:{}}}(x),k=($=w)._lyraMap||($._lyraMap={data:{},scales:{},axes:{},legends:{},marks:{}}),I=f(v),T=m(S,"datasets."+e+"._parent");var $;const N=x.from;if(N&&N.data&&m(S,`datasets.${N.data}._parent`)!==T)throw Error("Mark and field must be from the same pipeline.");s.batchGroupBy.start(),w.encoding[I]=function(e){const t=e.name,n=e.aggregate,a=e.bin,s={type:e.mtype};let r;return n||(r=y.agg.exec(t))?s.aggregate=r?r[1]:n:(a||(r=y.bin.exec(t)))&&(s.bin=!0),s.field=r?r[2]:t,s}(n);const P=function(e,n,s){return(e=r.default(e)).data.values=g.output(s),e.config.view={width:t.CELLW,height:t.CELLH},e.config.mark={filled:"fill"===n},{input:e,output:a.compile(e).spec}}(w,v,e);P.map=k,P.mark=x,P.markId=u,P.markType=E,P.property=v,P.channel=I,P.dsId=e,P.plId=T,o.default(_,S,P),p.default(_,S,P),d.default(_,S,P),l.default(_,S),c.default(_,b(),P),_(i.setVlUnit(w,u)),s.batchGroupBy.end()}},t.channelName=f;const y={agg:new RegExp("^("+u.join("|")+")_(.*?)$"),bin:new RegExp("^(bin)_(.*?)(_start|_mid|_end)$")}},421:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(856),s=n(858),r=n(859),i=n(860),l=n(422),o=n(582),c={encode:{update:{x:{value:100},y:{value:100},fill:{value:"#4682b4"},fillOpacity:{value:1},stroke:{value:"#000000"},strokeWidth:{value:0}}}};function d(e,t){switch(e){case"symbol":return l.Symbol(t).mergeDeepWith(p,c);case"area":return a.Area(t).mergeDeepWith(p,c);case"line":return r.Line(t).mergeDeepWith(p,{encode:{update:Object.assign(Object.assign({},c.encode.update),{fill:void 0,fillOpacity:void 0})}});case"rect":return i.Rect(t).mergeDeepWith(p,c);case"text":return o.Text(t).mergeDeepWith(p,c);case"group":return s.Group(t).mergeDeepWith(p,c)}}t.Mark=d;const p=(e,t)=>void 0!==e?null===e?void 0:e:t;d.getHandleStreams=function(e){switch(e.type){case"symbol":return l.getHandleStreams(e);case"area":return a.getHandleStreams(e);case"line":return r.getHandleStreams(e);case"text":return o.getHandleStreams(e);case"group":case"rect":return i.getHandleStreams(e)}}},422:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(371),r=n(168),i=n(372),l=n(88);t.Symbol=a.Record({_id:null,_parent:null,_vlUnit:null,type:"symbol",name:null,from:null,encode:{update:{size:{value:200},shape:{value:"circle"}}}},"LyraSymbolMark"),t.SymbolShapes=["circle","square","cross","diamond","triangle-up","triangle-down"],t.getHandleStreams=function(e){const t=s.default.bind(null,e,"handles"),n=e._id,a=r.propSg(n,"symbol","x"),o=r.propSg(n,"symbol","y"),c=r.propSg(n,"symbol","size"),d=`${l.DELTA}.x`,p=`${l.DELTA}.y`;return{[a]:[{events:{signal:l.DELTA},update:i.default(t(),`${a} + ${d}`,a,n)}],[o]:[{events:{signal:l.DELTA},update:i.default(t(),`${o} + ${p}`,o,n)}],[c]:[{events:{signal:l.DELTA},update:i.default(t("top"),`${c} - (${p} << 5)`,c,n)},{events:{signal:l.DELTA},update:i.default(t("bottom"),`${c} + (${p} << 5)`,c,n)}]}}},423:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(1105),s=n(46),r=n(203),i=n(374),l=n(312),o=n(224),c=n(856),d=n(858),p=n(859),u=n(860),m=n(582),g=n(862),h=n(422),f=n(583),y=n(424),v=n(88),_=n(225),b=n(272),S=n(598),x=n(599),E=n(600),w=a.withRecords([h.Symbol,c.Area,p.Line,u.Rect,m.Text,d.Group,g.Scene,i.Column,i.Dataset,l.Axis,l.Legend,f.Pipeline,v.Signal,b.EncodingState,b.FieldDraggingState,b.SignalDraggingState,b.ScaleDraggingState,b.Inspector,o.Interaction,o.IntervalSelection,o.PointSelection,o.MarkApplication,o.ScaleApplication,o.TransformApplication,x.Widget,x.WidgetSelection,S.LyraGlobals,E.VegaReparse],(e,t)=>{switch(console.log(e),e){case"LyraScale":return console.log(t),y.Scale(t);default:return null}});t.persist=function(){const e=r.store.getState();return{store:{vis:w.toJSON(e.vis.present),inspector:w.toJSON(e.inspector),lyra:w.toJSON(e.lyra)},values:_.persist()}},t.hydrate=s.createStandardAction("HYDRATE").map(e=>{const t=JSON.parse(e);return _.persist(t.values),{payload:{vis:w.fromJSON(t.store.vis),inspector:w.fromJSON(t.store.inspector),lyra:w.fromJSON(t.store.lyra)}}}),t.hydrator=function(e,n){return(a,r)=>r.type===s.getType(t.hydrate)?r.payload[n]:e(a,r)}},424:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);var s;t.Scale=function(e){return a.Record(Object.assign({_id:null,_origName:null,_domain:[],_range:[],name:null,align:.5,padding:0,paddingOuter:0,paddingInner:0,domainMin:null,domainMax:null,reverse:!1,round:!1,clamp:!1,_manual:!1,_manualDomain:[]},e),"LyraScale")()},function(e){e.CONTINUOUS="CONTINUOUS",e.DISCRETE="DISCRETE"}(s=t.ScaleSimpleType||(t.ScaleSimpleType={})),t.scaleTypeSimple=function(e){switch(e){case"linear":case"log":case"pow":case"sqrt":case"symlog":case"time":case"utc":case"sequential":return s.CONTINUOUS;case"ordinal":case"band":case"point":case"quantile":case"quantize":case"threshold":case"bin-ordinal":return s.DISCRETE}}},47:function(e,t,n){"use strict";var a=n(43);function s(e){return""+e}function r(e){return e.split(".")}function i(e,t){if(e)return e.getIn(r(t))}function l(e,t,n){return e.setIn(r(t),n)}e.exports={get:function(e,t){if(e)return e.get(s(t))},set:function(e,t,n){return e.set(s(t),n)},getIn:i,getInVis:function(e,t){return i(e.get("vis").present,t)},setIn:l,deleteKeyFromMap:function(e,t){return e.delete(s(t))},ensureValuePresent:function(e,t,n){var s=i(e,t);return s&&a.List.isList(s)&&s.indexOf(n)<0?l(e,t,s.push(n)):e},ensureValueAbsent:function(e,t,n){var s=i(e,t);return s&&a.List.isList(s)&&s.indexOf(n)>=0?l(e,t,s.filter(function(e){return e!==n})):e},str:s}},48:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return function(a){return a.key=e,a.manipulator=t,a.tooltip=n||e,a}}},582:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(371),r=n(168),i=n(372),l=n(88);t.Text=a.Record({_id:null,_parent:null,_vlUnit:null,type:"text",name:null,from:null,encode:{update:{dx:{value:0,offset:0},dy:{value:0,offset:0},text:{signal:'"Text"'},align:{value:"center"},baseline:{value:"middle"},font:{value:"Helvetica"},fontSize:{value:12},fontStyle:{value:"normal"},fontWeight:{value:"normal"},angle:{value:0}}}},"LyraTextMark"),t.getHandleStreams=function(e){const t=s.default.bind(null,e,"handles"),n=e._id,a=r.propSg(n,"text","x"),o=r.propSg(n,"text","y"),c=r.propSg(n,"text","fontSize"),d=`${l.DELTA}.x`,p=`${l.DELTA}.y`;return{[a]:[{events:{signal:l.DELTA},update:i.default(t(),`${a} + ${d}`,a,n)}],[o]:[{events:{signal:l.DELTA},update:i.default(t(),`${o} + ${p}`,o,n)}],[c]:[{events:{signal:l.DELTA},update:i.default(`${t("left")} && ${t("top")}`,`${c} - ${d}`,c,n)},{events:{signal:l.DELTA},update:i.default(`${t("right")} && ${t("bottom")}`,`${c} + ${d}`,c,n)},{events:{signal:l.DELTA},update:i.default(`${t("left")} && ${t("top")}`,`${c} - ${p}`,c,n)},{events:{signal:l.DELTA},update:i.default(`${t("right")} && ${t("bottom")}`,`${c} + ${p}`,c,n)}]}},t.TextAlignments=["left","center","right"],t.TextBaselines=["top","middle","bottom"],t.TextFonts=["Helvetica","Verdana","Georgia","Palatino","Garamond","Trebuchet MS"],t.TextFontStyles=["normal","italic"],t.TextFontWeights=["normal","bold"]},583:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.Pipeline=a.Record({_id:null,name:null,_source:null,_aggregates:a.Map()},"LyraPipeline")},592:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),s=n(593),r=n(203),i=n(312),l=n(224),o=n(225),c=n(313),d=n(202),p=n(202),u=n(168),m=n(872),g=n(142),h=n(27),f=n(1130),y=n(47),v=y.getIn,_=y.getInVis,b=n(1140),S={data:{},scales:{},_totaled:!1},x={marks:{},scales:{}},E={marks:{},guides:{}};let w=c.default(S);function k(e=!1){const t=r.store.getState(),n=!0===e;w=c.default(S);let a=k.scene(t,n);return a.data=k.pipelines(t,n),a=k.interactions(t,a),a=k.widgets(t,a)}function I(e,t,n){return{name:"pathgroup",type:"group",from:{facet:Object.assign(Object.assign({},n),{data:d.default(_(e,"datasets."+n.data+".name"))})},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:a.array(t)}}function T(e,t){const n=e.encode.update,a=s.default[t];if(!n[a.SPAN.name]._disabled)return m.signalLookup(n[a.SPAN.name].signal)}function $(e,t){let n;for(const[s,r]of Object.entries(e))(n=(n=s.startsWith("_"))||null==r||r._disabled)?delete e[s]:"name"===s&&a.isString(r)?e[s]=d.default(r):a.isObject(r)&&(r.signal&&!t?r.signal.startsWith("lyra")&&(e[s]=m.signalLookup(r.signal)):e[s]=$(e[s],t));return e}function N(e){let t,n;if(e)k();else if(w._totaled)return w;for(t in w.data)(n=w.data[t]).total=Object.keys(n.marks).length+Object.keys(n.scales).length;for(t in w.scales)(n=w.scales[t]).markTotal=Object.keys(n.marks).length,n.guideTotal=Object.keys(n.guides).length,n.total=n.markTotal+n.guideTotal;return w._totaled=!0,w}function P(e,t,n){let a,s,r,i,l,o,c={};if(1===n.length)return n=n[0],O(a=_(e,"datasets."+n.data),t,n.field);for(i=0,l=n.length;i<l;++i)a=_(e,"datasets."+n[i].data),r=n[i].field,c[s=a.get("_id")]=c[s]||(c[s]=[]),c[s].push(r);if(1===(o=Object.keys(c)).length)return O(a,t,c[s]);for(n={fields:[]},i=0,l=o.length;i<l;++i)a=_(e,"datasets."+o[i]),n.fields.push(O(a,t,c[o[i]]));return n}function O(e,t,n){let s;if(s=Array.isArray(n)?{data:d.default(e.get("name")),fields:n}:{data:d.default(e.get("name")),field:n},"ordinal"===t.type&&e.get("_sort")){const t=v(e,"_sort.field");return a.extend({},s,{sort:t===s.field||{field:t,op:"min"},_sortOrder:v(e,"_sort.order")})}const r=e.get("_id");return(w.data[r]||(w.data[r]=c.default(x))).scales[t._id]=!0,s}t.exporter=k,k.interactions=function(e,t){return e.getIn(["vis","present","interactions"]).forEach(n=>{const a=e.getIn(["vis","present","marks",String(n.groupId)]),s=p.default(a.name),r=g.getScaleInfoForGroup(e,a._id),i=g.getFieldsOfGroup(e,a._id),o=a._interactions.map(t=>{const n=e.getIn(["vis","present","interactions",String(t)]);return n.input?n.input.mouse:null}).filter(e=>e),c=new Set(o).size!==o.length;if(t=g.addDatasetsToScene(t,s,n.id),t=g.addInputsToScene(t,s,n.id,n.input,r,i,c),n.selection&&(t=g.addSelectionToScene(t,s,n.id,n.input,n.selection)),n.applications.length)for(const e of n.applications)if(l.applicationIsEnabled(e,n)&&(t=g.addApplicationToScene(t,s,n.id,n.input,e),n.input&&n.input.mouse&&"mouseover"===n.input.mouse&&n.input.nearest)){const a=e.targetMarkName;if(a){const r=n.selection&&"point"===n.selection.type?n.selection.encoding:null;t=g.addVoronoiMark(t,s,r,a,n.id,e.id)}}t=g.pushSignalsInScene(t,s,n.signals)}),t},k.widgets=function(e,t){return e.getIn(["vis","present","widgets"]).forEach(n=>{const a=e.getIn(["vis","present","marks",String(n.groupId)]),s=p.default(a.name);if(n.selection&&(t=g.addWidgetSelectionToScene(t,n,n.selection)),n.applications.length)for(const e of n.applications)t=g.addWidgetApplicationToScene(t,s,n,e)}),t},k.pipelines=function(e,t){return _(e,"pipelines").valueSeq().reduce(function(n,a){n.push(k.dataset(e,t,a._source));const s=a._aggregates.toJS();for(const a in s)n.push(k.dataset(e,t,s[a]));return n},[])},k.dataset=function(e,t,n){const a=_(e,"datasets."+n).toJS(),s=$(c.default(a),t),r=o.input(n),i=s.format&&s.format.type,l=k.sort(a);w.data[n]=w.data[n]||c.default(x),s.source?s.source=d.default(_(e,"datasets."+s.source+".name")):t?(s.values=r,delete s.url,delete s.format):s.url||(s.values=i&&"json"!==i?f({data:r,del:"tsv"===i?"\t":","}):r);const p=e.getIn(["vis","present","interactions"]).valueSeq().toArray(),u=[].concat.apply([],p.filter(e=>e.signals.length).map(e=>e.signals.map(e=>e.signal))),m=e.getIn(["vis","present","widgets"]).valueSeq().toArray(),g=[].concat.apply([],m.filter(e=>e.signals.length).map(e=>e.signals.map(e=>e.signal))),h=u.concat(g);return s.transform=s.transform||[],void 0!==l&&s.transform.push(l),s.transform.forEach(t=>{"lookup"===t.type&&(t.from=e.getIn(["vis","present","datasets",t.from,"name"])),"filter"===t.type&&h.forEach(e=>{t.expr.indexOf(e)>=0&&(t.expr=`(${e} ? ${t.expr} : true)`)})}),s},k.sort=function(e){const t=e._sort;if(t)return{type:"sort",by:(t.order===b.DESC?"-":"")+t.field}},k.scene=function(e,t){const n=e.getIn(["vis","present","scene","_id"]);let a=k.group(e,t,n);return t&&(a=a[0]),delete a.from,delete a.encode,a},k.mark=function(e,t,n){const s=_(e,"marks."+n).toJS(),r=$(c.default(s),t),i=s.encode.update,l=r.encode.update,o=s._facet;if(o)r.from={data:o.name};else if(r.from){let t;if(t=r.from.data){r.from.data=d.default(_(e,"datasets."+t+".name")),(w.data[t]||(w.data[t]=c.default(x))).marks[n]=!0}else(t=r.from.mark)&&(r.from.mark=d.default(_(e,"marks."+t+".name")))}if(Object.keys(l).forEach(function(t){let s=l[t];const r=i[t],o=r.scale;if(a.isObject(s)||(s=l[t]={value:s}),o){s.scale=d.default(_(e,"scales."+o+".name")),(w.scales[o]||(w.scales[o]=c.default(E))).marks[n]=!0}r.group&&(s.field={group:r.group},delete s.group)}),t){r.role=`lyra_${s._id}`;const t=h.default(s,r);return o?I(e,t,o):t}return o?I(e,r,o):r},k.group=function(e,t,n){const s=_(e,`marks.${n}`),r=k.mark(e,t,n),i=t?r[0]:r;return["scale","mark","axe","legend"].forEach(function(n){const r=n+"s",l="axes"===r||"legends"===r?"guides":r;i[r]=s[r].map(a=>{const s=_(e,`${l}.${a}`);return s?k[s.type]?k[s.type](e,t,a):k[n]?k[n](e,t,a):$(c.default(s.toJS()),t):null}).reduce((e,t)=>(a.isArray(t)?e.push.apply(e,t):t&&e.push(t),e),[])}),"Scene"!==s.name&&(i.signals=i.signals||[],i.signals.push({name:"width",value:T(s,"x")},{name:"height",value:T(s,"y")})),r},k.area=function(e,t,n){const s=k.mark(e,t,n),r=a.array("pathgroup"===s.name?s.marks:s)[0],i=r.encode.update;return r.from||(r.from={data:"dummy_data"},i.x={signal:`datum.x + ${u.propSg(n,"area","x")}`},i.y={signal:`datum.y + ${u.propSg(n,"area","y")}`}),"horizontal"===i.orient.value?delete i.y2:delete i.x2,s},k.line=function(e,t,n){const s=k.mark(e,t,n),r=a.array("pathgroup"===s.name?s.marks:s)[0],i=r.encode.update;return r.from||(r.from={data:"dummy_data"},i.x={signal:`datum.x + ${u.propSg(n,"line","x")}`},i.y={signal:`datum.y + ${u.propSg(n,"line","y")}`}),s},k.scale=function(e,t,n){const s=_(e,"scales."+n).toJS(),r=$(c.default(s),t);w.scales[n]=w.scales[n]||c.default(E),!s.domain&&s._domain&&s._domain.length&&(r.domain=s._manual&&s._manualDomain.length?s._manualDomain:P(e,s,s._domain)),!s.range&&s._range&&s._range.length&&(r.range=P(e,s,s._range));const i=a.isObject(r.domain)&&r.domain._sortOrder;return i&&(r.reverse=i===b.DESC?!r.reverse:!!r.reserve),r},k.axe=k.legend=function(e,t,n){const s=_(e,"guides."+n).toJS(),r=$(c.default(s),t),l=s._gtype,o=s._type;return l===i.GuideType.Axis?(w.scales[r.scale].guides[n]=!0,r.scale=d.default(_(e,"scales."+r.scale+".name"))):l===i.GuideType.Legend&&(w.scales[r[o]].guides[n]=!0,r[o]=d.default(_(e,"scales."+r[o]+".name"))),Object.keys(r.encode).forEach(function(e){const t=r.encode[e];Object.keys(t).forEach(function(e){a.isObject(t[e])||(t[e]={value:t[e]})})}),r},t.getCounts=N,e.exports.exportName=d.default,e.exports.counts=N},593:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={x:{START:{name:"x",label:"Left"},CENTER:{name:"xc",label:"Center"},SPAN:{name:"width",label:"Width"},END:{name:"x2",label:"Right"}},y:{START:{name:"y",label:"Top"},CENTER:{name:"yc",label:"Middle"},SPAN:{name:"height",label:"Height"},END:{name:"y2",label:"Bottom"}}}},596:function(e,t,n){"use strict";e.exports=["count","mean","sum","min","max","variance","variancep","stdev","stdevp","median","q1","q3","modeskew"]},597:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46);t.hintsOn=a.createStandardAction("HINTS_ON")(),t.clearHints=a.createStandardAction("CLEAR_HINTS")()},598:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.LyraGlobals=a.Record({idCounter:1},"LyraGlobals")},599:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.WidgetSelection=a.Record({type:null,id:null,label:null,step:null,comparator:null},"LyraWidgetSelection"),t.Widget=a.Record({id:null,name:null,groupId:null,field:null,dsId:null,selection:null,applications:[],signals:[]},"LyraWidget")},600:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.VegaReparse=a.Record({invalid:!1,isParsing:!1},"LyraVegaReparse")},605:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13);t.MoreProperties=class extends a.Component{constructor(e){super(e),this.state={display:"none"},this.handleClick=this.handleClick.bind(this)}toggle(e){return"block"===e?"none":"block"}handleClick(e){this.setState({display:this.toggle(this.state.display)})}render(){const e=this.props,t=this.state.display,n={display:t},s={display:this.toggle(t)};let r,i;return e.header?r=a.createElement("div",null,a.createElement("h3",{className:"show-more-props more-props-label",onClick:e=>this.handleClick(e),style:s},"+ ",e.label),a.createElement("h3",{className:"hide-more-props more-props-label",onClick:e=>this.handleClick(e),style:n}," ",e.label)):(r=a.createElement("a",{className:"show-more-props more-props-label",href:"#",onClick:e=>this.handleClick(e),style:s},"+ More ",e.label," Properties"),i=a.createElement("a",{className:"hide-more-props more-props-label",href:"#",style:n,onClick:e=>this.handleClick(e)}," Fewer ",e.label," Properties")),a.createElement("div",null,r,a.createElement("div",{className:"more-props",style:n},e.children),i)}}},606:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),s=n(594),r=n(425),i={json:"application/json",html:"text/html"};function l(e,t){const n=s.select(document.createElement("a")).attr("href",e).attr("target","_blank").attr("download","lyra."+t).node(),a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,document.defaultView,1,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(a)}function o(t,n){for(const a of t){const t=new FileReader;t.onloadend=(t=>a=>{const s=a.target.result;n("string"==typeof s?s:e.from(s).toString("utf-8"),t)})(a),t.readAsText(a)}}t.toBlob=function(e,t){const n=new Blob([e],{type:i[t]});return l(window.URL.createObjectURL(n),t)},t.download=l,t.get=function(e,t){r.load({url:e},(e,n)=>t(n,e))},t.fopen=function(e,t){s.select(document.createElement("input")).attr("type","file").attr("accept",a.array(e).map(e=>`.${e}`).join(",")).on("change",()=>o(s.event.target.files,t)).node().click()},t.read=o}).call(this,n(415).Buffer)},665:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(23),s=n(87),r=n(48),i=n.n(r),l=n(27);const o=2*l.PADDING;function c(e){s.a.call(this,[],e)}c.Definition=Object(a.extend)({},s.a.Definition);const d=Object(a.inherits)(c,s.a);d.handles=function(e){const t=Object(l.coords)(e.bounds,"handle");return Object.values(t).filter(e=>"midCenter"!==e.key)},d.connectors=function(e){return Object.values(Object(l.coords)(e.bounds,"connector"))},d.channels=function(e){var t=e.bounds,n=e.mark.group.bounds,a=Object(l.coords)(t),s=a.topLeft,r=a.topRight,o=a.bottomRight,c=t.width(),d=t.height(),p=Math.max(Math.min(r.x+c,n.x2-l.PADDING),r.x+50),u=Math.max(Math.min(o.y+d,n.y2-l.PADDING),o.y+50);return[].concat([{x:s.x,y:s.y-l.PADDING},{x:r.x,y:r.y-l.PADDING},{x:p,y:r.y-l.PADDING},{x:p-l.ARROWHEAD,y:r.y-2*l.PADDING},{x:p-l.ARROWHEAD,y:r.y},{x:p,y:r.y-l.PADDING+.1}].map(i()("x+","arrow","x position"))).concat([{x:r.x+l.PADDING,y:r.y},{x:o.x+l.PADDING,y:o.y},{x:o.x+l.PADDING,y:u},{x:o.x+2*l.PADDING,y:u-l.ARROWHEAD},{x:o.x,y:u-l.ARROWHEAD},{x:o.x+l.PADDING,y:u+.1}].map(i()("y+","arrow","y position"))).concat([{x:e.x,y:e.y,x2:e.x2,y2:e.y2,width:e.width,height:e.height,shape:e.shape}].map(i()("fill","border")))},d.altchannels=function(e){var t=e.bounds,n=e.mark.group.bounds,a=Object(l.coords)(t),s=a.topLeft,r=a.topCenter,c=a.topRight,d=a.midLeft,p=a.midRight,u=a.bottomLeft,m=a.bottomCenter,g=a.bottomRight;return[].concat([{x:n.x1,y:s.y},{x:s.x-o,y:s.y}].map(i()("x","span","left (x)"))).concat([{x:n.x1,y:g.y+l.PADDING},{x:u.x,y:g.y+l.PADDING},{x:g.x,y:g.y+l.PADDING}].map(i()("x2","span","right (x2)"))).concat([{x:s.x,y:n.y1},{x:s.x,y:s.y-o}].map(i()("y","span","top (y)"))).concat([{x:g.x+l.PADDING,y:n.y1},{x:g.x+l.PADDING,y:c.y},{x:g.x+l.PADDING,y:g.y}].map(i()("y2","span","bottom (y2)"))).concat([{x:d.x,y:c.y-l.PADDING},{x:p.x,y:c.y-l.PADDING}].map(i()("width","span"))).concat([{x:u.x-l.PADDING,y:r.y},{x:u.x-l.PADDING,y:m.y}].map(i()("height","span"))).concat([{x:e.x,y:e.y,x2:e.x2,y2:e.y2,width:e.width,height:e.height,shape:e.shape}].map(i()("stroke","border")))}},67:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(267),r=n(421),i=n(167),l=n(373),o=n(47).getInVis;t.addMark=function(e){return function(n,a){const s=e._id||i.assignId(n,a());if(!(e=e.set("_id",s)).name){const t=function(e,t){t=t||"Mark";const n=e.getIn(["vis","present","marks"]).filter(e=>e.type===t).size;return l(t)+" "+(n+1)}(a(),e.type);e=e.set("name",t)}n(t.baseAddMark({name:e.name,streams:r.Mark.getHandleStreams(e),props:e},s))}},t.baseAddMark=a.createStandardAction("ADD_MARK")(),t.updateMarkProperty=a.createStandardAction("UPDATE_MARK_PROPERTY")(),t.setParent=a.createStandardAction("SET_PARENT_MARK")(),t.setMarkVisual=a.createStandardAction("SET_MARK_VISUAL")(),t.disableMarkVisual=a.createStandardAction("DISABLE_MARK_VISUAL")(),t.resetMarkVisual=a.createStandardAction("RESET_MARK_VISUAL")(),t.bindScale=a.createStandardAction("BIND_SCALE")(),t.bindField=a.createStandardAction("BIND_FIELD")(),t.setMarkExtent=a.createStandardAction("SET_MARK_EXTENT")(),t.setVlUnit=a.createStandardAction("SET_VL_UNIT")(),t.deleteMark=function e(n){return function(a,r){const i=o(r(),"marks."+n),l=i.get("marks");s.batchGroupBy.start(),l&&l.size&&l.forEach(function(t){a(e(t))}),a(t.baseDeleteMark(i.type,i._id)),s.batchGroupBy.end()}},t.baseDeleteMark=a.createStandardAction("DELETE_MARK")()},72:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),s=n(88),r=n(592),i=n(27),l=n(423),o=n(269),c=n(425),d=(n(27),n(222)),p=n(1141),u=e.exports={view:null},m=n(314);let g=null;u.export=r.exporter,u.persist=l.persist,u.hydrate=l.hydrate,u.manipulators=function(){const e=u.export(!0),t=e.data||(e.data=[]),n=e.signals||(e.signals=[]),a=e.marks||(e.marks=[]),r=c.comparator("_idx");return n.push.apply(n,Object.values(o.api()).sort(r)),t.push({name:"bubble_cursor",transform:[{type:d("bubble_cursor"),lyra_cell:{signal:s.CELL},lyra_mouse:{signal:s.MOUSE}}]}),a.push(i.BUBBLE_CURSOR),a.push.apply(a,i.BUBBLE_CURSOR_TIP),t.push({name:"dummy_data",values:[{x:0,y:0},{x:100,y:100}]}),e},u.parse=function(e){return e=e||"#vis",g&&g.cancel(),(g=new p(function(e,t){const n=this;setTimeout(function(){if(!n.cancelled)try{e(a.parse(u.manipulators()))}catch(e){console.error(e)}},10)})).then(function(t){u.view=new a.View(t,{renderer:"svg"}).initialize(e).logLevel(a.Warn).hover(),m.register(),u.update(),g=null})},u.update=function(){u.view&&u.view.runAsync&&"function"==typeof u.view.runAsync&&u.view.runAsync()}},73:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(13);t.Icon=class extends a.Component{render(){const e=this.props,t=(e.className?e.className+" ":"")+"icon";return a.createElement("svg",{className:t,onClick:e.onClick,width:e.width||13,height:e.height||13,"data-html":e["data-html"],"data-tip":e["data-tip"],"data-place":e["data-place"]},a.createElement("use",{xlinkHref:"#"+e.glyph.id}))}}},74:function(e,t,n){"use strict";e.exports={"group-expanded":n(1187),"group-contracted":n(1188),rect:n(1189),line:n(1190),area:n(1191),text:n(1192),symbol:n(1193),trash:n(1194),plus:n(1195),undo:n(1196),redo:n(1197),nominal:n(1198),ordinal:n(1199),quantitative:n(1200),temporal:n(1201),prev:n(1202),next:n(1203),close:n(1204),hamburger:n(1205),erase:n(1206),export:n(1207),scaffold:n(1208),select:n(1209),sort:n(1210),sortAlphaAsc:n(1211),sortAlphaDesc:n(1212),sortNumericAsc:n(1213),sortNumericDesc:n(1214),filter:n(1215),lookup:n(1216),formula:n(1217),aggregate:n(1218),download:n(1219),bold:n(1220),italic:n(1221),open:n(1222),save:n(1223),exclamation:n(1224),book:n(1225),"align-left":n(1226),"align-center":n(1227),"align-right":n(1228),"vertical-align-bottom":n(1229),"vertical-align-center":n(1230),"vertical-align-top":n(1231)}},855:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46);t.incrementCounter=a.createStandardAction("INCREMENT_COUNTER")()},856:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(371),r=n(168),i=n(372),l=n(88);t.Area=a.Record({_id:null,_parent:null,_vlUnit:null,type:"area",name:null,from:null,encode:{update:{x2:{value:250},y2:{value:250},xc:{value:70,_disabled:!0},yc:{value:70,_disabled:!0},width:{value:40,_disabled:!0},height:{value:40,_disabled:!0},tension:{value:13},interpolate:{value:"monotone"},orient:{value:"vertical"}}}},"LyraAreaMark"),t.getHandleStreams=function(e){const t=s.default.bind(null,e,"handles"),n=e._id,a=r.propSg(n,"area","x"),o=r.propSg(n,"area","xc"),c=r.propSg(n,"area","x2"),d=r.propSg(n,"area","y"),p=r.propSg(n,"area","yc"),u=r.propSg(n,"area","y2"),m=r.propSg(n,"area","width"),g=r.propSg(n,"area","height"),h=`${l.DELTA}.x`,f=`${l.DELTA}.y`;return{[a]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("left")}`,`${a} + ${h}`,a,n)}],[o]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("left")}`,`${o} + ${h}`,o,n)}],[c]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("right")}`,`${c} + ${h}`,c,n)}],[d]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("top")}`,`${d} + ${f}`,d,n)}],[p]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("top")}`,`${p} + ${f}`,p,n)}],[u]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("bottom")}`,`${u} + ${f}`,u,n)}],[m]:[{events:{signal:l.DELTA},update:i.default(t("left"),`${m} - ${h}`,m,n)},{events:{signal:l.DELTA},update:i.default(t("right"),`${m} + ${h}`,m,n)}],[g]:[{events:{signal:l.DELTA},update:i.default(t("top"),`${g} - ${f}`,g,n)},{events:{signal:l.DELTA},update:i.default(t("bottom"),`${g} + ${f}`,g,n)}]}}},858:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.Group=a.Record({_id:null,_parent:null,_vlUnit:null,_manualLayout:!1,_interactions:[],_widgets:[],type:"group",name:null,from:null,scales:[],axes:[],legends:[],marks:[],encode:{update:{fill:{value:"transparent"},stroke:null,x:{value:0},y:{value:0},x2:{value:140,_disabled:!0},y2:{value:140,_disabled:!0},xc:{value:70,_disabled:!0},yc:{value:70,_disabled:!0},width:{value:640},height:{value:360}}}},"LyraGroupMark")},859:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(371),r=n(168),i=n(372),l=n(88);t.Line=a.Record({_id:null,_parent:null,_vlUnit:null,_facet:null,type:"line",name:null,from:null,encode:{update:{strokeWidth:{value:3},tension:{value:13},interpolate:{value:"monotone"}}}},"LyraLineMark"),t.getHandleStreams=function(e){const t=s.default.bind(null,e,"handles"),n=e._id,a=r.propSg(n,"line","x"),o=r.propSg(n,"line","y"),c=`${l.DELTA}.x`,d=`${l.DELTA}.y`;return{[a]:[{events:{signal:l.DELTA},update:i.default(t(),`${a} + ${c}`,a,n)}],[o]:[{events:{signal:l.DELTA},update:i.default(t(),`${o} + ${d}`,o,n)}]}}},860:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(371),r=n(168),i=n(372),l=n(88);t.Rect=a.Record({_id:null,_parent:null,_vlUnit:null,type:"rect",name:null,from:null,encode:{update:{x2:{value:140},y2:{value:140},xc:{value:70,_disabled:!0},yc:{value:70,_disabled:!0},width:{value:40,_disabled:!0},height:{value:40,_disabled:!0}}}},"LyraRectMark"),t.getHandleStreams=function(e){const t=s.default.bind(null,e,"handles"),n=e._id,a=e.type,o=r.propSg(n,a,"x"),c=r.propSg(n,a,"xc"),d=r.propSg(n,a,"x2"),p=r.propSg(n,a,"y"),u=r.propSg(n,a,"yc"),m=r.propSg(n,a,"y2"),g=r.propSg(n,a,"width"),h=r.propSg(n,a,"height"),f=`${l.DELTA}.x`,y=`${l.DELTA}.y`;return{[o]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("left")}`,`${o} + ${f}`,o,n)}],[c]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("left")}`,`${c} + ${f}`,c,n)}],[d]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("right")}`,`${d} + ${f}`,d,n)}],[p]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("top")}`,`${p} + ${y}`,p,n)}],[u]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("top")}`,`${u} + ${y}`,u,n)}],[m]:[{events:{signal:l.DELTA},update:i.default(`${t()} || ${t("bottom")}`,`${m} + ${y}`,m,n)}],[g]:[{events:{signal:l.DELTA},update:i.default(t("left"),g+"-"+f,g,n)},{events:{signal:l.DELTA},update:i.default(t("right"),g+"+"+f,g,n)}],[h]:[{events:{signal:l.DELTA},update:i.default(t("top"),h+"-"+y,h,n)},{events:{signal:l.DELTA},update:i.default(t("bottom"),h+"+"+y,h,n)}]}}},862:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.Scene=a.Record({_id:null,type:"scene",name:"Scene",background:"white",autosize:"pad",padding:5,encode:{update:{}},scales:[],axes:[],legends:[],marks:[]},"LyraScene")},87:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(23);function s(e){a.Transform.call(this,[],e)}s.Definition={metadata:{source:!0,changes:!0},params:[{name:"lyra_id",type:"number",required:!0},{name:"lyra_selected",required:!0},{name:"lyra_mode",required:!0},{name:"signals",array:!0}]};const r=Object(a.inherits)(s,a.Transform);r.transform=function(e,t){const n=this.value||[],s=t.fork(t.NO_FIELDS&t.NO_SOURCE),r=e.lyra_id,i=e.lyra_selected,l=e.lyra_mode,o=i.mark.role,c=Object(a.tupleid)(i);if(!n.length||n._id===c&&n._mode===l||(s.rem=n.splice(0)),!o||o&&r!==+o.split("lyra_")[1])return s.source=this.value=n,s;const d=this[l](i).map(function(e){return e.mode=l,e.lyra_id=r,e});return n.length&&n._id===c?(d.forEach((e,t)=>Object(a.extend)(n[t],e)),s.mod=n):(n._id=c,n._mode=l,n.push.apply(n,d.map(a.ingest)),s.add=n),s.source=this.value=n,s},r.handles=function(e){return[]},r.connectors=function(e){return[]},r.channels=function(e){return[]},r.altchannels=function(e){return[]}},872:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(203),s=n(47).getInVis,r=n(222);t.signalLookup=function(e){return s(a.store.getState(),`signals.${r(e)}.value`)}},876:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46);t.setActiveStep=a.createStandardAction("SET_ACTIVE_STEP")(),t.setActiveWalkthrough=a.createStandardAction("SET_ACTIVE_WALKTHROUGH")()},879:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.Hints=a.Record({display:null,on:!1},"LyraHints")},88:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(23),r=n(222);t.SELECTED=r("selected"),t.MODE=r("mode"),t.ANCHOR=r("anchor"),t.DELTA=r("delta"),t.CURSOR="cursor",t.CELL=r("cell"),t.MOUSE=r("mouse"),t.signalNames=[t.SELECTED,t.MODE,t.ANCHOR,t.DELTA,t.CURSOR,t.CELL,t.MOUSE],t.Signal=a.Record({_idx:null,value:null,name:null,on:[]},"LyraSignal"),t.defaultSignalState=a.Map({[t.SELECTED]:t.Signal({name:t.SELECTED,value:{mark:{}},on:[{events:`mousedown[item().mark && item().mark.marktype !== 'group' && item().mark.name && item().mark.name !== ${s.stringValue(t.CELL)}], mouseup[item().mark && item().mark.marktype === 'group' && item().mark.name && item().mark.name !== ${s.stringValue(t.CELL)}]`,update:"item()"},{events:"mousedown[!item().mark]",update:"{mark: {}}"},{events:`dragover[item().mark && item().mark.marktype !== 'group' && item().mark.name && item().mark.name !== ${s.stringValue(t.CELL)}]{250, 250}`,update:`${t.SELECTED}.mark.name !== item().mark.name ? item() : ${t.SELECTED}`}],_idx:0}),[t.MODE]:t.Signal({name:t.MODE,value:"handles",_idx:1}),[t.DELTA]:t.Signal({name:t.DELTA,value:0,on:[{events:"[mousedown, window:mouseup] > window:mousemove",update:"{x: x() - lyra_anchor.x, y: y() - lyra_anchor.y}"}],_idx:2}),[t.ANCHOR]:t.Signal({name:t.ANCHOR,value:0,on:[{events:"mousedown",update:"{x: x(), y: y(), target: item()}"},{events:"[mousedown, window:mouseup] > window:mousemove",update:"{x: x(), y: y(), target: lyra_anchor.target}"}],_idx:3}),[t.CELL]:t.Signal({name:t.CELL,value:{},on:[{events:{type:"dragover",filter:[`event.item && event.item.mark.role === "${t.CELL}"`]},update:"item()"},{events:{type:"dragleave",filter:[`event.item && event.item.mark.role === "${t.CELL}"`]},update:"{}"}],_idx:4}),[t.MOUSE]:t.Signal({name:t.MOUSE,value:{},on:[{events:"mousemove, dragover",update:"{x: x(), y: y()}"}],_idx:5})})},880:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recordName=function(e,t,n){return n+" "+(e.getIn(["vis","present",t]).size+1)}},881:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),s=n(1173);t.Walkthrough=a.Record({data:s.data,activeStep:1,activeWalkthrough:null},"LyraWalkthrough")},882:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.MARKS="marks",e.GUIDES="guides",e.SCALES="scales",e.DATASETS="datasets",e.INTERACTIONS="interactions",e.WIDGETS="widgets"}(t.PrimType||(t.PrimType={}))},883:function(e,t,n){"use strict";e.exports=["linear","step-before","step-after","basis","basis-open","cardinal","cardinal-open","monotone"]},884:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),s=(a.getIn,a.getInVis),r=n(13),i=n(33),l=n(67),o=n(593),c=n(108),d=n(1247);t.ExtentProperty=i.connect(function(e,t){const n=t.exType,a=t.primId,r=s(e,"marks."+a+".encode.update");let i,l;return Object.values(o.default[n]).forEach(function(e){const t=e.name;r[t]._disabled||(i?i!==t&&(l=t):i=t)}),{start:i,end:l,startDisabled:r[i].band||r[i].group,endDisabled:r[l].band||r[l].group}},function(e,t){return{setExtent:function(n,a){const s=t.primId;e(l.setMarkExtent({oldExtent:n,newExtent:a},s)),e(l.resetMarkVisual(a,s))}}})(class extends r.Component{handleChange(e){const t=this.props,n=t.exType,a=e.target,s=a.name,r=a.value,i=t[s],l=o.default[n],c=l.CENTER.name,d=l.SPAN.name,p=t.end;t.setExtent(i,r),r===c&&p!==d&&t.setExtent(p,d)}render(){const e=this.props,t=e.exType,n=o.default[t],a=n.CENTER.name,s=n.SPAN.label,i=Object.values(n),l=e.start,p=e.end;return r.createElement("div",null,r.createElement(c.Property,Object.assign({name:l,type:"number",droppable:!0,firstChild:!0,disabled:e.startDisabled},e),r.createElement("div",{className:"label-long label"},r.createElement("select",{name:"start",value:l,onChange:e=>this.handleChange(e)},i.filter(function(e){return e.name!==p}).map(function(e){return r.createElement("option",{key:e.name,value:e.name},e.label)}))),r.createElement(d.SpatialPreset,Object.assign({className:"extra",name:l},e))),r.createElement(c.Property,Object.assign({name:p,type:"number",droppable:!0,firstChild:!0,disabled:e.endDisabled},e),r.createElement("br",null),r.createElement("div",{className:"label-long label"},l===a?r.createElement("label",{htmlFor:"end"},s):r.createElement("select",{name:"end",value:p,onChange:e=>this.handleChange(e)},i.filter(function(e){return e.name!==l&&e.name!==a}).map(function(e){return r.createElement("option",{key:e.name,value:e.name},e.label)}))),r.createElement(d.SpatialPreset,Object.assign({className:"extra",name:p},e))))}})},885:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(1276),s=n(1283),r=n(13),i=n(33),l=n(73),o=n(604),c=n(425),d=n(225),p=n(74),u=n(72);t.default=i.connect(function(e,t){const n=t.id,a=e.getIn(["vis","present","datasets",String(n)]);let s=[];if(a&&a.transform){const t=e.getIn(["vis","present","interactions"]).valueSeq().toArray(),n=[].concat.apply([],t.filter(e=>e.signals.length).map(e=>e.signals.map(e=>e.signal))),r=e.getIn(["vis","present","widgets"]).valueSeq().toArray(),i=[].concat.apply([],r.filter(e=>e.signals.length).map(e=>e.signals.map(e=>e.signal))),l=n.concat(i);a.transform.map(e=>{if("filter"===e.type){const t=e.expr,n=l.filter(e=>t.indexOf(e)>-1);s=s.concat(n)}})}return{dataset:a,vega:e.get("vega"),signalsInExprs:s}})(class extends r.Component{constructor(e){super(e),this.$table=r.createRef(),this.onFilterExprSignal=o.throttle(250,()=>{this.setState({output:this.props.id?d.output(this.props.id):this.props.values})}),this.prevPage=(()=>{this.setState({page:this.state.page-1},()=>{this.props.onPage&&this.props.onPage(this.state.page)}),this.$table.current.scrollLeft=0}),this.nextPage=(()=>{this.setState({page:this.state.page+1},()=>{this.props.onPage&&this.props.onPage(this.state.page)}),this.$table.current.scrollLeft=0}),this.showHoverField=(e=>{const t=e.target;this.setState({hoverField:{name:t.textContent,offsetTop:t.offsetTop},hoverValue:null})}),this.showHoverValue=(e=>{this.setState({hoverField:null,hoverValue:(e.persist(),e)})}),this.hideHover=(()=>{this.setState({hoverField:null,hoverValue:null})}),this.onScroll=(()=>{this.hideHover();const e=this.$table.current&&this.$table.current.scrollLeft;this.props.onScroll&&this.props.onScroll(e)}),this.state={page:0,hoverField:null,hoverValue:null,output:e.id?d.output(e.id):e.values,dataTableLeft:null,dataTableTop:null}}shouldComponentUpdate(e,t){const n=e.vega;return!n.get("invalid")&&!n.get("isParsing")}componentDidUpdate(e,t){var n;if(this.props.scroll!==e.scroll&&this.$table&&(this.$table.current.scrollLeft=this.props.scroll),this.$table){const e=null===(n=this.$table.current)||void 0===n?void 0:n.getBoundingClientRect();!e||this.state.dataTableTop===e.top&&this.state.dataTableLeft===e.left||this.setState({dataTableTop:e.top,dataTableLeft:e.left})}this.props.signalsInExprs!==e.signalsInExprs&&(this.onFilterExprSignal(),e.signalsInExprs.forEach(e=>{u.view.removeSignalListener(e,()=>this.onFilterExprSignal())}),this.props.signalsInExprs.forEach(e=>{u.view.addSignalListener(e,()=>this.onFilterExprSignal())}))}render(){const e=this.state,t=this.props,n=void 0!==t.page?t.page:e.page,i=t.limit,o=n*i,d=o+i,u=t.id,m=u?t.dataset.get("_schema"):t.schema,g=e.output,h=g.slice(o,d),f=m.keySeq().toArray().filter((e,t)=>void 0===this.props.fieldsIndex||void 0===this.props.fieldsCount||t>=this.props.fieldsIndex*this.props.fieldsCount&&t<this.props.fieldsIndex*this.props.fieldsCount+this.props.fieldsCount),y=g.length,v=c.format.auto.number(),_=this.$table.current&&this.$table.current.scrollLeft,b=n>0?r.createElement(l.Icon,{glyph:p.prev,width:"10",height:"10",onClick:this.prevPage}):null,S=n+1<y/i?r.createElement(l.Icon,{glyph:p.next,width:"10",height:"10",onClick:this.nextPage}):null;return r.createElement("div",{className:"datatable-container"},r.createElement("div",{className:"datatable",ref:this.$table,onMouseLeave:this.hideHover,onScroll:this.onScroll},r.createElement("table",null,r.createElement("tbody",null,f.map(function(e){return r.createElement("tr",{key:e},r.createElement("td",{className:"field "+(m.get(e).source?"source":"derived"),onMouseOver:this.showHoverField},e),h.length?h.map(function(t,n){return r.createElement("td",{key:e+n,className:n%2?"even":"odd",onMouseOver:this.showHoverValue},t[e])},this):r.createElement("td",null,"n/a"))},this))),u?r.createElement(a.default,{dsId:u,schema:m,def:e.hoverField,dataTableTop:e.dataTableTop,dataTableLeft:e.dataTableLeft}):null,r.createElement(s.default,{event:e.hoverValue,scrollLeft:_})),r.createElement("div",{className:"paging"},t.first?r.createElement("span",null,v(o+1),"",v(d>y?y:d)," of ",v(y)):null,t.last?r.createElement("span",{className:"pager"},b," ",S):null))}})},886:function(e,t,n){"use strict";var a=e.exports=["quantitative","nominal","temporal"];a.NOMINAL="nominal",a.ORDINAL="ordinal",a.QUANTITATIVE="quantitative",a.TEMPORAL="temporal"},91:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(46),s=n(270);var r;!function(e){e.SELECT_GUIDE="SELECT_GUIDE",e.SELECT_MARK="SELECT_MARK",e.SELECT_PIPELINE="SELECT_PIPELINE",e.SELECT_SCALE="SELECT_SCALE",e.SELECT_INTERACTION="SELECT_INTERACTION",e.SELECT_WIDGET="SELECT_WIDGET"}(r=t.InspectorSelectedType||(t.InspectorSelectedType={})),t.toggleLayers=a.createStandardAction("TOGGLE_LAYERS")(),t.expandLayers=a.createStandardAction("EXPAND_LAYERS")(),t.removeLayers=a.createStandardAction("REMOVE_LAYERS")(),t.selectGuide=a.createStandardAction(r.SELECT_GUIDE)(),t.baseSelectMark=a.createStandardAction(r.SELECT_MARK)(),t.selectMark=function(e){return function(n,a){const r=s.getParentGroupIds(e,a());n(t.baseSelectMark(e,r))}},t.selectPipeline=a.createStandardAction(r.SELECT_PIPELINE)(),t.selectScale=a.createStandardAction(r.SELECT_SCALE)(),t.selectInteraction=a.createStandardAction(r.SELECT_INTERACTION)(),t.selectWidget=a.createStandardAction(r.SELECT_WIDGET)(),t.startDragging=a.createStandardAction("START_DRAGGING")(),t.stopDragging=a.createStandardAction("STOP_DRAGGING")()}}]);
//# sourceMappingURL=default.js.map