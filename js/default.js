(window.__webpackJsonp__=window.__webpackJsonp__||[]).push([[0],{1065:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n(23),r=n(85),s=n(48),i=n.n(s),o=n(27);function l(e){r.a.call(this,[],e)}l.Definition=Object(a.extend)({},r.a.Definition);const c=Object(a.inherits)(l,r.a);c.handles=function(e){const t=e.mark.bounds,n=Object(o.coords)(t,"handle");return[n.topLeft,n.topRight,n.bottomLeft,n.bottomRight]},c.connectors=function(e){const t=e.mark.bounds;return[Object(o.coords)(t,"connector").midCenter]},c.channels=function(e){const t=e.mark.bounds,n=e.mark.group.bounds,a=e._svg.getAttribute("d"),r=Object(o.coords)(t).midCenter;return[].concat([{x:n.x1,y:e.y},{x:e.x-o.PADDING,y:e.y}].map(i()("x","span"))).concat([{x:e.x,y:n.y1},{x:e.x,y:e.y-o.PADDING}].map(i()("y","span"))).concat([{x:r.x,y:r.y,path:a}].map(i()("fill","border")))},c.altchannels=function(e){const t=e.mark.bounds,n=Object(o.coords)(t).midCenter,a=e.mark.items[0].pathCache;return a=a.map(function(e){return e.join(" ")}).join(" "),[{x:n.x,y:n.y,path:a}].map(i()("stroke","border"))}},1066:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n(23),r=n(85),s=n(48),i=n.n(s),o=n(27);function l(e){r.a.call(this,[],e)}l.Definition=Object(a.extend)({},r.a.Definition);const c=Object(a.inherits)(l,r.a);c.handles=function(e){const t=e.mark.bounds,n=Object(o.coords)(t,"handle");return[n.topLeft,n.topRight,n.bottomLeft,n.bottomRight]},c.connectors=function(e){const t=e.mark.bounds;return[Object(o.coords)(t,"connector").midCenter]},c.channels=function(e){const t=e.mark.bounds,n=e.mark.group.bounds,a=e._svg.getAttribute("d"),r=Object(o.coords)(t).midCenter;return[].concat([{x:n.x1,y:e.y},{x:e.x-o.PADDING,y:e.y}].map(i()("x","span"))).concat([{x:e.x,y:n.y1},{x:e.x,y:e.y-o.PADDING}].map(i()("y","span"))).concat([{x:r.x,y:r.y,path:a}].map(i()("stroke","border")))},c.altchannels=function(e){return this.channels(e).filter(e=>"stroke"===e.key).map(i()("detail","border"))}},1067:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(23),r=n(85),s=n(48),i=n.n(s),o=n(27);const l=3.5*o.PADDING;function c(e){r.a.call(this,[],e)}c.Definition=Object(a.extend)({},r.a.Definition);const p=Object(a.inherits)(c,r.a);p.handles=function(e){var t=Object(o.coords)(e.bounds,"handle");return[t.topLeft,t.topRight,t.bottomLeft,t.bottomRight]},p.connectors=function(e){return[Object(o.coords)(e.bounds,"connector").midCenter]},p.channels=function(e){var t=e.bounds,n=e.mark.group.bounds,a=Object(o.coords)(t).midCenter;return[].concat([{x:n.x1,y:a.y},{x:a.x-l,y:a.y,_voronoi:!1}].map(i()("x","span"))).concat([{x:a.x,y:n.y1},{x:a.x,y:a.y-l,_voronoi:!1}].map(i()("y","span"))).concat([{x:e.x+.01,y:e.y-.01,shape:e.shape,size:e.size}].map(i()("size","border"))).concat([{x:e.x-.01,y:e.y+.01,shape:e.shape,size:o.PADDING*e.size}].map(i()("fill","border")))},p.altchannels=function(e){return[].concat([{x:e.x+.01,y:e.y+.01,shape:e.shape,size:e.size}].map(i()("shape","border"))).concat([{x:e.x-.01,y:e.y,shape:e.shape,size:o.PADDING*e.size}].map(i()("stroke","border")))}},1068:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(23),r=n(85),s=n(48),i=n.n(s),o=n(27);const l=1.5*o.PADDING;function c(e){r.a.call(this,[],e)}c.Definition=Object(a.extend)({},r.a.Definition);const p=Object(a.inherits)(c,r.a);p.handles=function(e){var t=Object(o.coords)(e.bounds,"handle");return[t.topLeft,t.bottomRight]},p.connectors=function(e){return[Object(o.coords)(e.bounds,"connector").midCenter]},p.channels=function(e){var t=e.bounds,n=e.mark.group.bounds,r=Object(o.coords)(t).midCenter;return[].concat([{x:n.x1,y:r.y},{x:r.x-l,y:r.y}].map(i()("x","span"))).concat([{x:r.x,y:n.y1},{x:r.x,y:r.y-l}].map(i()("y","span"))).concat([Object(a.extend)({},e,{bounds:null,_id:null})].map(i()("text","border")))},p.altchannels=function(e){return[Object(a.extend)({},e,{bounds:null,_id:null})].map(i()("fill","border"))}},1069:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(23);n(309);function r(e){a.Transform.call(this,[],e),this._cellID=null,this._start=Object(a.ingest)({}),this._end=Object(a.ingest)({}),this._mouseCache={x:-1,y:-1}}r.Definition={metadata:{source:!0,changes:!0},params:[{name:"lyra_cell",required:!0},{name:"lyra_mouse",required:!0}]},Object(a.inherits)(r,a.Transform).transform=function(e,t){const n=e.lyra_cell,r=e.lyra_mouse,s=this._mouseCache,i=this._cellID,o=this._start,l=this._end,c=this.value||[],p=t.fork(t.NO_FIELDS&t.NO_SOURCE);if(c.length&&i!==Object(a.tupleid)(n)&&(p.rem=c.splice(0)),!Object(a.tupleid)(n))return p.source=this.value=c,p;let d=n.mark.group;const u=n.datum.manipulator,m=function(e){const t=e.mark.group,n=e.datum.manipulator;for(const a of t.items)if(a.role===n){if("group"===a.marktype)for(const t of a.items)if(t.datum&&t.datum.key===e.datum.key)return t.items[0].items;return a.items}return null}(n),g={x:0,y:0};if(!c.length||s.x===r.x&&s.y===r.y){if(!c.length){for(c.push(Object(a.extend)(o,r));d;d=d.mark&&d.mark.group)g.x+=d.x||0,g.y+=d.y||0;if("arrow"===u||"span"===u)c.push.apply(c,m.map(e=>Object(a.ingest)({x:e.x+g.x,y:e.y+g.y})));else{const e=m[0].bounds||m[0].mark.bounds;c.push.apply(c,[{x:e.x1,y:e.y1},{x:e.x2,y:e.y1},{x:e.x2,y:e.y2}].map(a.ingest))}c.push(Object(a.extend)(l,r)),p.add=c,this._cellID=Object(a.tupleid)(n)}}else p.mod.push(Object(a.extend)(o,r)),p.mod.push(Object(a.extend)(l,r));return this._mouseCache=r,p.source=this.value=c,p}},1096:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(1097),r=n(303),s=n(423),i=n(1149),o=n(1150),l=n(1151),c=n(420),p=n(1160),d=n(1161),u=n(1162),m=n(1163),g=n(1164),h=n(1165),f=n(1166),y=n(1167),v=n(1168),_=n(1169),b=n(1170),x=a.combineReducers({signals:y.signalsReducer,scene:f.sceneReducer,pipelines:g.pipelinesReducer,datasets:i.datasetsReducer,scales:h.scalesReducer,guides:o.guidesReducer,marks:m.marksReducer,interactions:d.interactionsReducer,widgets:u.widgetsReducer});t.default=a.combineReducers({vis:r.default(s.hydrator(x,"vis"),c.default),vega:v.invalidateVegaReducer,lyra:s.hydrator(_.lyraGlobalsReducer,"lyra"),inspector:s.hydrator(p.inspectorReducer,"inspector"),hints:l.hintsReducer,walkthrough:b.walkthroughReducer})},1105:function(e,t){},1106:function(e,t){},1107:function(e,t){},1108:function(e,t){},1126:function(e,t){},1127:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(202),r=n(40).getInVis,s=n(221);t.signalLookup=function(e){return r(a.store.getState(),`signals.${s(e)}.value`)}},1138:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Asc="ascending",e.Desc="descending"}(t.SortOrderValues||(t.SortOrderValues={})),e.exports={ASC:"asc",DESC:"desc"}},1139:function(e,t,n){"use strict";function a(){}function r(e){this.cancelled=!1,this.promise=new Promise(e.bind(this))}a.prototype.catch=a.prototype.then=function(){return new a},r.prototype.cancel=function(){this.cancelled=!0},r.prototype.then=function(e,t){if(this.cancelled)return new a;var n=this;return this.promise.then(function(t){return n.cancelled?new a:e(t)}).catch(t)},r.prototype.catch=function(e){return this.promise.catch(e)},e.exports=r},1140:function(e,t,n){"use strict";var a=n(1141),r={};Object.keys(a).forEach(function(e){var t=a[e];Object.keys(t).forEach(function(e){var n=t[e];"string"==typeof n&&(r[e]=n)})}),e.exports=r},1141:function(e,t,n){"use strict";e.exports={vega:n(593),signals:n(266),scene:n(223),pipelines:n(311),datasets:n(156),scales:n(312),guides:n(201),marks:n(67),rules:n(376),inspectors:n(92),hints:n(596),walkthrough:n(873)}},1144:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(590),r=n(156),s=n(312),i=n(40).getInVis;t.default=function(e,t){const n=a.getCounts(!0).scales;for(const t in n)0===n[t].markTotal&&e(s.deleteScale(null,+t));const o=a.getCounts(!0).data;for(const n in o)if(0===o[n].total){const a=i(t,`datasets.${n}._parent`);i(t,`pipelines.${a}._source`)!==+n&&e(r.deleteDataset(+n,a))}}},1145:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(40).getInVis,r=n(156),s=n(311);t.default=function(e,t,n){n.map.data.source_0=n.dsId,n.map.data.data_0=n.dsId;const i=n.output.data;!function(e,t,n,i){const o=i.transform&&i.transform.find(e=>"aggregate"===e.type);if(!o)return;const l=o.groupby.join("|"),c=n.plId;let p=a(t,"pipelines."+c+"._aggregates."+l);p?e(r.summarizeAggregate(o,p)):(e(s.aggregatePipeline(c,o)),p=o._id),n.map.data.source_0=p,n.map.data.data_0=p}(e,t,n,i.find(e=>"data_0"===e.name)||i.find(e=>"source_0"===e.name))}},1146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(308),r=n(201),s=n(313),i=n(167),o=n(40),l=(o.getIn,o.getInVis),c={x:a.GuideType.Axis,y:a.GuideType.Axis,color:a.GuideType.Legend,size:a.GuideType.Legend,shape:a.GuideType.Legend},p={left:"right",right:"left",top:"bottom",bottom:"top"};t.default=function(e,t,n){const o=n.channel,d=n.map,u=c[o],m=d.scales[o],g=n.output;u&&m&&(u===a.GuideType.Axis?function(e,t,n,o,c){const d=n.map,u=n.mark._parent,m=(l(t,`scales.${o}`),l(t,`marks.${u}.axes`));let g,h=!1,f=0;const y=c.filter(e=>d.scales[e.scale]===o);if(m.some(function(e){const n=l(t,`guides.${e}`);return!!n&&(n.scale===o?h=!0:void(n.orient===y[0].orient&&(++f,g=n.orient)))}),!h&&f<2){let l=a.Guide(a.GuideType.Axis,n.channel,o);l=l.mergeDeep({title:y[0].title,grid:y.length>1,orient:1===f&&g?p[g]:y[0].orient||l.orient,encode:y[0].encode});const c=i.assignId(e,t);l=l.merge({_id:c}),e(r.addGuide(l)),e(s.addAxisToGroup(c,u))}}(e,t,n,m,g.axes):function(e,t,n,o,c){const p=n.map,d=n.mark,u=n.property,m=d._parent,g=l(t,`marks.${m}.legends`);let h=!1;const f=c.find(e=>p.scales[e[u]]===o);if(g.some(function(e){const n=l(t,`guides.${e}`);if(n)return h=h||n.get(u)===o}),!h){let n=a.Guide(a.GuideType.Legend,u,o);n=(n=n.deleteIn(["encode","symbols",u])).mergeDeep({title:f.title,encode:f.encode});const l=i.assignId(e,t);n=n.merge({_id:l}),e(r.addGuide(n)),e(s.addLegendToGroup(l,m))}}(e,t,n,m,g.legends))}},1147:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),r=n(4),s=n(591),i=n(168),o=n(67),l=n(266),c=n(40).getInVis;function p(e,t,n,a){const r=t.map,s=t.markId,c=t.markType;if("detail"===(a=a||t.property))return;const p="stroke"===a?n.stroke||n.fill:n[a];"scale"in p&&"string"==typeof p.scale&&(p.scale=r.scales[p.scale]),"value"in p&&(p.signal=i.propSg(s,c,a),e(l.setSignal(p.value,p.signal)),delete p.value),e(o.setMarkVisual({property:a,def:p},s)),r.marks[s]=r.marks[s]||{},r[a]=Date.now()}t.default=function(e,t,n){const i=n.markType,l=n.map,u=n.markId,m=n.channel;let g=null,h=n.output.marks[0];"group"===h.type&&h.name.indexOf("pathgroup")>=0&&(g=h,h=h.marks[0]),"rect"!==i||"x"!==m&&"y"!==m?"text"===i&&"text"===m?function(e,t){const n=r.getFieldDef(t.input.encoding.text);e(o.setMarkVisual({property:"text",def:{signal:`{{datum.${n.field}}}`}},t.markId))}(e,n):p(e,n,h.encode.update):function(e,t,n,r){const i=n.channel,l=n.property,u=n.markId,m=n.map.marks[u],g=i+"2",h=i+"c",f=d[i],y=Object.values(s.default[i]),v=c(t,`marks.${u}.encode.update`);let _=0;if(l!==`${i}+`)return y.map(e=>a.extend({},{ts:m&&m[e.name]||0},e)).sort(a.compare("ts","descending")).forEach(t=>{const n=t.name;n!==l&&(_>=1?e(o.disableMarkVisual(n,u)):v[n]._disabled||++_)}),r[l]=r[i]||r[h]||r[l],p(e,n,r);y.forEach(t=>e(o.disableMarkVisual(t.name,u))),r[g]?(p(e,n,r,i),p(e,n,r,g)):(p(e,n,r,i),r[f]={scale:r[i].scale,band:!0,offset:-1},p(e,n,r,f))}(e,t,n,h.encode.update),g?e(o.updateMarkProperty({property:"_facet",value:Object.assign(Object.assign({},g.from.facet),{data:l.data[g.from.facet.data]})},u)):h.from&&h.from.data&&e(o.updateMarkProperty({property:"from",value:{data:l.data[h.from.data]}},u))};const d={x:"width",y:"height"}},1148:function(e,t,n){"use strict";var a=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0});const r=n(23),s=n(24),i=n(860),o=n(312),l=n(313),c=n(167),p=n(40),d=(p.getIn,p.getInVis);function u(e,t,n,a){if(n.type!==t.type)return!1;if(JSON.stringify(n.range)!==JSON.stringify(t.range))return!1;if(s.isDataRefDomain(t.domain)&&n._domain){const r=n._domain[0];if(r.field!==t.domain.field)return!1;if(d(e,`datasets.${r.data}._parent`)!==d(e,`datasets.${a[t.domain.data]}._parent`))return!1}return!0}t.default=function(e,t,n){const p=n.map.scales,m=n.map.data,g=n.mark,h=n.channel;let f=d(t,"scales."+p[h]),y=f&&f._id,v=n.output.scales;if(!v)return;if(1!==(v=v.filter(e=>e.name===h)).length)return void console.warn(v.length+" scales found for "+h);const _=function(e){const t=e.range;return"x"===e.name||r.isArray(t)&&t.find(e=>s.isSignalRef(e)&&"width"===e.signal)?e.range="width":("y"===e.name||r.isArray(t)&&t.find(e=>s.isSignalRef(e)&&"height"===e.signal))&&(e.range="height"),e}(v[0]);if(f&&u(t,_,f,m)||d(t,"scales").valueSeq().forEach(function(e){if(u(t,_,e,m))return f=e,y=e._id,!1}),!f||!u(t,_,f,m)){y=c.assignId(e,t);const l=function(e,t){const{domain:n}=t,o=a(t,["domain"]),l=s.isDataRefDomain(n)?r.extend({},o,{_domain:[{data:e.map.data[n.data],field:n.field}]}):t;return i.Scale(l)}(n,_).merge({_id:y});e(o.addScale(l))}p[h]=y,e(l.addScaleToGroup(y,g._parent))}},1149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(47),s=n(582),i=n(156),o=n(371),l=n(224);t.datasetsReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===r.getType(i.baseAddDataset))return t.meta&&l.init(t.payload,t.meta),e.set(String(t.payload._id),t.payload);if(t.type===r.getType(i.deleteDataset))return e.remove(String(n));if(t.type===r.getType(i.changeFieldMType)){const a=t.payload;return e.setIn([String(n),"_schema",a.field,"mtype"],a.mtype)}if(t.type===r.getType(i.sortDataset))return e.setIn([String(n),"_sort"],t.payload);if(t.type===r.getType(i.addTransform)){const r=t.payload,i=e.getIn([String(n),"transform"])||a.List();return"formula"===r.type&&(e=e.setIn([String(n),"_schema",r.as],o.Column({name:r.as,type:"number",mtype:s.QUANTITATIVE,source:!1}))),e.setIn([String(n),"transform"],i.concat(r))}if(t.type===r.getType(i.updateTransform)){const a=t.payload,r=a.transform;if("formula"===r.type){const t=e.getIn([String(n),"transform",a.index,"as"]),s=e.getIn([String(n),"_schema",t]);e=(e=e.deleteIn([String(n),"_schema",t])).setIn([String(n),"_schema",r.as],s.set("name",r.as))}return e.setIn([String(n),"transform",a.index],a.transform)}if(t.type===r.getType(i.summarizeAggregate)){const a=(e=(e=(e=e.setIn([String(n),"transform","0","fields"],e.getIn([String(n),"transform","0","fields"]).concat(t.payload.fields))).setIn([String(n),"transform","0","ops"],e.getIn([String(n),"transform","0","ops"]).concat(t.payload.ops))).setIn([String(n),"transform","0","as"],e.getIn([String(n),"transform","0","as"]).concat(t.payload.as))).getIn([String(n),"source"]);return e.setIn([String(n),"_schema"],l.aggregateSchema(e.getIn([a,"_schema"]),e.getIn([String(n),"transform","0"])))}return e}},1150:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(47),s=n(201),i=n(312),o=n(308),l=n(40).str,c=n(168).convertValuesToSignals;t.guidesReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===r.getType(s.baseAddGuide))return e.set(l(n),function(e){const t=e.payload,n=t.encode;return t.merge({encode:Object.keys(n).reduce(function(e,a){return e[a]=c(n[a],"guide",t._id,a),e},{})})}(t));if(t.type===r.getType(s.deleteGuide))return e.remove(l(n));if(t.type===r.getType(s.updateGuideProperty))return e.setIn([l(n),t.payload.property],a.fromJS(t.payload.value));if(t.type===r.getType(i.deleteScale)){const n=t.meta;return e.withMutations(function(t){e.forEach(function(e,a){+(o.isAxis(e)?e.scale:o.isLegend(e)?e[e._type]:null)===n&&t.delete(String(a))})})}return e}},1151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(596),s=n(67),i=n(223),o=n(1152),l=n(1159),c=n(876);t.hintsReducer=function(e,t){if(void 0===e)return c.Hints();if(t.type===a.getType(r.clearHints))return e.set("display",null);if(t.type===a.getType(r.hintsOn))return e.set("on",t.payload);if(t.type===a.getType(i.baseCreateScene))return e.set("display",l.SceneHints.CREATE_SCENE);if(t.type===a.getType(s.baseAddMark)){const n=t.payload.props.type;if(o.MarkHints.ADD_MARK[n])return e.set("display",o.MarkHints.ADD_MARK[n])}return e}},1152:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(223);t.MarkHints={ADD_MARK:{rect:{title:"I see you have added a RECT...",text:"Maybe you'd like to clear the whole canvas",action_text:"DO IT. CLEAR IT OUT.",action:a.clearScene},line:{title:"I see you have added a LINE...",text:"Drop data on it to create a graph."},symbol:{template:n(1153)}}}},1153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(67),i=n(72).lookup;t.SymbolHints=r.connect(function(e,t){return{selectedId:e.getIn(["inspector","encodings","selectedId"])}},function(e,t){return{updateProperty:(t,n,a)=>{const r=i(t);r&&(r[n]=a),e(s.updateMarkProperty({property:n,value:a},t))}}})(class extends a.Component{render(){return a.createElement("div",null,a.createElement("p",null,"I have a special template!!!"))}})},1159:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(596);t.SceneHints={CREATE_SCENE:{title:"Hi, I'm helpy the helper hints box",text:"You can turn me on and off. You can manage this in the settings link in the footer.",action_text:"DISABLE HINTS",action:a.hintsOn,action_props:!1}}},1160:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(92),s=n(158),i=n(225),o=n(67),l=n(268);function c(e,t){return t.reduce(function(e,t){return e.setIn(["encodings","expandedLayers",t],!0)},e)}t.inspectorReducer=function(e,t){if(void 0===e)return l.Inspector();if(t.type===a.getType(r.selectPipeline))return e.setIn(["pipelines","selectedId"],t.payload);if(t.type===a.getType(r.startDragging))return e.setIn(["dragging"],t.payload);if(t.type===a.getType(r.stopDragging))return e.setIn(["dragging"],null);if(t.type!==a.getType(r.baseSelectMark)&&t.type!==a.getType(r.selectScale)&&t.type!==a.getType(r.selectInteraction)&&t.type!==a.getType(r.selectWidget)&&t.type!==a.getType(r.selectGuide)||(e=(e=e.setIn(["encodings","selectedId"],t.payload)).setIn(["encodings","selectedType"],t.type)),t.type===a.getType(s.baseAddInteraction)&&(e=(e=e.setIn(["encodings","selectedId"],t.meta)).setIn(["encodings","selectedType"],a.getType(r.selectInteraction))),t.type===a.getType(i.baseAddWidget)&&(e=(e=e.setIn(["encodings","selectedId"],t.meta)).setIn(["encodings","selectedType"],a.getType(r.selectWidget))),t.type===a.getType(o.baseAddMark)&&(e=(e=e.setIn(["encodings","selectedId"],t.meta)).setIn(["encodings","selectedType"],a.getType(r.baseSelectMark))),t.type===a.getType(r.baseSelectMark))return c(e,t.meta);if(t.type===a.getType(o.baseAddMark)){const n={};return n[t.payload.props._parent]=!0,"group"===t.payload.props.type&&(n[t.meta]=!0),e.mergeIn(["encodings","expandedLayers"],n)}return t.type===a.getType(r.expandLayers)?c(e,t.payload):t.type===a.getType(r.removeLayers)?t.payload.reduce(function(e,t){return e.deleteIn(["encodings","expandedLayers",t])},e):t.type===a.getType(r.toggleLayers)?t.payload.reduce(function(e,t){const n=["encodings","expandedLayers",t];return e.setIn(n,!e.getIn(n))},e):e}},1161:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(47),s=n(158);t.interactionsReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===r.getType(s.baseAddInteraction))return e.set(String(n),t.payload);if(t.type===r.getType(s.setInput))return e.setIn([String(n),"input"],t.payload);if(t.type===r.getType(s.setSelection))return e.setIn([String(n),"selection"],t.payload);if(t.type===r.getType(s.setApplication)){const a=e.getIn([String(n),"applications"]).filter(e=>e.id!==t.payload.id);return e.setIn([String(n),"applications"],[...a,t.payload])}if(t.type===r.getType(s.setSignals))return e.setIn([String(n),"signals"],t.payload);if(t.type===r.getType(s.setSignalPush)){const a=e.getIn([String(n),"signals"]);return a.forEach(e=>{e.signal in t.payload&&(e.push=t.payload[e.signal])}),e.setIn([String(n),"signals"],a)}if(t.type===r.getType(s.removeApplication)){const a=e.getIn([String(n),"applications"]).filter(e=>e.id!==t.payload.id);return e.setIn([String(n),"applications"],a)}return t.type===r.getType(s.deleteInteraction)?e.remove(String(n)):t.type===r.getType(s.updateInteractionName)?e.setIn([String(n),"name"],t.payload):e}},1162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(47),s=n(225);t.widgetsReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===r.getType(s.baseAddWidget))return e.set(String(n),t.payload);if(t.type===r.getType(s.setSelection))return e.setIn([String(n),"selection"],t.payload);if(t.type===r.getType(s.setApplication)){const a=e.getIn([String(n),"applications"]).filter(e=>e.id!==t.payload.id);return e.setIn([String(n),"applications"],[...a,t.payload])}if(t.type===r.getType(s.removeApplication)){const a=e.getIn([String(n),"applications"]).filter(e=>e.id!==t.payload.id);return e.setIn([String(n),"applications"],a)}return t.type===r.getType(s.setSignals)?e.setIn([String(n),"signals"],t.payload):t.type===r.getType(s.deleteWidget)?e.remove(String(n)):t.type===r.getType(s.updateWidgetName)?e.setIn([String(n),"name"],t.payload):e}},1163:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(47),s=n(313),i=n(201),o=n(67),l=n(223),c=n(158),p=n(225),d=n(168),u=function(e,t,n){return e.updateIn(t,e=>(-1===e.indexOf(n)&&e.push(n),e))},m=function(e,t,n){return e.updateIn(t,e=>-1===e.indexOf(n)?[...e,n]:e)},g=function(e,t,n){return e.updateIn(t,e=>e.filter(e=>e!==n))};function h(e){const t=e.payload.props,n=t.encode&&t.encode.update;return t.encode?t.merge({encode:{update:d.convertValuesToSignals(n,t.type,e.meta)}}):t}function f(e,t){const{parentId:n,childId:a}=t;if(void 0===a)return e;const r=e.get(String(a));if(!r)return e;const s=r._parent;if(null==s&&!n)return e;const i=e.get(String(s)),o=n?e.get(String(n)):n;return null===o?g(e.setIn([String(a),"_parent"],null),[String(s),"marks"],a):u(i&&o?g(e.setIn([String(a),"_parent"],n),[String(s),"marks"],a):e.setIn([String(a),"_parent"],n),[String(n),"marks"],a)}t.marksReducer=function(e,t){if(void 0===e)return a.Map();const n=t.meta;if(t.type===r.getType(l.baseCreateScene))return e.set(String(n),h(t));if(t.type===r.getType(o.baseAddMark))return f(e.set(String(n),h(t)),{parentId:t.payload.props?t.payload.props._parent:null,childId:n});if(t.type===r.getType(o.baseDeleteMark))return f(e,{childId:n,parentId:null}).remove(String(n));if(t.type===r.getType(o.setParent))return f(e,{parentId:t.payload,childId:n});if(t.type===r.getType(o.updateMarkProperty))return e.setIn([String(n),t.payload.property],t.payload.value);if(t.type===r.getType(o.setMarkVisual))return e.setIn([String(n),"encode","update",t.payload.property],t.payload.def);if(t.type===r.getType(o.disableMarkVisual))return e.setIn([String(n),"encode","update",t.payload,"_disabled"],!0);if(t.type===r.getType(o.resetMarkVisual)){const a=e.getIn([String(n),"type"]),r=t.payload;return e.setIn([String(n),"encode","update",r],{signal:d.propSg(n,a,r)})}if(t.type===r.getType(o.setMarkExtent))return e.setIn([String(n),"encode","update",t.payload.oldExtent,"_disabled"],!0).setIn([String(n),"encode","update",t.payload.newExtent,"_disabled"],!1);if(t.type===r.getType(o.setVlUnit))return e.setIn([String(n),"_vlUnit"],t.payload);if(t.type===r.getType(o.bindScale))return e.setIn([String(n),"encode","update",t.payload.property,"scale"],t.payload.scaleId);const y=t.meta;if(t.type===r.getType(s.addScaleToGroup))return u(e,[String(y),"scales"],t.payload);if(t.type===r.getType(s.addAxisToGroup))return m(e,[String(y),"axes"],t.payload);if(t.type===r.getType(s.addLegendToGroup))return m(e,[String(y),"legends"],t.payload);if(t.type===r.getType(s.addInteractionToGroup))return m(e,[String(y),"_interactions"],t.payload);if(t.type===r.getType(s.addWidgetToGroup))return m(e,[String(y),"_widgets"],t.payload);const v=t.meta;return t.type===r.getType(i.deleteGuide)?(e=g(e,[String(t.payload.groupId),"axes"],v),g(e,[String(t.payload.groupId),"legends"],v)):t.type===r.getType(c.deleteInteraction)?g(e,[String(t.payload.groupId),"_interactions"],v):t.type===r.getType(p.deleteWidget)?g(e,[String(t.payload.groupId),"_widgets"],v):e}},1164:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(47),s=n(311),i=n(40).str;t.pipelinesReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===r.getType(s.baseAddPipeline))return e.set(i(n),t.payload);if(t.type===r.getType(s.updatePipelineProperty)){const a=t.payload;return e.setIn([i(n),a.property],a.value)}if(t.type===r.getType(s.baseAggregatePipeline)){const a=t.payload;return e.setIn([i(n),"_aggregates",a.key],a.dsId)}return e}},1165:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(47),s=n(312);t.scalesReducer=function(e,t){const n=t.meta;if(void 0===e)return a.Map();if(t.type===r.getType(s.baseAddScale)){let a=t.payload.set("name",function(e,t){const n=e.valueSeq().map(e=>e.get("name"));let a=1,r=t||"scale";for(;n.contains(r);)r=t+""+ ++a;return r}(e,t.payload.name));return e.set(String(n),a)}if(t.type===r.getType(s.updateScaleProperty)){const a=t.payload;return e.setIn([String(n),a.property],a.value)}if(t.type===r.getType(s.amendDataRef)){const a=t.payload,r=e.getIn([String(n),a.property]);return e.setIn([String(n),a.property],r.push(a.ref))}return t.type===r.getType(s.deleteScale)?e.remove(String(n)):e}},1166:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(47),s=n(223);t.sceneReducer=function(e,t){return void 0===e?a.Map():t.type===r.getType(s.baseCreateScene)?e.set("_id",t.meta):e}},1167:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(47),s=n(201),i=n(67),o=n(266),l=n(90),c=n(168),p=n(221);function d(e,t,n){return e.set(t,l.Signal({name:p(t),value:n,_idx:e.size}))}function u(e,t,n){return e.setIn([t,"on"],n)}function m(e,t,n,a){return n?Object.keys(n).reduce(function(e,o){if(void 0===n[o]||void 0===n[o].value)return e;if(t.type===r.getType(s.baseAddGuide)){const r="guide",s=a+"_"+o;return d(e,c.propSg(t.meta,r,s),n[o].value)}if(t.type===r.getType(i.baseAddMark)){const a=t.payload.props.type,r=o,s=c.propSg(t.meta,a,r),i=t.payload.streams,l=d(e,s,n[o].value);return i&&i[s]?u(l,s,i[s]):l}},e):e}t.signalsReducer=function(e,t){if(void 0===e)return a.Map();if(t.type===r.getType(o.initSignal))return d(e,t.meta,t.payload);if(t.type===r.getType(o.setSignal))return e.setIn([t.meta,"value"],t.payload);if(t.type===r.getType(o.setSignalStreams))return u(e,t.meta,t.payload);if(t.type===r.getType(o.unsetSignal))return e.remove(t.meta);if(t.type===r.getType(i.baseAddMark))return m(e,t,t.payload.props.encode&&t.payload.props.encode.update);if(t.type===r.getType(s.baseAddGuide)){const n=t.payload.encode;return Object.keys(n).forEach(function(a){e=m(e,t,n[a],a)}),e}return t.type===r.getType(i.baseDeleteMark)||t.type===r.getType(s.deleteGuide)?function(e,t){const n=t.type===r.getType(i.baseDeleteMark)?t.payload:"guide",a=new RegExp("^"+p(n+"_"+t.meta));return e.filter(function(e,t){return!a.test(t)})}(e,t):e}},1169:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(597),s=n(852);t.lyraGlobalsReducer=function(e,t){return void 0===e?r.LyraGlobals({idCounter:1}):t.type===a.getType(s.incrementCounter)?e.set("idCounter",e.get("idCounter")+1):e}},1170:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(873),s=n(878);t.walkthroughReducer=function(e,t){return void 0===e?s.Walkthrough():t.type===a.getType(r.setActiveStep)?e.set("activeStep",t.payload):t.type===a.getType(r.setActiveWalkthrough)?e.set("activeWalkthrough",t.payload):e}},1171:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data={example:n(1172),barChart:n(1173)}},1172:function(e){e.exports={title:"Example Walkthrough",image:"https://placeholdit.imgix.net/~text?txtsize=33&txt=150%C3%97150&w=150&h=150",alt_text:"an image",steps:[{id:1,title:"Step 1: Add a RECT",text:"Click on the RECT button in the toolbar to add a new Rect to the canvas",image:"http://fillmurray.com/g/150/150",alt_text:"an image",lyra_state:{},help:"If you are stuck, try clearing the scene."},{id:2,title:"Step 2: Change Color",text:"Select the RECT mark and then change it's color to #000000 in the property inspector",image:"http://fillmurray.com/150/150",alt_text:"an image",lyra_state:{marks:[{type:"rect"}]},help:"If you are stuck, try clearing the scene."},{id:3,title:"Step 2: Change color",text:"Select the RECT mark and then change it's stroke color to #ffffff",image:"http://fillmurray.com/g/150/150",alt_text:"an image",lyra_state:{marks:[{type:"rect",properties:{update:{fill:{value:"#000000"}}}}]},help:"If you are stuck, try clearing the scene."},{id:4,title:"Walkthrough complete!",text:"You did it!",image:"http://fillmurray.com/150/150",alt_text:"an image",lyra_state:{marks:[{type:"rect",properties:{update:{fill:{value:"#000000"},stroke:{value:"#ffffff"}}}}]}}]}},1173:function(e){e.exports={title:"Cool times",image:"https://placeholdit.imgix.net/~text?txtsize=33&txt=150%C3%97150&w=150&h=150",alt_text:"an image",steps:[{id:1,title:"Step 1: Add a SYMBOL",text:"Click on the SYMBOL button in the toolbar to add a new Rect to the canvas",image:"http://fillmurray.com/g/150/150",alt_text:"an image",lyra_state:{},help:"If you are stuck, try clearing the scene."},{id:2,title:"Step 2: Change symbol shape",text:"Select the SYMBOL and change it's SHAPE to CROSS",image:"http://fillmurray.com/150/150",alt_text:"an image",lyra_state:{marks:[{type:"symbol"}]},help:"If you are stuck, try clearing the scene."},{id:3,title:"Step 3: Change color and add RECT",text:"Select the SYMBOL mark and then change it's stroke color to #ffffff, then add a RECT mark and change it's fill to #000000",image:"http://fillmurray.com/g/150/150",alt_text:"an image",lyra_state:{marks:[{type:"symbol",properties:{update:{shape:{value:"cross"}}}}]},help:"If you are stuck, try clearing the scene."},{id:4,title:"Walkthrough complete!",text:"You did it!",image:"http://fillmurray.com/150/150",alt_text:"an image",lyra_state:{marks:[{type:"symbol",properties:{update:{shape:{value:"cross"},stroke:{value:"#ffffff"}}}},{type:"rect",properties:{update:{fill:{value:"#000000"}}}}]}}]}},1175:function(e,t,n){"use strict";n.r(t);var a=n(1065),r=n(1066),s=n(662),i=n(1067),o=n(1068),l=n(1069),c=n(23);const p=n(221),d=p("manipulators_"),u={[`${d}area`]:a.a,[`${d}group`]:s.a,[`${d}line`]:r.a,[`${d}rect`]:s.a,[`${d}symbol`]:i.a,[`${d}text`]:o.a,[p("bubble_cursor")]:l.a};Object.keys(u).forEach(e=>u[e].Definition.type=e),c.extend(c.transforms,u),t.default=u},1176:function(e,t,n){"use strict";var a=n(90),r=n(375),s=n(40),i=s.getIn,o=s.getInVis,l=n(593).parseVega;function c(e,t){var n=e.getState(),a=i(n,"vega.invalid"),r=o(n,"scene._id");if(a){if(!r)return!0;t.view&&(t.view.finalize(),t.view=null),e.dispatch(l(!0)),t.parse().then(function(){e.dispatch(l(!1))})}return a}function p(e,t){if(e){var n=t.signal(a.SELECTED).mark.role,s=n&&+n.split("lyra_")[1],i=e.get("_id");if(i!==s){var o=[i].concat(r.getParentGroupIds(i)),l=r.findInItemTree(t.scenegraph().root.items[0],o);(t._running||Promise.resolve(!0)).then(function(){null!==l&&(t.signal(a.SELECTED,l),t.runAsync())})}}}e.exports={createStoreListener:function(e,t){return function(){var n=c(e,t),a=e.getState(),r=i(a,"vega.isParsing");if(!n&&!r&&t.view&&t.view.signal&&"function"==typeof t.view.signal){var s=i(a,"inspector.encodings.selectedId"),l=o(a,"marks."+s);s&&l&&p(l,t.view)}}},_recreateVegaIfNecessary:c,_updateSelectedMarkInVega:p}},1177:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(378),s=n(35),i=n(226),o=n(202),l=n(1181),c=n(1234),p=n(1259),d=n(1287),u=n(1293);e.exports=r.render(a.createElement(s.Provider,{store:o.store},a.createElement("div",{className:"lyra-container"},a.createElement("div",{className:"sidebar-container"},a.createElement(l.EncodingsSidebar,null),a.createElement(c.InspectorSidebar,null)),a.createElement("div",{className:"main-container"},a.createElement(p.PipelinesToolbar,null),a.createElement("div",{className:"tools-container"},a.createElement("div",{className:"vis-container"},a.createElement("div",{id:"vis"}),a.createElement(u.default,null)),a.createElement(d.Toolbar,null))),a.createElement(i.default,{effect:"solid",delayShow:375,class:"tooltip",html:!0}))),document.querySelector(".app-container"))},1181:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(1182),s=n(1233);t.EncodingsSidebar=class extends a.Component{constructor(){super(...arguments),this.groupList=a.createRef(),this.scaleList=a.createRef()}render(){return a.createElement("div",{className:"sidebar",id:"visual-sidebar"},a.createElement(r.default,{ref:e=>this.groupList=e}),a.createElement(s.default,{ref:e=>this.scaleList=e}))}}},1182:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(92),i=n(67),o=n(223),l=n(421),c=n(87),p=n(1183),d=n(40).getInVis,u=n(88);t.default=r.connect(function(e){const t=d(e,"scene._id");return{sceneId:t,selectedId:e.getIn(["inspector","encodings","selectedId"]),selectedType:e.getIn(["inspector","encodings","selectedType"]),marks:d(e,"marks."+t+".marks")}},function(e){return{addMark:function(t,n){e(i.addMark(l.Mark(t,{_parent:n})))},selectMark:function(t){e(s.selectMark(t))},clearScene:function(){e(s.selectMark(null)),e(o.clearScene())}}})(class extends a.Component{render(){const e=this.props,t=e.sceneId,n=e.selectedId===t&&e.selectedType===s.InspectorSelectedType.SELECT_MARK,r=e.marks?e.marks:[];return a.createElement("div",{id:"layer-list",className:"expandingMenu"},a.createElement("h2",null,"Groups",a.createElement("span",{className:"new",onClick:this.props.addMark.bind(null,"group",t)},a.createElement(c.Icon,{glyph:u.plus}))),a.createElement("ul",null,a.createElement("li",{id:"scene"},a.createElement("div",{className:"edit name"+(n?" selected":""),onClick:this.props.selectMark.bind(null,t)}," Edit Scene",a.createElement(c.Icon,{glyph:u.erase,className:"delete",onClick:this.props.clearScene,"data-html":!0,"data-tip":"Clear scene","data-place":"right"})))),a.createElement("ul",null,r.map(function(t){return a.createElement(p.default,Object.assign({key:t,id:t},e))},this)))}})},1183:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(226),i=n(92),o=n(67),l=n(87),c=n(1184),p=n(1227),d=n(1231),u=n(1232),m=n(314),g=n(40).getInVis,h=n(88);t.default=r.connect(function(e,t){return{expandedLayers:e.getIn(["inspector","encodings","expandedLayers"]),group:g(e,"marks."+t.id)}},function(e,t){return{selectGroup:function(){e(i.selectMark(t.id))},deleteGroup:function(n){const a=t.id;t.selectedId===a&&e(i.selectMark(t.sceneId)),e(o.deleteMark(a)),n.preventDefault(),n.stopPropagation(),s.default.hide()},updateName:function(n){e(o.updateMarkProperty({property:"name",value:n},t.id))},toggleGroup:function(){e(i.toggleLayers([t.id]))}}})(class extends a.Component{componentDidUpdate(){s.default.rebuild()}render(){const e=this.props,t=e.id,n=e.group,r=n.name,s=e.expandedLayers[t],o=s?"expanded":"contracted";return a.createElement("li",{className:o},a.createElement("div",{className:"name"+(e.selectedId===t&&e.selectedType===i.InspectorSelectedType.SELECT_MARK?" selected":""),onClick:e.selectGroup},a.createElement(l.Icon,{glyph:h["group-"+o],onClick:e.toggleGroup}),a.createElement(m,{value:r,save:e.updateName,onClick:e.selectGroup}),a.createElement(l.Icon,{glyph:h.trash,className:"delete",onClick:e.deleteGroup,"data-html":!0,"data-place":"right","data-tip":"Delete "+r+" and <br> everything inside it"})),s&&n.get("marks")?a.createElement("ul",{className:"group"},a.createElement(c.default,Object.assign({groupId:t},e)),a.createElement(p.default,Object.assign({groupId:t},e)),a.createElement(d.default,Object.assign({groupId:t},e)),a.createElement(u.default,Object.assign({groupId:t},e))):null)}})},1184:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(226),i=n(201),o=n(92),l=n(308),c=n(87),p=n(370),d=n(40).getInVis,u=n(88);t.default=r.connect(function(e,t){const n=t.groupId,a=d(e,"marks."+n+".axes"),r=d(e,"marks."+n+".legends");return{scales:d(e,"scales"),guides:a.concat(r).map(function(t){return d(e,"guides."+t)}).filter(function(e){return!!e})}},function(e,t){return{selectGuide:function(t){e(o.selectGuide(t))},deleteGuide:function(n,a,r){const l=t.groupId;n===a&&e(o.selectMark(l)),e(i.deleteGuide({groupId:l},a)),r.preventDefault(),r.stopPropagation(),s.default.hide()}}})(class extends a.Component{componentDidUpdate(){s.default.rebuild()}render(){const e=this.props,t=e.selectedId,n=e.selectedType;return a.createElement("div",null,a.createElement("li",{className:"header"},"Guides "),e.guides.map(function(r){const s=r._id;let i;r._gtype===l.GuideType.Axis?i=(r=r).scale:r._gtype===l.GuideType.Legend&&(i=(r=r)[r._type]);const d=p(e.scales.getIn([i,"name"])),m=p(r._gtype);return a.createElement("li",{key:s},a.createElement("div",{style:{paddingLeft:"26px"},className:"name"+(t===s&&n===o.InspectorSelectedType.SELECT_GUIDE?" selected":""),onClick:e.selectGuide.bind(null,s)},d+" "+m,a.createElement(c.Icon,{glyph:u.trash,className:"delete",onClick:e.deleteGuide.bind(null,t,s),"data-tip":"Delete "+d+" "+m,"data-place":"right"})))}))}})},1185:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"mark-group-open",use:"mark-group-open-usage",viewBox:"0 0 100 125",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 125" id="mark-group-open"><g transform="rotate(90 50 50)"><polygon points="14.019,14.02 85.981,50.004 14.019,85.98" /></g></symbol>'});r.add(s);e.exports=s},1186:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"mark-group-closed",use:"mark-group-closed-usage",viewBox:"0 0 100 125",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 125" id="mark-group-closed"><g><polygon points="14.019,14.02 85.981,50.004 14.019,85.98" /></g></symbol>'});r.add(s);e.exports=s},1187:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"mark-rect",use:"mark-rect-usage",viewBox:"0 0 14 17.5",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 14 17.5" id="mark-rect"><path fill-rule="evenodd" clip-rule="evenodd" d="M10,6v7c0,0.55,0.45,1,1,1h2c0.55,0,1-0.45,1-1V6c0-0.55-0.45-1-1-1h-2  C10.45,5,10,5.45,10,6z M5,1v12c0,0.55,0.45,1,1,1h2c0.55,0,1-0.45,1-1V1c0-0.55-0.45-1-1-1H6C5.45,0,5,0.45,5,1z M0,9v4  c0,0.55,0.45,1,1,1h2c0.55,0,1-0.45,1-1V9c0-0.55-0.45-1-1-1H1C0.45,8,0,8.45,0,9z" />\n\x3c!-- <text x="0" y="29" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Dilon Choudhury</text><text x="0" y="34" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});r.add(s);e.exports=s},1188:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"mark-line",use:"mark-line-usage",viewBox:"0 0 100 100",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" id="mark-line"><polygon stroke-width="2" points="8.744,100 0,97.362 17.2,35.373 60.077,52.269 91.799,0 99.607,4.739 63.892,63.589 23.08,47.506" /></symbol>'});r.add(s);e.exports=s},1189:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"mark-area",use:"mark-area-usage",viewBox:"0 0 111 122.5",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 111 122.5" id="mark-area"><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M10 86.0322264L29.5264445 51.6235581 45.3423478 59.340291 61.8834325 28.2855206 80.0690932 39.7393663 100 10 100 86.0322266 10 86.0322264ZM10 86.0322264" /></g>\n\x3c!-- <text x="0" y="113" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Pham Thi Dieu Linh</text><text x="0" y="118" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});r.add(s);e.exports=s},1190:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"mark-text",use:"mark-text-usage",viewBox:"0 0 24 30",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 30" id="mark-text"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.905 3.068c-1.076 0-1.903 0.364-2.47 1.091 -0.571 0.729-0.858 1.787-0.858 3.18v0.083H1.686V0h20.629v7.422h-2.863V7.339c0-1.383-0.288-2.438-0.861-3.17 -0.577-0.734-1.408-1.101-2.495-1.101h-0.852v16.47c0 0.75 0.098 1.224 0.298 1.407 0.198 0.186 0.647 0.278 1.338 0.278h1.637V24H5.629v-2.776h1.52c0.658 0 1.089-0.076 1.296-0.233 0.211-0.158 0.313-0.644 0.313-1.452V3.068H7.905z" />\n\x3c!-- <text x="0" y="39" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Plainicon</text><text x="0" y="44" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});r.add(s);e.exports=s},1191:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"mark-symbol",use:"mark-symbol-usage",viewBox:"0 0 100 125",content:'<symbol xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 125" id="mark-symbol"><title>Bars plot</title><g transform="translate(0,-952.36217)"><circle cx="39.75" cy="1028.3622" r="25" fill-opacity="1" stroke="none" /><circle cx="57.5" cy="982.86218" r="18" fill-opacity="1" stroke="none" /></g>\n\x3c!-- <text x="0" y="115" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Gonzalo Bravo</text><text x="0" y="120" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});r.add(s);e.exports=s},1192:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"trash",use:"trash-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="trash"><path d="M704 1376v-704q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v704q0 14 9 23t23 9h64q14 0 23-9t9-23zm256 0v-704q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v704q0 14 9 23t23 9h64q14 0 23-9t9-23zm256 0v-704q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v704q0 14 9 23t23 9h64q14 0 23-9t9-23zm-544-992h448l-48-117q-7-9-17-11h-317q-10 2-17 11zm928 32v64q0 14-9 23t-23 9h-96v948q0 83-47 143.5t-113 60.5h-832q-66 0-113-58.5t-47-141.5v-952h-96q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h309l70-167q15-37 54-63t79-26h320q40 0 79 26t54 63l70 167h309q14 0 23 9t9 23z" /></symbol>'});r.add(s);e.exports=s},1193:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"plus",use:"plus-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="plus"><path d="M1600 736v192q0 40-28 68t-68 28h-416v416q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-416h-416q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h416v-416q0-40 28-68t68-28h192q40 0 68 28t28 68v416h416q40 0 68 28t28 68z" /></symbol>'});r.add(s);e.exports=s},1194:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"undo",use:"undo-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="undo"><path d="M1664 896q0 156-61 298t-164 245-245 164-298 61q-172 0-327-72.5t-264-204.5q-7-10-6.5-22.5t8.5-20.5l137-138q10-9 25-9 16 2 23 12 73 95 179 147t225 52q104 0 198.5-40.5t163.5-109.5 109.5-163.5 40.5-198.5-40.5-198.5-109.5-163.5-163.5-109.5-198.5-40.5q-98 0-188 35.5t-160 101.5l137 138q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59 39-17 69 14l130 129q107-101 244.5-156.5t284.5-55.5q156 0 298 61t245 164 164 245 61 298z" /></symbol>'});r.add(s);e.exports=s},1195:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"redo",use:"redo-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="redo"><path d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5 163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0 225-52t179-147q7-10 23-12 14 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109 132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298 164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14 39 17 39 59z" /></symbol>'});r.add(s);e.exports=s},1196:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"type-nominal",use:"type-nominal-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="type-nominal"><path d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0 57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29 31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15 34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 4-.5 13t-.5 13q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0 12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11 2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0 22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58 0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z" /></symbol>'});r.add(s);e.exports=s},1197:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"type-ordinal",use:"type-ordinal-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="type-ordinal"><path d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0 57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29 31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15 34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 4-.5 13t-.5 13q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0 12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11 2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0 22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58 0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z" /></symbol>'});r.add(s);e.exports=s},1198:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"type-quantitative",use:"type-quantitative-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="type-quantitative"><path d="M991 1024l64-256h-254l-64 256h254zm768-504l-56 224q-7 24-31 24h-327l-64 256h311q15 0 25 12 10 14 6 28l-56 224q-5 24-31 24h-327l-81 328q-7 24-31 24h-224q-16 0-26-12-9-12-6-28l78-312h-254l-81 328q-7 24-31 24h-225q-15 0-25-12-9-12-6-28l78-312h-311q-15 0-25-12-9-12-6-28l56-224q7-24 31-24h327l64-256h-311q-15 0-25-12-10-14-6-28l56-224q5-24 31-24h327l81-328q7-24 32-24h224q15 0 25 12 9 12 6 28l-78 312h254l81-328q7-24 32-24h224q15 0 25 12 9 12 6 28l-78 312h311q15 0 25 12 9 12 6 28z" /></symbol>'});r.add(s);e.exports=s},1199:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"type-temporal",use:"type-temporal-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="type-temporal"><path d="M192 1664h288v-288h-288v288zm352 0h320v-288h-320v288zm-352-352h288v-320h-288v320zm352 0h320v-320h-320v320zm-352-384h288v-288h-288v288zm736 736h320v-288h-320v288zm-384-736h320v-288h-320v288zm768 736h288v-288h-288v288zm-384-352h320v-320h-320v320zm-352-864v-288q0-13-9.5-22.5t-22.5-9.5h-64q-13 0-22.5 9.5t-9.5 22.5v288q0 13 9.5 22.5t22.5 9.5h64q13 0 22.5-9.5t9.5-22.5zm736 864h288v-320h-288v320zm-384-384h320v-288h-320v288zm384 0h288v-288h-288v288zm32-480v-288q0-13-9.5-22.5t-22.5-9.5h-64q-13 0-22.5 9.5t-9.5 22.5v288q0 13 9.5 22.5t22.5 9.5h64q13 0 22.5-9.5t9.5-22.5zm384-64v1280q0 52-38 90t-90 38h-1408q-52 0-90-38t-38-90v-1280q0-52 38-90t90-38h128v-96q0-66 47-113t113-47h64q66 0 113 47t47 113v96h384v-96q0-66 47-113t113-47h64q66 0 113 47t47 113v96h128q52 0 90 38t38 90z" /></symbol>'});r.add(s);e.exports=s},1200:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"prev",use:"prev-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="prev"><path d="M1664 896v128q0 53-32.5 90.5t-84.5 37.5h-704l293 294q38 36 38 90t-38 90l-75 76q-37 37-90 37-52 0-91-37l-651-652q-37-37-37-90 0-52 37-91l651-650q38-38 91-38 52 0 90 38l75 74q38 38 38 91t-38 91l-293 293h704q52 0 84.5 37.5t32.5 90.5z" /></symbol>'});r.add(s);e.exports=s},1201:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"next",use:"next-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="next"><path d="M1600 960q0 54-37 91l-651 651q-39 37-91 37-51 0-90-37l-75-75q-38-38-38-91t38-91l293-293h-704q-52 0-84.5-37.5t-32.5-90.5v-128q0-53 32.5-90.5t84.5-37.5h704l-293-294q-38-36-38-90t38-90l75-75q38-38 90-38 53 0 91 38l651 651q37 35 37 90z" /></symbol>'});r.add(s);e.exports=s},1202:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"close",use:"close-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="close"><path d="M1490 1322q0 40-28 68l-136 136q-28 28-68 28t-68-28l-294-294-294 294q-28 28-68 28t-68-28l-136-136q-28-28-28-68t28-68l294-294-294-294q-28-28-28-68t28-68l136-136q28-28 68-28t68 28l294 294 294-294q28-28 68-28t68 28l136 136q28 28 28 68t-28 68l-294 294 294 294q28 28 28 68z" /></symbol>'});r.add(s);e.exports=s},1203:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"hamburger",use:"hamburger-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="hamburger"><path d="M1664 1344v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zm0-512v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zm0-512v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45z" /></symbol>'});r.add(s);e.exports=s},1204:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"erase",use:"erase-usage",viewBox:"0 0 24 24",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" id="erase"><path d="M13.2,3.5L8,8.7l7.2,7.2l5.2-5.2c0.7-0.7,0.7-1.9,0-2.6l-4.6-4.6C15.1,2.8,13.9,2.8,13.2,3.5z" /><path fill="none" stroke="#000000" stroke-width="2" stroke-linejoin="round" stroke-miterlimit="10" d="M11.3,20l9.2-9.2  c0.7-0.7,0.7-1.9,0-2.6l-4.6-4.6c-0.7-0.7-1.9-0.7-2.6,0l-9.7,9.7c-0.7,0.7-0.7,1.9,0,2.6L7.7,20l0,0H22" /></symbol>'});r.add(s);e.exports=s},1205:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"export",use:"export-usage",viewBox:"0 0 16 20",content:'<symbol xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:a="http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/" viewBox="0 0 16 20" overflow="visible" id="export"><switch><foreignObject requiredExtensions="http://ns.adobe.com/AdobeIllustrator/10.0/" x="0" y="0" width="1" height="1"></foreignObject><g i:extraneous="self"><g i:layer="yes" i:dimmedPercent="50" i:rgbTrio="#4F008000FFFF"><path i:knockout="Off" d="M9,0v2h3L7,7l2,2l5-5v3h2V0H9z M14,14H2V2h4V0H0v16h16v-6h-2V14z" /></g></g></switch>\n\x3c!-- <text x="0" y="31" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Tahsin Tahil</text><text x="0" y="36" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});r.add(s);e.exports=s},1206:function(e,t){e.exports='<html>\n  <head>\n    <title>Vega Scaffold</title>\n    <script src="https://vega.github.io/vega-editor/vendor/d3.min.js"><\/script>\n    <script src="https://vega.github.io/vega/vega.min.js"><\/script>\n  </head>\n  <body>\n    <div id="vis"></div>\n  </body>\n  <script type="text/javascript">\n  // parse a spec and create a visualization view\n  function parse(spec) {\n    vg.parse.spec(spec, function(error, chart) {\n      chart({el:"#vis"}).update();\n    });\n  }\n  parse(INJECT_SPEC);\n  <\/script>\n</html>'},1207:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"select",use:"select-usage",viewBox:"0 0 512 512",content:'<symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="select"><g><path d="m106 120c8.284 0 15-6.716 15-15 0-41.355 33.645-75 75-75s75 33.645 75 75c0 8.284 6.716 15 15 15s15-6.716 15-15c0-57.897-47.103-105-105-105s-105 47.103-105 105c0 8.284 6.716 15 15 15z" /><path d="m159.292 510.417c2.083 1.041 4.379 1.583 6.708 1.583h210c3.979 0 7.793-1.58 10.607-4.394 22.179-22.179 34.393-51.667 34.393-83.032v-137.574c0-24.813-20.187-45-45-45-5.857 0-11.449 1.137-16.586 3.181-5.205-19.096-22.691-33.181-43.414-33.181-5.857 0-11.449 1.137-16.586 3.181-5.205-19.096-22.691-33.181-43.414-33.181-5.258 0-10.305.915-15 2.58v-79.58c0-24.813-20.187-45-45-45s-45 20.187-45 45v167h-15c-24.813 0-45 20.187-45 45v82.918c0 22.96 6.38 45.419 18.451 64.949 12.07 19.531 29.305 35.281 49.841 45.55zm-38.292-193.417c0-8.271 6.729-15 15-15h15v64.486c0 8.284 6.716 15 15 15s15-6.716 15-15v-261.486c0-8.271 6.729-15 15-15s15 6.729 15 15v212c0 8.284 6.716 15 15 15s15-6.716 15-15v-90c0-8.271 6.729-15 15-15s15 6.729 15 15v90c0 8.284 6.716 15 15 15s15-6.716 15-15v-60c0-8.271 6.729-15 15-15s15 6.729 15 15v60c0 8.284 6.716 15 15 15s15-6.716 15-15v-30c0-8.271 6.729-15 15-15s15 6.729 15 15v137.574c0 21.337-7.593 41.508-21.499 57.426h-199.824c-30.115-16.423-48.677-47.565-48.677-82.082z" /></g></symbol>'});r.add(s);e.exports=s},1208:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"sort",use:"sort-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="sort"><path d="M1408 1088q0 26-19 45l-448 448q-19 19-45 19t-45-19l-448-448q-19-19-19-45t19-45 45-19h896q26 0 45 19t19 45zm0-384q0 26-19 45t-45 19h-896q-26 0-45-19t-19-45 19-45l448-448q19-19 45-19t45 19l448 448q19 19 19 45z" /></symbol>'});r.add(s);e.exports=s},1209:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"sort-alpha-asc",use:"sort-alpha-asc-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="sort-alpha-asc"><path d="M1255 408h177l-72-218-12-47q-2-16-2-20h-4l-3 20q0 1-3.5 18t-7.5 29zm-455 1032q0 12-10 24l-319 319q-10 9-23 9-12 0-23-9l-320-320q-15-16-7-35 8-20 30-20h192v-1376q0-14 9-23t23-9h192q14 0 23 9t9 23v1376h192q14 0 23 9t9 23zm836 119v233h-584v-90l369-529q12-18 21-27l11-9v-3q-2 0-6.5.5t-7.5.5q-12 3-30 3h-232v115h-120v-229h567v89l-369 530q-6 8-21 26l-11 11v2l14-2q9-2 30-2h248v-119h121zm89-897v106h-288v-106h75l-47-144h-243l-47 144h75v106h-287v-106h70l230-662h162l230 662h70z" /></symbol>'});r.add(s);e.exports=s},1210:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"sort-alpha-desc",use:"sort-alpha-desc-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="sort-alpha-desc"><path d="M1255 1432h177l-72-218-12-47q-2-16-2-20h-4l-3 20q0 1-3.5 18t-7.5 29zm-455 8q0 12-10 24l-319 319q-10 9-23 9-12 0-23-9l-320-320q-15-16-7-35 8-20 30-20h192v-1376q0-14 9-23t23-9h192q14 0 23 9t9 23v1376h192q14 0 23 9t9 23zm925 246v106h-288v-106h75l-47-144h-243l-47 144h75v106h-287v-106h70l230-662h162l230 662h70zm-89-1151v233h-584v-90l369-529q12-18 21-27l11-9v-3q-2 0-6.5.5t-7.5.5q-12 3-30 3h-232v115h-120v-229h567v89l-369 530q-6 8-21 26l-11 10v3l14-3q9-1 30-1h248v-119h121z" /></symbol>'});r.add(s);e.exports=s},1211:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"sort-numeric-asc",use:"sort-numeric-asc-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="sort-numeric-asc"><path d="M1474 1313q0-63-44-116t-103-53q-52 0-83 37t-31 94 36.5 95 104.5 38q50 0 85-27t35-68zm-610 127q0 12-10 24l-319 319q-10 9-23 9-12 0-23-9l-320-320q-15-16-7-35 8-20 30-20h192v-1376q0-14 9-23t23-9h192q14 0 23 9t9 23v1376h192q14 0 23 9t9 23zm750-69q0 62-13 121.5t-41 114-68 95.5-98.5 65.5-127.5 24.5q-62 0-108-16-24-8-42-15l39-113q15 7 31 11 37 13 75 13 84 0 134.5-58.5t66.5-145.5h-2q-21 23-61.5 37t-84.5 14q-106 0-173-71.5t-67-172.5q0-105 72-178t181-73q123 0 205 94.5t82 252.5zm-30-717v114h-469v-114h167v-432q0-7 .5-19t.5-17v-16h-2l-7 12q-8 13-26 31l-62 58-82-86 192-185h123v654h165z" /></symbol>'});r.add(s);e.exports=s},1212:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"sort-numeric-desc",use:"sort-numeric-desc-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="sort-numeric-desc"><path d="M1474 289q0-63-44-116t-103-53q-52 0-83 37t-31 94 36.5 95 104.5 38q50 0 85-27t35-68zm-610 1151q0 12-10 24l-319 319q-10 9-23 9-12 0-23-9l-320-320q-15-16-7-35 8-20 30-20h192v-1376q0-14 9-23t23-9h192q14 0 23 9t9 23v1376h192q14 0 23 9t9 23zm720 238v114h-469v-114h167v-432q0-7 .5-19t.5-17v-16h-2l-7 12q-8 13-26 31l-62 58-82-86 192-185h123v654h165zm30-1331q0 62-13 121.5t-41 114-68 95.5-98.5 65.5-127.5 24.5q-62 0-108-16-24-8-42-15l39-113q15 7 31 11 37 13 75 13 84 0 134.5-58.5t66.5-145.5h-2q-21 23-61.5 37t-84.5 14q-106 0-173-71.5t-67-172.5q0-105 72-178t181-73q123 0 205 94.5t82 252.5z" /></symbol>'});r.add(s);e.exports=s},1213:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"filter",use:"filter-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="filter"><path d="M1595 295q17 41-14 70l-493 493v742q0 42-39 59-13 5-25 5-27 0-45-19l-256-256q-19-19-19-45v-486l-493-493q-31-29-14-70 17-39 59-39h1280q42 0 59 39z" /></symbol>'});r.add(s);e.exports=s},1214:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"formula",use:"formula-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="formula"><path d="M384 1536q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm384 0q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm-384-384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm768 384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm-384-384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm-384-384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm768 384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm-384-384q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm768 768v-384q0-52-38-90t-90-38-90 38-38 90v384q0 52 38 90t90 38 90-38 38-90zm-384-768q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm384-320v-256q0-26-19-45t-45-19h-1280q-26 0-45 19t-19 45v256q0 26 19 45t45 19h1280q26 0 45-19t19-45zm0 320q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm128-640v1536q0 52-38 90t-90 38h-1408q-52 0-90-38t-38-90v-1536q0-52 38-90t90-38h1408q52 0 90 38t38 90z" /></symbol>'});r.add(s);e.exports=s},1215:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"aggregate",use:"aggregate-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="aggregate"><path d="M576 736v192q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h192q40 0 68 28t28 68zm512 0v192q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h192q40 0 68 28t28 68zm512 0v192q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h192q40 0 68 28t28 68z" /></symbol>'});r.add(s);e.exports=s},1216:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"download",use:"download-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="download"><path d="M1344 1344q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm256 0q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm128-224v320q0 40-28 68t-68 28h-1472q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h465l135 136q58 56 136 56t136-56l136-136h464q40 0 68 28t28 68zm-325-569q17 41-14 70l-448 448q-18 19-45 19t-45-19l-448-448q-31-29-14-70 17-39 59-39h256v-448q0-26 19-45t45-19h256q26 0 45 19t19 45v448h256q42 0 59 39z" /></symbol>'});r.add(s);e.exports=s},1217:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"bold",use:"bold-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="bold"><path d="M747 1521q74 32 140 32 376 0 376-335 0-114-41-180-27-44-61.5-74t-67.5-46.5-80.5-25-84-10.5-94.5-2q-73 0-101 10 0 53-.5 159t-.5 158q0 8-1 67.5t-.5 96.5 4.5 83.5 12 66.5zm-14-746q42 7 109 7 82 0 143-13t110-44.5 74.5-89.5 25.5-142q0-70-29-122.5t-79-82-108-43.5-124-14q-50 0-130 13 0 50 4 151t4 152q0 27-.5 80t-.5 79q0 46 1 69zm-541 889l2-94q15-4 85-16t106-27q7-12 12.5-27t8.5-33.5 5.5-32.5 3-37.5.5-34v-65.5q0-982-22-1025-4-8-22-14.5t-44.5-11-49.5-7-48.5-4.5-30.5-3l-4-83q98-2 340-11.5t373-9.5q23 0 68.5.5t67.5.5q70 0 136.5 13t128.5 42 108 71 74 104.5 28 137.5q0 52-16.5 95.5t-39 72-64.5 57.5-73 45-84 40q154 35 256.5 134t102.5 248q0 100-35 179.5t-93.5 130.5-138 85.5-163.5 48.5-176 14q-44 0-132-3t-132-3q-106 0-307 11t-231 12z" /></symbol>'});r.add(s);e.exports=s},1218:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"italic",use:"italic-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="italic"><path d="M384 1662l17-85q6-2 81.5-21.5t111.5-37.5q28-35 41-101 1-7 62-289t114-543.5 52-296.5v-25q-24-13-54.5-18.5t-69.5-8-58-5.5l19-103q33 2 120 6.5t149.5 7 120.5 2.5q48 0 98.5-2.5t121-7 98.5-6.5q-5 39-19 89-30 10-101.5 28.5t-108.5 33.5q-8 19-14 42.5t-9 40-7.5 45.5-6.5 42q-27 148-87.5 419.5t-77.5 355.5q-2 9-13 58t-20 90-16 83.5-6 57.5l1 18q17 4 185 31-3 44-16 99-11 0-32.5 1.5t-32.5 1.5q-29 0-87-10t-86-10q-138-2-206-2-51 0-143 9t-121 11z" /></symbol>'});r.add(s);e.exports=s},1219:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"open",use:"open-usage",viewBox:"10 25 80 50",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="10 25 80 50" id="open"><title>12.5</title><desc>Created with Sketch.</desc><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><path d="M84.3765045,45.2316481 L77.2336539,75.2316205 L77.2336539,75.2316205 C77.1263996,75.6820886 76.7239081,76 76.2608477,76 L17.8061496,76 C17.2538649,76 16.8061496,75.5522847 16.8061496,75 C16.8061496,74.9118841 16.817796,74.8241548 16.8407862,74.739091 L24.7487983,45.4794461 C24.9845522,44.607157 25.7758952,44.0012839 26.6794815,44.0012642 L83.4036764,44.0000276 L83.4036764,44.0000276 C83.9559612,44.0000156 84.4036862,44.4477211 84.4036982,45.0000058 C84.4036999,45.0780163 84.3945733,45.155759 84.3765045,45.2316481 L84.3765045,45.2316481 Z M15,24 L26.8277004,24 L26.8277004,24 C27.0616369,24 27.2881698,24.0820162 27.4678848,24.2317787 L31.799078,27.8411064 L31.799078,27.8411064 C32.697653,28.5899189 33.8303175,29 35,29 L75,29 C75.5522847,29 76,29.4477153 76,30 L76,38 L76,38 C76,38.5522847 75.5522847,39 75,39 L25.3280454,39 L25.3280454,39 C23.0690391,39 21.0906235,40.5146929 20.5012284,42.6954549 L14.7844016,63.8477139 L14.7844016,63.8477139 C14.7267632,64.0609761 14.5071549,64.1871341 14.2938927,64.1294957 C14.1194254,64.0823423 13.9982484,63.9240598 13.9982563,63.7433327 L13.9999561,25 L14,25 C14.0000242,24.4477324 14.4477324,24.0000439 15,24.0000439 L15,24 Z" /></g></g>\n\x3c!-- <text x="0" y="115" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Landan Lloyd</text><text x="0" y="120" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});r.add(s);e.exports=s},1220:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"save",use:"save-usage",viewBox:"0 0 362 372.5",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 362 372.5" fill-rule="evenodd" id="save"><g><path class="fil0" d="M24 0l54 0 0 114 206 0 0 -114 27 0 51 55 0 284c0,13 -10,23 -23,23l-315 0c-13,0 -24,-10 -24,-23l0 -315c0,-13 11,-24 24,-24zm24 152l266 0 0 189 -266 0 0 -189z" /><rect class="fil0" x="208" y="1" width="50.8754" height="78.352" /><rect class="fil0" x="79" y="181" width="204.238" height="22.2849" /><rect class="fil0" x="79" y="238" width="204.238" height="22.2849" /><rect class="fil0" x="79" y="294" width="204.238" height="22.2849" /></g>\n\x3c!-- <text x="0" y="377" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Ghiyats Mujtaba</text><text x="0" y="382" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});r.add(s);e.exports=s},1221:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"align-left",use:"align-left-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="align-left"><path d="M1792 1344v128q0 26-19 45t-45 19h-1664q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1664q26 0 45 19t19 45zm-384-384v128q0 26-19 45t-45 19h-1280q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1280q26 0 45 19t19 45zm256-384v128q0 26-19 45t-45 19h-1536q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1536q26 0 45 19t19 45zm-384-384v128q0 26-19 45t-45 19h-1152q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1152q26 0 45 19t19 45z" /></symbol>'});r.add(s);e.exports=s},1222:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"align-center",use:"align-center-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="align-center"><path d="M1792 1344v128q0 26-19 45t-45 19h-1664q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1664q26 0 45 19t19 45zm-384-384v128q0 26-19 45t-45 19h-896q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h896q26 0 45 19t19 45zm256-384v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zm-384-384v128q0 26-19 45t-45 19h-640q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h640q26 0 45 19t19 45z" /></symbol>'});r.add(s);e.exports=s},1223:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"align-right",use:"align-right-usage",viewBox:"0 0 1792 1792",content:'<symbol viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" id="align-right"><path d="M1792 1344v128q0 26-19 45t-45 19h-1664q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1664q26 0 45 19t19 45zm0-384v128q0 26-19 45t-45 19h-1280q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1280q26 0 45 19t19 45zm0-384v128q0 26-19 45t-45 19h-1536q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1536q26 0 45 19t19 45zm0-384v128q0 26-19 45t-45 19h-1152q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1152q26 0 45 19t19 45z" /></symbol>'});r.add(s);e.exports=s},1224:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"vertical-align-bottom",use:"vertical-align-bottom-usage",viewBox:"0 0 100 125",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 125" id="vertical-align-bottom"><path d="M100,95.833V4.167C100,0,100,0,95.833,0H4.167C0,0,0,0,0,4.167v91.667C0,100,0,100,4.167,100h91.667  C100,100,100,100,100,95.833z M70.833,58.333L50,83.333l-20.833-25H70.833z M43.75,0h12.5v58.333h-12.5V0z" />\n\x3c!-- <text x="0" y="115" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Thomas Helbig</text><text x="0" y="120" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});r.add(s);e.exports=s},1225:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"vertical-align-center",use:"vertical-align-center-usage",viewBox:"0 0 100 125",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 125" id="vertical-align-center"><path d="M100,95.833V4.167C100,0,100,0,95.833,0H4.167C0,0,0,0,0,4.167v91.667C0,100,0,100,4.167,100h91.667  C100,100,100,100,100,95.833z M70.833,20.833L50,45.833l-20.833-25H70.833z M70.833,79.167H29.167l20.833-25L70.833,79.167z   M43.75,0h12.5v20.833h-12.5V0z M56.25,100h-12.5V79.167h12.5V100z" />\n\x3c!-- <text x="0" y="115" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Thomas Helbig</text><text x="0" y="120" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});r.add(s);e.exports=s},1226:function(e,t,n){var a=n(37),r=n(38),s=new a({id:"vertical-align-top",use:"vertical-align-top-usage",viewBox:"0 0 100 125",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 125" id="vertical-align-top"><path d="M100,95.833V4.167C100,0,100,0,95.833,0H4.167C0,0,0,0,0,4.167v91.667C0,100,0,100,4.167,100h91.667  C100,100,100,100,100,95.833z M56.25,100h-12.5V41.667h12.5V100z M70.833,41.667H29.167l20.833-25L70.833,41.667z" />\n\x3c!-- <text x="0" y="115" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">Created by Thomas Helbig</text><text x="0" y="120" fill="#000000" font-size="5px" font-weight="bold" font-family="\'Helvetica Neue\', Helvetica, Arial-Unicode, Arial, Sans-serif">from the Noun Project</text> --\x3e\n</symbol>'});r.add(s);e.exports=s},1227:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(226),i=n(92),o=n(67),l=n(87),c=n(40).getInVis,p=n(314),d=n(88);t.default=r.connect(function(e,t){return{marks:c(e,"marks."+t.groupId+".marks").map(function(t){return c(e,"marks."+t)})}},function(e,t){return{selectMark:function(t){e(i.selectMark(t))},deleteMark:function(n,a,r){n===a&&e(i.selectMark(t.groupId)),e(o.deleteMark(a)),r.preventDefault(),r.stopPropagation(),s.default.hide()},updateName:function(t,n){e(o.updateMarkProperty({property:"name",value:n},t))}}})(class extends a.Component{componentDidUpdate(){s.default.rebuild()}render(){const e=this.props,t=e.selectedId,n=e.selectedType;return a.createElement("div",null,a.createElement("li",{className:"header"},"Marks "),e.marks.map(function(r){if(!r)return;const s=r._id,o=r.name;return a.createElement("li",{key:s},a.createElement("div",{className:"name"+(t===s&&n===i.InspectorSelectedType.SELECT_MARK?" selected":""),onClick:e.selectMark.bind(null,s)},a.createElement(l.Icon,{glyph:d[r.type]}),a.createElement(p,{value:o,save:e.updateName.bind(null,s),onClick:e.selectMark.bind(null,s)}),a.createElement(l.Icon,{glyph:d.trash,className:"delete",onClick:e.deleteMark.bind(null,t,s),"data-tip":"Delete "+o,"data-place":"right"})))},this))}})},1231:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(226),i=n(92),o=n(87),l=n(372),c=n(158),p=n(157),d=n(314),u=n(88),m=n(72);t.default=r.connect(function(e,t){const n=p.getScaleInfoForGroup(e,t.groupId),a=e.getIn(["vega","isParsing"]),r=Boolean(!a&&m.view&&(n.xScaleName&&n.xFieldName||n.yScaleName&&n.yFieldName)),s=e.getIn(["vis","present","marks",String(t.groupId),"_interactions"]);return{interactions:s?s.map(function(t){return e.getIn(["vis","present","interactions",String(t)])}):[],canDemonstrate:r}},function(e){return{addInteraction:t=>{const n=l.Interaction({groupId:t});e(c.addInteraction(n))},selectInteraction:function(t){e(i.selectInteraction(t))},deleteInteraction:function(t,n,a,r){t===a&&e(i.selectMark(n)),e(c.deleteInteraction({groupId:n},a)),r.preventDefault(),r.stopPropagation(),s.default.hide()},updateName:function(t,n){e(c.updateInteractionName(n,t))}}})(class extends a.Component{componentDidUpdate(){s.default.rebuild()}render(){const e=this.props,t=e.selectedId,n=e.selectedType;return a.createElement("div",{className:"interaction-list"},a.createElement("li",{className:"header"},"Interactions ",this.props.canDemonstrate?a.createElement(o.Icon,{glyph:u.plus,onClick:()=>this.props.addInteraction(this.props.groupId)}):null),e.interactions.map(function(r){const s=r.id,l=r.name;return a.createElement("li",{key:s},a.createElement("div",{className:"name"+(t===s&&n===i.InspectorSelectedType.SELECT_INTERACTION?" selected":""),onClick:e.selectInteraction.bind(null,s)},a.createElement(o.Icon,{glyph:u.select}),a.createElement(d,{value:l,save:e.updateName.bind(null,s),onClick:e.selectInteraction.bind(null,s)}),a.createElement(o.Icon,{glyph:u.trash,className:"delete",onClick:e.deleteInteraction.bind(null,t,this.props.groupId,s),"data-tip":"Delete "+l,"data-place":"right"})))},this))}})},1232:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(226),i=n(92),o=n(87),l=n(225),c=n(157),p=n(314),d=n(88),u=n(72);t.default=r.connect(function(e,t){const n=c.getScaleInfoForGroup(e,t.groupId),a=e.getIn(["vega","isParsing"]),r=Boolean(!a&&u.view&&(n.xScaleName&&n.xFieldName||n.yScaleName&&n.yFieldName)),s=e.getIn(["vis","present","marks",String(t.groupId),"_widgets"]);return{widgets:s?s.map(function(t){return e.getIn(["vis","present","widgets",String(t)])}):[],canDemonstrate:r}},function(e){return{selectWidget:function(t){e(i.selectWidget(t))},deleteWidget:function(t,n,a,r){t===a&&e(i.selectMark(n)),e(l.deleteWidget({groupId:n},a)),r.preventDefault(),r.stopPropagation(),s.default.hide()},updateName:function(t,n){e(l.updateWidgetName(n,t))}}})(class extends a.Component{componentDidUpdate(){s.default.rebuild()}render(){const e=this.props,t=e.selectedId,n=e.selectedType;return a.createElement("div",{className:"interaction-list"},a.createElement("li",{className:"header"},"Widgets"),e.widgets.map(function(r){const s=r.id,l=r.name;return a.createElement("li",{key:s},a.createElement("div",{className:"name"+(t===s&&n===i.InspectorSelectedType.SELECT_WIDGET?" selected":""),onClick:e.selectWidget.bind(null,s)},a.createElement(o.Icon,{glyph:d.select}),a.createElement(p,{value:l,save:e.updateName.bind(null,s),onClick:e.selectWidget.bind(null,s)}),a.createElement(o.Icon,{glyph:d.trash,className:"delete",onClick:e.deleteWidget.bind(null,t,this.props.groupId,s),"data-tip":"Delete "+l,"data-place":"right"})))},this))}})},1233:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(92),i=n(267),o=n(376),l=n(90),c=n(268),p=n(92),d=n(67),u=n(23),m=n(72),g=n(40).getInVis;const h={startDragging:p.startDragging,stopDragging:p.stopDragging,selectScale:s.selectScale,setMarkVisual:d.setMarkVisual};t.default=r.connect(function(e,t){const n=e.getIn(["inspector","dragging"]),a=n&&n.scaleId?n:null;return{selectedId:e.getIn(["inspector","encodings","selectedId"]),scales:g(e,"scales"),dragging:a}},h)(class extends a.Component{constructor(){super(...arguments),this.handleDragStart=(e=>{const t=e.target.dataset.scale,n=e.target.dataset.field;this.props.startDragging(c.ScaleDraggingState({scaleId:t,fieldName:n})),i.default.set(l.MODE,"channels"),m.update()}),this.handleDragEnd=(()=>{const e=i.default.get(l.SELECTED),t=i.default.get(l.CELL),n=u.tupleid(e)&&u.tupleid(t);try{if(n){const n=+e.mark.role.split("lyra_")[1],a=o.channelName(t.key);this.props.setMarkVisual({property:a,def:{scale:this.props.dragging.scaleId,field:this.props.dragging.fieldName}},n)}}catch(e){console.error("Unable to bind primitive"),console.error(e)}this.props.stopDragging(),i.default.set(l.MODE,"handles"),i.default.set(l.CELL,{}),n||m.update()})}render(){const e=this.props,t=[...e.scales.values()];return a.createElement("div",{id:"scale-list"},a.createElement("h2",null,"Scales"),a.createElement("ul",null,t.map(t=>{const n=t.get("_id"),r=t.get("name"),s=t.get("_domain")&&t.get("_domain").length?t.get("_domain")[0].field:null;return a.createElement("li",{key:n,onClick:e.selectScale.bind(null,n)},a.createElement("div",{draggable:!0,className:e.selectedId===n?"selected scale name":"scale name",onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,"data-scale":t.get("_id"),"data-field":s},r))},this)))}})},1234:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(47),i=n(92),o=n(879),l=n(1235),c=n(1240),p=n(1243),d=n(1244),u=n(1247),m=n(1248),g=n(1253),h=n(1257),f=n(1258),y={AreaInspector:l.AreaInspector,GuideInspector:c.GuideInspector,LineInspector:p.LineInspector,RectInspector:d.RectInspector,ScaleInspector:u.ScaleInspector,SymbolInspector:h.SymbolInspector,TextInspector:f.TextInspector,InteractionInspector:m.InteractionInspector,WidgetInspector:g.WidgetInspector,GroupInspector:d.RectInspector},v=n(370),_=n(40).getInVis;t.InspectorSidebar=r.connect(function(e,t){const n=e.getIn(["inspector","encodings"]),a=n.get("selectedId"),r=n.get("selectedType"),o=r===s.getType(i.baseSelectMark),l=r===s.getType(i.selectGuide),c=r===s.getType(i.selectScale),p=r===s.getType(i.selectInteraction),d=r===s.getType(i.selectWidget),u=o?_(e,`marks.${a}`):l?_(e,`guides.${a}`):c?_(e,`scales.${a}`):p?_(e,`interactions.${a}`):d?_(e,`widgets.${a}`):null;let m,g=[];return o&&(g=(g=[...(g=_(e,"interactions")).values()]).filter(e=>u._parent==e.get("groupId")).map(e=>e.get("name"))),u&&u.from&&u.from.data&&(m=_(e,"pipelines."+_(e,"datasets."+u.from.data).get("_parent")).get("name")),{selectedId:a,isMark:o,isGuide:l,isScale:c,isInteraction:p,isWidget:d,name:u&&u.get("name"),from:m,markType:u&&u.get("type"),guideType:u&&u.get("_gtype"),interactionList:g}})(class extends a.Component{render(){const e=this.props,t=e.selectedId,n=e.from;let r,s,i;t&&(e.isMark&&e.markType?(r=v(e.markType),s=o.PrimType.MARKS):e.isGuide?(r="Guide",s=o.PrimType.GUIDES):e.isScale?(r="Scale",s=o.PrimType.SCALES):e.isInteraction?(r="Interaction",s=o.PrimType.INTERACTIONS):e.isWidget&&(r="Widget",s=o.PrimType.WIDGETS),i=y[r+"Inspector"]);const l=e.isMark?a.createElement("div",{className:"property-group property"},a.createElement("h3",{className:"label-long"},"Pipeline"),a.createElement("div",{className:"control"},n||"None")):null,c=this.props.interactionList.length&&e.isMark?a.createElement("div",{className:"property-group"},a.createElement("h3",{className:"label-long"},"Interactions"),a.createElement("div",{className:"property"},this.props.interactionList.length?this.props.interactionList.map(e=>a.createElement("span",{key:e,className:"interaction name"},e)):null)):null,p=i?a.createElement("div",{className:"inner"},l,a.createElement(i,{primId:t,primType:s,guideType:e.guideType}),c):null,d=e.name||"Properties";return a.createElement("div",{className:"sidebar",id:"inspector"},a.createElement("h2",null,d),p)}})},1235:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(880),r=n(17),s=n(35),i=n(140);t.AreaInspector=s.connect()(class extends r.Component{render(){const e=this.props;return r.createElement("div",null,r.createElement(i.Property,Object.assign({name:"x",type:"number",droppable:!0},e),r.createElement("h3",{className:"label"},"X Position")),r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Y Position"),r.createElement(i.Property,Object.assign({name:"y",label:"Start",type:"number",droppable:!0},e)),r.createElement(i.Property,Object.assign({name:"y2",label:"End",type:"number",droppable:!0},e))),r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Fill"),r.createElement(i.Property,Object.assign({name:"fill",label:"Color",type:"color",droppable:!0},e)),r.createElement(i.Property,Object.assign({name:"fillOpacity",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05",droppable:!0},e))),r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Stroke"),r.createElement(i.Property,Object.assign({name:"stroke",label:"Color",type:"color",droppable:!0},e)),r.createElement(i.Property,Object.assign({name:"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25",droppable:!0},e))),r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Line Strength"),r.createElement(i.Property,Object.assign({name:"interpolate",label:"Interpolate",type:"select",opts:a,droppable:!0},e)),r.createElement(i.Property,Object.assign({name:"tension",label:"Tension",type:"number",droppable:!0},e))))}})},1236:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(40).getInVis,r='<span class="',s='<span class="field source" contenteditable="false">',i='<span class="signal" contenteditable="false">',o="</span>",l="datum.",c="#",p="{{",d="}}",u=new RegExp(p+".*"+d),m=new RegExp("("+s+"|"+i+").*"+o),g=n(17),h=n(1237),f=n(378),y=n(35),v=n(67),_=n(158);t.AutoComplete=y.connect(function(e,t){const n=a(e,"datasets."+t.dsId+"._schema"),r=e.getIn(["vis","present","interactions"]).valueSeq().toArray(),s=[].concat.apply([],r.filter(e=>e.signals.length).map(e=>e.signals.map(e=>e.signal))),i=e.getIn(["vis","present","widgets"]).valueSeq().toArray(),o=[].concat.apply([],i.filter(e=>e.signals.length).map(e=>e.signals.map(e=>e.signal)));return{fields:n?n.keySeq().toJS():[],signals:s.concat(o),dragging:e.getIn(["inspector","dragging"])}},function(e,t){return{setDsId(n){e(v.updateMarkProperty({property:"from",value:{data:n}},t.primId))},setSignalPush(t,n,a){e(_.setSignalPush({[t]:n},a))}}})(class extends g.Component{constructor(e){super(e),this.handleChange=(e=>{const t=e.target.value||e.target.innerHTML||"";this.props.updateFn(this.fromHtml(t)),this.setState({html:t})}),this.handleDragOver=(e=>(e.preventDefault&&e.preventDefault(),!1)),this.handleDrop=(e=>{const t=this.props;let n=t.dragging;if(n.dsId){const e=(n=n).fieldDef.name,a="Text"===this.state.html?"":this.state.html,r=this.htmlDecode(a);let i=r.indexOf(window.getSelection().anchorNode.textContent);i=(i=i>-1?i+window.getSelection().anchorOffset:r.length)>r.length?r.length:i;const l=r.substring(0,i)+s+e+o+r.substring(i);console.log(l),!t.dsId&&n.dsId&&"marks"===t.primType&&t.setDsId(n.dsId),t.updateFn(this.fromHtml(l)),this.setState({html:l})}else if(n.signal){(n=n).interactionId&&this.props.setSignalPush(n.signal,!0,n.interactionId);const e=n.signal,a="Text"===this.state.html?"":this.state.html,r=this.htmlDecode(a);let s=r.indexOf(window.getSelection().anchorNode.textContent);s=(s=s>-1?s+window.getSelection().anchorOffset:r.length)>r.length?r.length:s;const l=r.substring(0,s)+i+e+o+r.substring(s);t.updateFn(this.fromHtml(l)),this.setState({html:l})}}),this.state={html:this.toHtml(e.value||"")}}componentDidUpdate(e){this.props.dsId!==e.dsId&&this.props.updateFn(this.fromHtml(this.state.html)),this.props.value!==e.value&&this.setState({html:this.toHtml(this.props.value||"")})}componentDidMount(){f.findDOMNode(this),this.handleChange,this.props.fields}toHtml(e){return"expr"===this.props.type?this.exprToHtml(e):this.tmplToHtml(e)}fromHtml(e){return"expr"===this.props.type?this.htmlToExpr(e):this.htmlToTmpl(e)}exprToHtml(e){const t=this.props.fields,n=this.props.signals,a=new RegExp(t.map(e=>l+e).join("|"),"g"),r=new RegExp(n.join("|"),"g");return e=(e=e.replace(a,e=>e?s+e.substring(l.length)+o:e)).replace(r,e=>e?i+e+o:e)}htmlToExpr(e){return this.htmlDecode(this.wrapTokensExpr(this.htmlToTokens(e)))}tmplToHtml(e){const t=[];let n=e,a=n.search(u);for(;-1!==a;){t.push({type:"literal",str:n.substring(0,a)});const e=a+p.length,r=n.substring(e),s=r.search(d);r.startsWith(c)?t.push({type:"signal",str:r.substring(c.length,s)}):r.startsWith(l)&&t.push({type:"field",str:r.substring(l.length,s)}),a=(n=r.substring(s+d.length)).search(u)}return t.push({type:"literal",str:n}),this.wrapTokensHtml(t)}htmlToTokens(e){const t=[];let n=e,a=n.search(m);for(;-1!==a;){t.push({type:"literal",str:n.substring(0,a)});const e=a+r.length,l=n.substring(e),c=l.search(o);l.startsWith("signal")?t.push({type:"signal",str:l.substring(i.length-r.length,c)}):l.startsWith("field")&&t.push({type:"field",str:l.substring(s.length-r.length,c)}),a=(n=l.substring(c+o.length)).search(m)}return t.push({type:"literal",str:n}),t}htmlToTmpl(e){return this.htmlDecode(this.wrapTokensTmpl(this.htmlToTokens(e)))}wrapTokensHtml(e){return e.map(e=>"field"===e.type?s+e.str+o:"signal"===e.type?i+e.str+o:e.str).join("")}wrapTokensExpr(e){return e.map(e=>"field"===e.type?l+e.str:e.str).join("")}wrapTokensTmpl(e){return e.map(e=>"field"===e.type?p+l+e.str+d:"signal"===e.type?p+c+e.str+d:e.str).join("")}htmlDecode(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}render(){return g.createElement("div",{onDragOver:this.handleDragOver,onDrop:this.handleDrop},g.createElement(h.default,{className:"autocomplete",html:this.state.html,disabled:!1,onChange:this.handleChange}))}})},1239:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(314),r=n(40).getInVis,s=n(72),i=n(17),o=n(35),l=n(266),c=n(310),p=n(267),d=n(87);t.FormInputProperty=o.connect(function(e,t){const n=t.signal;return n?{value:r(e,"signals."+n+".value")}:{value:t.value}},function(e,t){const n=t.signal;return{setSignal:function(t){n&&e(l.setSignal(t,n))}}})(class extends i.Component{constructor(e){super(e),this.signal=((e,t)=>{this.props.setSignal(t),this.setState({value:t})}),this.state={value:e.value}}componentWillMount(){this.onSignal(!1)}componentWillReceiveProps(e){const t=this.props,n=t.signal,a=e.signal;n!==a&&(this.offSignal(n),a&&this.onSignal(a)),(a||e.value!==t.value)&&this.setState({value:a&&a.startsWith("lyra")?p.default.get(a):e.value})}componentWillUnmount(){this.offSignal(!1)}onSignal(e){(e=e||this.props.signal)&&c.onSignal(e,this.signal)}offSignal(e){(e=e||this.props.signal)&&c.offSignal(e,this.signal)}handleChange(e){const t=this.props,n=t.type,a=t.signal;let r=e.target?e.target.value:e;"number"!==n&&"range"!==n||(r=+r),a&&(p.default.set(a,r,!1),s.update()),this.setState({value:r})}colorSupport(){const e=document.createElement("input");return e.setAttribute("type","color"),"text"!==e.type}render(){const e=this.props,t=e.name,n=e.id,r=e.min,s=e.max,o=e.disabled||e.group,l=o?"":this.state.value,c=e.onChange||this.handleChange.bind(this),p=e.onBlur,u=this.colorSupport();switch(e.type){case"checkbox":return i.createElement("input",{id:n,name:t,type:"checkbox",checked:l,disabled:o,onChange:c,onBlur:p});case"text":return i.createElement("input",{id:n,name:t,type:"text",value:l,disabled:o,onChange:c,onBlur:p});case"number":return i.createElement("input",{id:n,name:t,type:"number",value:l,min:r,max:s,disabled:o,onChange:c,onBlur:p});case"range":return i.createElement("div",null,i.createElement("input",{id:n,name:t,type:"range",value:l,min:r,max:s,step:e.step,disabled:o,onChange:c,onBlur:p}),i.createElement(a,{value:l,save:c}));case"color":return i.createElement("div",null,i.createElement("input",{id:n,name:t,type:u?"color":"text",value:l,disabled:o,onChange:c,onBlur:p}),u?i.createElement(a,{value:l,save:c}):null);case"select":return i.createElement("select",{id:n,name:t,value:l,disabled:o,onChange:c,onBlur:p},e.opts.map(function(e){return i.createElement("option",{key:e,value:e},e)},this));case"toggle":const m=e.opts.find(function(e){return e!==l});return i.createElement("div",null,i.createElement("button",{type:"button",id:n,className:(l===e.opts[0]?"":"button-secondary ")+"button",onClick:c.bind(this,m)},i.createElement(d.Icon,{glyph:e.glyph})));case"selection":return i.createElement("div",null,e.opts.map(function(t,a){return i.createElement("button",{key:t,type:"button",id:n,className:(l===t?"button-secondary ":"")+"button",onClick:c.bind(this,t)},i.createElement(d.Icon,{glyph:e.glyphs[a]}))},this));default:return null}}})},1240:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(1241),i=n(1242),o=n(308),l=n(201);t.GuideInspector=r.connect(function(e,t){return{}},function(e){return{updateGuideProperty:function(t,n,a){e(l.updateGuideProperty({property:n,value:a},t))}}})(class extends a.Component{handleChange(e){const t=this.props.primId,n=e.target,a=n.name;let r="checkbox"===n.type?n.checked:n.value;r=""===r||isNaN(+r)?r:+r,this.props.updateGuideProperty(t,a,r)}render(){const e=this.props,t=e.guideType;return t===o.GuideType.Axis?a.createElement(s.AxisInspector,Object.assign({},e,{handleChange:e=>this.handleChange(e)})):t===o.GuideType.Legend?a.createElement(i.LegendInspector,Object.assign({},e,{handleChange:e=>this.handleChange(e)})):null}})},1241:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(881),i=n(140);t.AxisInspector=r.connect()(class extends a.Component{render(){const e=this.props,t=e.handleChange,n="properties.axis.",r="properties.title.",o="properties.labels.",l="properties.grid.",c="properties.ticks.";return a.createElement("div",null,a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Axis"),a.createElement(i.Property,Object.assign({name:"orient",label:"Orient",type:"select",opts:["top","bottom","left","right"],onChange:t},e)),a.createElement(s.MoreProperties,{label:"Axis"},a.createElement(i.Property,Object.assign({name:n+"stroke",label:"Color",type:"color"},e)),a.createElement(i.Property,Object.assign({name:n+"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25"},e)))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Title"),a.createElement(i.Property,Object.assign({name:"title",label:"Text",type:"text",onChange:t},e)),a.createElement(i.Property,Object.assign({name:r+"fontSize",label:"Font Size",type:"number"},e)),a.createElement(s.MoreProperties,{label:"Title"},a.createElement(i.Property,Object.assign({name:r+"fill",label:"Color",type:"color"},e)),a.createElement(i.Property,Object.assign({name:"titleOffset",label:"Offset",type:"number",onChange:t},e)))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Labels"),a.createElement(i.Property,Object.assign({name:o+"fontSize",label:"Font Size",type:"number"},e)),a.createElement(i.Property,Object.assign({name:o+"angle",label:"Angle",type:"number",min:"0",max:"360"},e)),a.createElement(s.MoreProperties,{label:"Label"},a.createElement(i.Property,Object.assign({name:o+"fill",label:"Fill",type:"color"},e)))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Grid"),a.createElement(i.Property,Object.assign({name:"grid",label:"Grid",type:"checkbox",onChange:t},e)),a.createElement(i.Property,Object.assign({name:"layer",label:"Layer",type:"select",opts:["back","front"],onChange:t},e)),a.createElement(s.MoreProperties,{label:"Grid"},a.createElement(i.Property,Object.assign({name:l+"stroke",label:"Color",type:"color"},e)),a.createElement(i.Property,Object.assign({name:l+"strokeOpacity",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05"},e)),a.createElement(i.Property,Object.assign({name:l+"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25"},e)))),a.createElement("div",{className:"property-group last"},a.createElement(s.MoreProperties,{label:"Ticks",header:"true"},a.createElement(i.Property,Object.assign({name:"ticks",label:"Number of Ticks",type:"number",onChange:t},e)),a.createElement(i.Property,Object.assign({name:c+"stroke",label:"Color",type:"color"},e)),a.createElement(i.Property,Object.assign({name:c+"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25"},e)),a.createElement(i.Property,Object.assign({name:"tickPadding",label:"Padding",type:"range",onChange:t},e)),a.createElement(i.Property,Object.assign({name:"tickSize",label:"Size",type:"number",onChange:t},e)))))}})},1242:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(40).getInVis,r=n(17),s=n(35),i=n(881),o=n(140),l=n(422);t.LegendInspector=s.connect(function(e,t){const n=a(e,"guides."+t.primId),r=n.get("_type");return{legendType:r,scaleType:a(e,"scales."+n.get(r)).get("type")}})(class extends r.Component{render(){const e=this.props,t=e.handleChange,n=e.legendType,a=e.scaleType,s="properties.title.",c="properties.gradient.",p="properties.symbols.",d=r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Labels"),r.createElement(o.Property,Object.assign({name:"properties.labels.fontSize",label:"Font Size",type:"number"},e)),r.createElement(i.MoreProperties,{label:"Label"},r.createElement(o.Property,Object.assign({name:"properties.labels.fill",label:"Fill",type:"color"},e))));return r.createElement("div",null,r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Legend"),r.createElement(o.Property,Object.assign({name:"orient",label:"Orient",type:"select",opts:["left","right"],onChange:t},e)),r.createElement(i.MoreProperties,{label:"Legend"},r.createElement(o.Property,Object.assign({name:"properties.legend.stroke",label:"Color",type:"color"},e)),r.createElement(o.Property,Object.assign({name:"properties.legend.strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25"},e)))),r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Title"),r.createElement(o.Property,Object.assign({name:"title",label:"Text",type:"text",onChange:t},e)),r.createElement(o.Property,Object.assign({name:s+"fontSize",label:"Font Size",type:"number"},e)),r.createElement(i.MoreProperties,{label:"Title"},r.createElement(o.Property,Object.assign({name:s+"fill",label:"Color",type:"color"},e)))),"fill"!==n&&"stroke"!==n||"ordinal"===a?r.createElement("div",null,r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Symbols"),"shape"!==n?r.createElement(o.Property,Object.assign({name:p+"shape",label:"Shape",type:"select",opts:l.SymbolShapes},e)):null,"size"!==n?r.createElement(o.Property,Object.assign({name:p+"size",label:"Size",type:"number"},e)):null,"fill"!==n?r.createElement(o.Property,Object.assign({name:p+"fill",label:"Fill",type:"color"},e)):null,"stroke"!==n?r.createElement(o.Property,Object.assign({name:p+"stroke",label:"Stroke",type:"color"},e)):null,r.createElement(i.MoreProperties,{label:"Symbol"},r.createElement(o.Property,Object.assign({name:p+"fillOpacity",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05"},e)),r.createElement(o.Property,Object.assign({name:p+"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25"},e)))),d):r.createElement("div",null,d,r.createElement("div",{className:"property-group"},r.createElement(i.MoreProperties,{label:"Gradient",header:"true"},r.createElement(o.Property,Object.assign({name:c+"stroke",label:"Color",type:"color"},e)),r.createElement(o.Property,Object.assign({name:c+"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25"},e))))))}})},1243:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(880),r=n(17),s=n(140);t.LineInspector=class extends r.Component{render(){const e=this.props;return r.createElement("div",null,r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Position"),r.createElement(s.Property,Object.assign({name:"x",label:"X",type:"number",droppable:!0},e)),r.createElement(s.Property,Object.assign({name:"y",label:"Y",type:"number",droppable:!0},e))),r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Stroke"),r.createElement(s.Property,Object.assign({name:"stroke",label:"Color",type:"color",droppable:!0},e)),r.createElement(s.Property,Object.assign({name:"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25",droppable:!0},e))),r.createElement("div",{className:"property-group"},r.createElement("h3",null,"Line Strength"),r.createElement(s.Property,Object.assign({name:"interpolate",label:"Interpolate",type:"select",opts:a,droppable:!0},e)),r.createElement(s.Property,Object.assign({name:"tension",label:"Tension",type:"number",droppable:!0},e))))}}},1244:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(1245),s=n(140);t.RectInspector=class extends a.Component{render(){const e=this.props;return a.createElement("div",null,a.createElement("div",{className:"property-group"},a.createElement("h3",null,"X Position"),a.createElement(r.ExtentProperty,Object.assign({exType:"x"},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Y Position"),a.createElement(r.ExtentProperty,Object.assign({exType:"y"},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Fill"),a.createElement(s.Property,Object.assign({name:"fill",label:"Color",type:"color",droppable:!0},e)),a.createElement(s.Property,Object.assign({name:"fillOpacity",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05",droppable:!0},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Stroke"),a.createElement(s.Property,Object.assign({name:"stroke",label:"Color",type:"color",droppable:!0},e)),a.createElement(s.Property,Object.assign({name:"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25",droppable:!0},e))))}}},1245:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(40),r=(a.getIn,a.getInVis),s=n(17),i=n(35),o=n(67),l=n(591),c=n(140),p=n(1246);t.ExtentProperty=i.connect(function(e,t){const n=t.exType,a=t.primId,s=r(e,"marks."+a+".encode.update");let i,o;return Object.values(l.default[n]).forEach(function(e){const t=e.name;s[t]._disabled||(i?i!==t&&(o=t):i=t)}),{start:i,end:o,startDisabled:s[i].band||s[i].group,endDisabled:s[o].band||s[o].group}},function(e,t){return{setExtent:function(n,a){const r=t.primId;e(o.setMarkExtent({oldExtent:n,newExtent:a},r)),e(o.resetMarkVisual(a,r))}}})(class extends s.Component{handleChange(e){const t=this.props,n=t.exType,a=e.target,r=a.name,s=a.value,i=t[r],o=l.default[n],c=o.CENTER.name,p=o.SPAN.name,d=t.end;t.setExtent(i,s),s===c&&d!==p&&t.setExtent(d,p)}render(){const e=this.props,t=e.exType,n=l.default[t],a=n.CENTER.name,r=n.SPAN.label,i=Object.values(n),o=e.start,d=e.end;return s.createElement("div",null,s.createElement(c.Property,Object.assign({name:o,type:"number",droppable:!0,firstChild:!0,disabled:e.startDisabled},e),s.createElement("div",{className:"label-long label"},s.createElement("select",{name:"start",value:o,onChange:e=>this.handleChange(e)},i.filter(function(e){return e.name!==d}).map(function(e){return s.createElement("option",{key:e.name,value:e.name},e.label)}))),s.createElement(p.SpatialPreset,Object.assign({className:"extra",name:o},e))),s.createElement(c.Property,Object.assign({name:d,type:"number",droppable:!0,firstChild:!0,disabled:e.endDisabled},e),s.createElement("br",null),s.createElement("div",{className:"label-long label"},o===a?s.createElement("label",{htmlFor:"end"},r):s.createElement("select",{name:"end",value:d,onChange:e=>this.handleChange(e)},i.filter(function(e){return e.name!==o&&e.name!==a}).map(function(e){return s.createElement("option",{key:e.name,value:e.name},e.label)}))),s.createElement(p.SpatialPreset,Object.assign({className:"extra",name:d},e))))}})},1246:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(40).getInVis,r=n(17),s=n(35),i=n(67);t.SpatialPreset=s.connect(function(e,t){const n=t.primId,r=t.name,s=a(e,"marks."+n+".encode.update."+r);return{field:s.field,band:s.band,group:s.group,scale:a(e,"scales."+s.scale)}},function(e,t){const n=t.primId;return{setPreset:function(t,a){e(i.setMarkVisual({property:t,def:a},n))},reset:function(t){e(i.resetMarkVisual(t,n))}}})(class extends r.Component{handleChange(e){const t=this.props,n=t.name,a=t.scale,r=n.indexOf("x")>=0?"width":"height";e.target.checked?t.setPreset(n,"width"===n||"height"===n?{scale:a.get("_id"),band:!0}:{group:r}):t.reset(n)}render(){const e=this.props,t=e.name,n=e.scale,a=t.indexOf("x")>=0?"width":"height";return e.field?null:"width"===t||"height"===t?n&&"ordinal"===n.get("type")&&!n.get("points")?r.createElement("label",null,r.createElement("input",{type:"checkbox",name:t,checked:e.band,onChange:e=>this.handleChange(e)})," Automatic"):null:r.createElement("label",null,r.createElement("input",{type:"checkbox",name:t,checked:e.group,onChange:e=>this.handleChange(e)})," Set to group ",a)}})},1247:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(40).getInVis,r=n(17),s=n(35);t.ScaleInspector=s.connect(function(e,t){return{scale:a(e,"scales."+t.primId)}})(class extends r.Component{render(){const e=this.props.scale;return r.createElement("div",null,r.createElement("div",{className:"property-group"},r.createElement("h3",{className:"label"},"Placeholder"),r.createElement("ul",null,r.createElement("li",null,"name: ",e.get("name")),r.createElement("li",null,"type: ",e.get("type")))))}})},1248:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(372),i=n(158),o=n(157),l=n(1249),c=n(222),p=n(1250),d=n(23),u=n(1251),m=n(1252),g=n(72),h=n(310);const f={setInput:i.setInput,setSelection:i.setSelection,setApplication:i.setApplication,removeApplication:i.removeApplication,setSignals:i.setSignals};function y(e,t,n,a,r){if(r){const n=[],a=s.IntervalSelection({id:"brush",label:"Brush"}),r=s.IntervalSelection({id:"brush_y",label:"Brush (y-axis)",encoding:"y"}),i=s.IntervalSelection({id:"brush_x",label:"Brush (x-axis)",encoding:"x"}),l=new Set(e.map(e=>e.type));if(l.has("symbol")&&(t.xScaleType&&t.yScaleType&&n.push(a),t.yScaleType&&n.push(r),t.xScaleType&&n.push(i)),l.has("rect")&&(t.xScaleType===o.ScaleSimpleType.DISCRETE&&n.push(i),t.yScaleType===o.ScaleSimpleType.DISCRETE&&n.push(r)),l.has("area")){const a=e.find(e=>"area"===e.type).toJS();a.encode&&a.encode.update&&a.encode.update.orient&&a.encode.update.orient.value&&("vertical"===a.encode.update.orient.value&&t.xScaleType?n.push(i):"horizontal"===a.encode.update.orient.value&&t.yScaleType&&n.push(r))}return l.has("line"),[...new Set(n)]}{let e="_vgsid_";if(a&&a.selection){const t=a.selection;t.field&&"_vgsid_"!==t.field&&(e=t.field)}return[s.PointSelection({ptype:"single",id:"single",label:"Single point",field:"_vgsid_"}),s.PointSelection({ptype:"multi",id:"multi",label:"Multi point",field:"_vgsid_"}),s.PointSelection({ptype:"single",id:"single_project",label:"Single point (projected)",field:e,encoding:null}),s.PointSelection({ptype:"multi",id:"multi_project",label:"Multi point (projected)",field:e,encoding:null})]}}function v(e,t,n,a,r,i,o){const l=[];if(t.length){const e=t[0],n=t.find(e=>"symbol"===e.type);l.push(s.MarkApplication({id:"color_"+o,label:"Color",targetMarkName:c.default(e.name),propertyName:"line"===e.type?"stroke":"fill",unselectedValue:"#797979"})),l.push(s.MarkApplication({id:"opacity_"+o,label:"Opacity",targetMarkName:c.default(e.name),propertyName:"opacity",unselectedValue:"0.2"})),n&&l.push(s.MarkApplication({id:"size_"+o,label:"Size",targetMarkName:c.default(n.name),propertyName:"size",unselectedValue:30}))}return o&&l.push(s.ScaleApplication({id:"panzoom",label:"Pan and zoom",scaleInfo:n})),a.filter(t=>t._id!==e).forEach(e=>{const t=e._id,n=r.get(t).find(e=>e.from&&e.from.data);if(n){const t=c.default(e.name),a=c.default(n.name),r=i.get(String(n.from.data)).name;l.push(s.TransformApplication({id:"filter_"+t+"_"+o,label:"Filter "+e.name,targetGroupName:t,datasetName:r,targetMarkName:a}))}}),l}t.InteractionInspector=r.connect(function(e,t){const n=e.getIn(["vis","present","interactions",String(t.primId)]),a=n.get("groupId"),r=o.getScaleInfoForGroup(e,a),s=e.getIn(["vis","present","marks",String(a)]),i=c.default(s.name),l=e.getIn(["vis","present","marks"]).filter(e=>"group"===e.type).mapEntries(([e,t])=>[Number(e),t]),p=l.map(t=>o.getNestedMarksOfGroup(e,t)),d=p.get(a),u=e.getIn(["vis","present","datasets"]);let m=[];if(d.length&&d[0].from&&d[0].from.data){const e=String(d[0].from.data);m=u.get(e).get("_schema").keySeq().toArray()}const h=e.getIn(["vega","isParsing"]),f=Boolean(!h&&g.view&&(r.xScaleName&&r.xFieldName||r.yScaleName&&r.yFieldName)),_=n.input?"drag"===n.input.mouse:null,{selectionPreviews:b,applicationPreviews:x}=function(e,t,n,a,r,s,i,o){if(null===o)return{selectionPreviews:[],applicationPreviews:[]};const l=r.get(e);return{selectionPreviews:y(l,t,0,i,o),applicationPreviews:v(e,l,t,a,r,s,o)}}(a,r,0,l,p,u,n,_);return{interaction:n,groups:l,scaleInfo:r,group:s,groupName:i,datasets:u,marksOfGroups:p,fieldsOfGroup:m,canDemonstrate:f,selectionPreviews:b,applicationPreviews:x,isDemonstratingInterval:_}},f)(class extends a.Component{constructor(){super(...arguments),this.previewRefs={},this.mainViewSignalValues={},this.updateIsDemonstrating=d.debounce(250,()=>{const e=this.mainViewSignalValues[this.scopedSignalName("brush_x")]&&this.mainViewSignalValues[this.scopedSignalName("brush_y")]&&Math.abs(this.mainViewSignalValues[this.scopedSignalName("brush_x")][0]-this.mainViewSignalValues[this.scopedSignalName("brush_x")][1])>10&&Math.abs(this.mainViewSignalValues[this.scopedSignalName("brush_y")][0]-this.mainViewSignalValues[this.scopedSignalName("brush_y")][1])>10,t=this.mainViewSignalValues[this.scopedSignalName("points_tuple")]||this.mainViewSignalValues[this.scopedSignalName("points_tuple_projected")],n=e||!t;if(this.props.isDemonstratingInterval!==n)if(this.props.interaction.input)this.props.interaction.selection&&(!this.props.selectionPreviews.length||this.props.interaction.selection.id!==this.props.selectionPreviews[0].id)||this.props.interaction.applications.length||this.props.setInput(Object.assign(Object.assign({},this.props.interaction.input),{mouse:n?"drag":"click"}),this.props.primId);else{const e=window._inputKeyboard;this.props.setInput({mouse:n?"drag":"click",keycode:e?e.keycode:void 0,_key:e?e._key:void 0},this.props.primId)}})}componentDidUpdate(e,t){if(!e.canDemonstrate&&this.props.canDemonstrate&&(this.restoreMainViewSignals(this.props.groupName),this.restorePreviewSignals(),this.onSignal(this.props.groupName,this.scopedSignalName("points_tuple"),(e,t)=>this.onMainViewPointSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("points_tuple_projected"),(e,t)=>this.onMainViewPointSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("points_toggle"),(e,t)=>this.onMainViewPointSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("brush_x"),(e,t)=>this.onMainViewIntervalSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("brush_y"),(e,t)=>this.onMainViewIntervalSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("grid_translate_anchor"),(e,t)=>this.onMainViewGridSignal(e,t)),this.onSignal(this.props.groupName,this.scopedSignalName("grid_translate_delta"),(e,t)=>this.onMainViewGridSignal(e,t))),e.selectionPreviews!==this.props.selectionPreviews&&this.props.selectionPreviews.length){const e=this.props.selectionPreviews.map(e=>e.id);this.props.interaction.selection&&!e.every(e=>e!==this.props.interaction.selection.id)||this.props.setSelection(this.props.selectionPreviews[0],this.props.interaction.id)}if(this.props.interaction.input&&(!e.interaction.input||e.interaction.input.mouse!==this.props.interaction.input.mouse||e.scaleInfo.xScaleName!==this.props.scaleInfo.xScaleName||e.scaleInfo.yScaleName!==this.props.scaleInfo.yScaleName)){const e=this.getInteractionSignals(this.props.interaction,this.props.scaleInfo);this.props.setSignals(e,this.props.interaction.id)}}scopedSignalName(e){return`${e}_${this.props.interaction.id}`}restoreMainViewSignals(e){for(let t of["brush_x","brush_y","points_tuple","points_tuple_projected"].map(e=>this.scopedSignalName(e)))this.mainViewSignalValues[t]&&h.setSignalInGroup(g.view,e,t,this.mainViewSignalValues[t])}restorePreviewSignals(){for(let e of["brush_x","brush_y","points_tuple","points_tuple_projected"].map(e=>this.scopedSignalName(e)))this.mainViewSignalValues[e]&&(setTimeout(()=>{this.updatePreviewSignals(e,this.mainViewSignalValues[e])},50),this.updatePreviewSignals(e,this.mainViewSignalValues[e]))}updatePreviewSignals(e,t){this.props.selectionPreviews.forEach(n=>{this.previewRefs[n.id]&&this.previewRefs[n.id].setPreviewSignal(e,t)}),this.props.applicationPreviews.forEach(n=>{this.previewRefs[n.id]&&this.previewRefs[n.id].setPreviewSignal(e,t)})}onMainViewPointSignal(e,t){this.mainViewSignalValues[e]!==t&&(this.mainViewSignalValues[e]=t,this.updateIsDemonstrating(),this.updatePreviewSignals(e,t))}onMainViewIntervalSignal(e,t){this.mainViewSignalValues[e]!==t&&(this.mainViewSignalValues[e]=t,this.updateIsDemonstrating(),this.updatePreviewSignals(e,t))}onMainViewGridSignal(e,t){this.mainViewSignalValues[e]=t,this.updatePreviewSignals(e,t)}onSignal(e,t,n){h.onSignalInGroup(g.view,e,t,n)}onClickInteractionPreview(e){switch(e.type){case"point":case"interval":this.props.interaction&&this.props.setSelection(e,this.props.interaction.id);break;case"mark":case"scale":case"transform":this.props.interaction&&(e=e,this.interactionHasApplication(e)?this.props.removeApplication(e,this.props.interaction.id):this.props.setApplication(e,this.props.interaction.id))}}interactionHasApplication(e){return this.props.interaction.applications.some(t=>t.id===e.id)}getProjectionOptions(e){const t=[a.createElement("option",{key:"_vgsid_",value:"_vgsid_"},"None"),...this.props.fieldsOfGroup.map(e=>a.createElement("option",{key:e,value:e},e))];return a.createElement("div",null,a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"project_fields"},"Field:"),a.createElement("div",{className:"control"},a.createElement("select",{name:"project_fields",value:e.field,onChange:t=>this.onSelectProjectionField(e,t.target.value)},t))),a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"project_encodings"},"Encoding:"),a.createElement("div",{className:"control"},a.createElement("select",{name:"project_encodings",value:e.encoding,onChange:t=>this.onSelectProjectionEncoding(e,t.target.value)},a.createElement("option",{key:"null",value:"null"},"None"),a.createElement("option",{key:"x",value:"x"},"x"),a.createElement("option",{key:"y",value:"y"},"y")))))}onSelectProjectionField(e,t){const n=e.set("field",t);this.props.setSelection(n,this.props.interaction.id)}onSelectProjectionEncoding(e,t){let n;switch(t){case"x":n=e.set("encoding","x");break;case"y":n=e.set("encoding","y");break;default:n=e.set("encoding",null)}this.props.setSelection(n,this.props.interaction.id)}getTargetMarkOptions(e){const t=this.props.marksOfGroups.get(this.props.group._id);if(1===t.length)return null;const n=t.map(t=>{if(e.id.startsWith("size")&&"symbol"!==t.type)return null;const n=c.default(t.name);return a.createElement("option",{key:n,value:n},n)});return a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"target_mark"},"Target Mark:"),a.createElement("div",{className:"control"},a.createElement("select",{name:"target_mark",value:e.targetMarkName,onChange:t=>this.onSelectTargetMarkName(e,t.target.value)},n)))}onSelectTargetMarkName(e,t){let n=e.set("targetMarkName",t);if(e.id.startsWith("color")){const e=this.props.marksOfGroups.get(this.props.group._id).find(e=>c.default(e.name)===t);n=n.set("propertyName","line"===e.type?"stroke":"fill")}this.props.setApplication(n,this.props.interaction.id)}getInteractionSignals(e,t){const n=e.input;if(!n)return[];const{xScaleName:a,yScaleName:r,xFieldName:s,yFieldName:i}=t,o=e.id,l=[];switch(n.mouse){case"drag":a&&(l.push({signal:`brush_x_start_${o}`,label:"brush_x (start)"}),l.push({signal:`brush_x_end_${o}`,label:"brush_x (end)"})),r&&(l.push({signal:`brush_y_start_${o}`,label:"brush_y (start)"}),l.push({signal:`brush_y_end_${o}`,label:"brush_y (end)"}));break;case"click":l.push({signal:`lyra_points_tuple_${o}`,label:"points"});break;case"mouseover":l.push({signal:`mouse_x_${o}`,label:"mouse_x"}),l.push({signal:`mouse_y_${o}`,label:"mouse_y"}),s&&l.push({signal:`mouse_${s}_${o}`,label:`mouse_${s}`}),i&&l.push({signal:`mouse_${i}_${o}`,label:`mouse_${i}`})}return l}render(){const e=this.props.interaction,t=e.applications;return a.createElement("div",null,a.createElement(u.InteractionInputType,{interactionId:e.id,input:e.input}),e.input?a.createElement("div",null,a.createElement("div",{className:"preview-controller"},a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Selections"),a.createElement("div",{className:"preview-scroll"},this.props.selectionPreviews.map(t=>a.createElement("div",{key:t.id,className:e&&e.selection&&e.selection.id===t.id?"selected":"",onClick:()=>this.onClickInteractionPreview(t)},a.createElement("div",{className:"preview-label"},t.label),a.createElement(p.default,{ref:e=>this.previewRefs[t.id]=e,id:`preview-${t.id}`,interaction:this.props.interaction,groupName:this.props.groupName,applicationPreviews:this.props.applicationPreviews,preview:t})))),e&&e.selection&&e.selection.id.includes("project")?this.getProjectionOptions(e.selection):null),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Applications"),a.createElement("div",{className:"preview-scroll"},this.props.applicationPreviews.map(t=>a.createElement("div",{key:t.id,className:e&&this.interactionHasApplication(t)?"selected":""},a.createElement("div",{onClick:()=>this.onClickInteractionPreview(t)},a.createElement("div",{className:"preview-label"},t.label),a.createElement(p.default,{ref:e=>this.previewRefs[t.id]=e,id:`preview-${t.id}`,interaction:this.props.interaction,groupName:this.props.groupName,applicationPreviews:this.props.applicationPreviews,preview:t}))))),t.map(t=>"mark"===t.type?a.createElement("div",null,this.getTargetMarkOptions(t),a.createElement(l.InteractionMarkApplicationProperty,{interactionId:e.id,groupId:e.groupId,markApplication:t})):null))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Signals"),a.createElement(m.InteractionSignals,{interactionId:this.props.interaction.id,signals:this.props.interaction.signals}))):null)}})},1249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(43),s=n(35),i=n(222),o=n(158),l=n(140),c=n(157);t.InteractionMarkApplicationProperty=s.connect(function(e,t){const n=e.getIn(["vis","present","marks",String(t.groupId)]);return{marks:r.Map(c.getNestedMarksOfGroup(e,n).map(e=>[i.default(e.name),e]))}},function(e){return{setApplication:(t,n)=>{e(o.setApplication(t,n))}}})(class extends a.Component{constructor(e){super(e)}onUnselectedValueChange(e){const t=e.target&&e.target.value;t&&this.props.setApplication(this.props.markApplication.set("unselectedValue",t),this.props.interactionId)}render(){const e=this.props.markApplication.propertyName,t=this.props.markApplication.targetMarkName,n=this.props.marks.filter((e,n)=>n===t).valueSeq().first(),r=this.props.markApplication.unselectedValue,s={primId:n._id,primType:"marks"};switch(e){case"size":s.type="number",s.min="0",s.max="500";break;case"stroke":case"fill":s.type="color";break;case"opacity":s.type="range",s.min="0",s.max="1",s.step="0.05"}return a.createElement("div",null,a.createElement(l.Property,Object.assign({name:e,label:"Selected "+e,droppable:!0},s)),a.createElement(l.Property,Object.assign({name:"unselected"+e,label:"Unselected "+e,onChange:e=>this.onUnselectedValueChange(e),value:r,disabled:!1},s)))}})},1250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(23),s=n(157),i=n(310),o=n(72);class l extends a.Component{constructor(e){super(e),this.width=75,this.height=75}previewToSpec(e){const t=e.targetGroupName||this.props.groupName;let n=s.cleanSpecForPreview(o.export(!1),t,this.props.interaction.id);switch(e.type){case"point":let t;this.props.interaction.applications.length&&(t=this.props.interaction.applications.find(e=>"mark"===e.type)),!t&&this.props.applicationPreviews.length&&(t=this.props.applicationPreviews.find(e=>"mark"===e.type)),t&&(n=s.addApplicationToScene(n,this.props.groupName,this.props.interaction.id,this.props.interaction.input,t));case"interval":return s.addSelectionToScene(n,this.props.groupName,this.props.interaction.id,this.props.interaction.input,e);case"mark":case"scale":case"transform":return this.props.interaction.selection&&(n=s.addSelectionToScene(n,this.props.groupName,this.props.interaction.id,this.props.interaction.input,this.props.interaction.selection)),s.addApplicationToScene(n,this.props.groupName,this.props.interaction.id,this.props.interaction.input,e)}}componentDidMount(){const e=this.previewToSpec(this.props.preview);this.view=new r.View(r.parse(e),{renderer:"svg",container:`#${this.props.groupName}-${this.props.id}`}),this.view.width(this.width),this.view.height(this.height),this.view.runAsync()}componentDidUpdate(e){if(e.groupName!==this.props.groupName||e.interaction!==this.props.interaction){const e=this.previewToSpec(this.props.preview);this.view=new r.View(r.parse(e),{renderer:"svg",container:`#${this.props.groupName}-${this.props.id}`}),this.view.width(this.width),this.view.height(this.height),this.view.runAsync()}}scaleSignalValues(e,t){const n=this.width/640,a=this.height/360;return e.startsWith("brush_x")?t.map(e=>e*n):e.startsWith("brush_y")?t.map(e=>e*a):e.startsWith("grid_translate_delta")&&t?{x:t.x*n,y:t.y*a}:t}setPreviewSignal(e,t){if(this.view){const n=this.scaleSignalValues(e,t);i.setSignalInGroup(this.view,this.props.groupName,e,n),this.view.runAsync()}}getPreviewSignal(e){if(this.view)return i.getSignalInGroup(this.view,this.props.groupName,e)}render(){return a.createElement("div",{id:`${this.props.groupName}-${this.props.id}`,className:"interaction-preview"})}}t.InteractionPreview=l,t.default=l},1251:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s={setInput:n(158).setInput};t.InteractionInputType=r.connect(null,s)(class extends a.Component{onKeyboardKeydown(e){const t=e.which||e.keyCode,n=32===t?"Space":e.key;if(t!==this.props.input.keycode&&this.props.setInput(Object.assign(Object.assign({},this.props.input),{keycode:t,_key:n}),this.props.interactionId),13===t)return e.preventDefault(),!1}clearKeyboard(){this.props.setInput(Object.assign(Object.assign({},this.props.input),{keycode:void 0,_key:void 0}),this.props.interactionId)}onMouseValueChange(e){const t=e.target&&e.target.value;(!this.props.input||t&&t!==this.props.input.mouse)&&this.props.setInput(Object.assign(Object.assign({},this.props.input),{mouse:t}),this.props.interactionId)}mouseValueMap(){const e={drag:"Drag",click:"Click",mouseover:"Hover"};return this.props.input||(e.none="Select an event"),e}setHoverNearest(e){const t=e.target&&e.target.checked;this.props.setInput(Object.assign(Object.assign({},this.props.input),{nearest:t}),this.props.interactionId)}render(){const e=this.props.input;return a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Input Event"),a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"mouse-input"},"Mouse"),a.createElement("div",{className:"control"},a.createElement("div",null,a.createElement("select",{id:"mouse-input",name:"mouse-input",value:e?e.mouse:"none",onChange:e=>this.onMouseValueChange(e)},Object.entries(this.mouseValueMap()).map(([e,t])=>a.createElement("option",{key:e,value:e},t),this))))),e&&"mouseover"===e.mouse?a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"nearest-input"},"Nearest"),a.createElement("div",{className:"control"},a.createElement("div",null,a.createElement("input",{type:"checkbox",name:"nearest-input",checked:e.nearest,onClick:e=>this.setHoverNearest(e)})))):null,e?a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"key-input"},"Keyboard"),a.createElement("div",{className:"control"},a.createElement("div",null,a.createElement("input",{ref:e=>(e||{}).onsearch=(e=>this.clearKeyboard()),className:"key-input",name:"key-input",type:"search",onKeyDown:e=>this.onKeyboardKeydown(e),value:e&&e._key?e._key:"None"})))):null)}})},1252:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(268),i=n(90),o=n(92),l=n(67),c=n(23),p=n(267),d=n(376),u=n(158),m=n(72);const g={startDragging:o.startDragging,stopDragging:o.stopDragging,setMarkVisual:l.setMarkVisual,setSignalPush:u.setSignalPush};t.InteractionSignals=r.connect(function(e){const t=e.getIn(["inspector","dragging"]);return{dragging:t&&t.signal?t:null}},g)(class extends a.Component{constructor(e){super(e),this.handleDragStart=(e=>{const t=this.props.interactionId,n=e.target.dataset.signal;this.props.startDragging(s.SignalDraggingState({interactionId:t,signal:n})),p.default.set(i.MODE,"channels"),m.update()}),this.handleDragEnd=(()=>{const e=p.default.get(i.SELECTED),t=p.default.get(i.CELL),n=c.tupleid(e)&&c.tupleid(t);try{if(n){this.props.setSignalPush({[this.props.dragging.signal]:!0},this.props.dragging.interactionId);const n=+e.mark.role.split("lyra_")[1],a=d.channelName(t.key);this.props.setMarkVisual({property:a,def:{signal:"text"===a?`{{#${this.props.dragging.signal}}}`:this.props.dragging.signal}},n)}}catch(e){console.error("Unable to bind primitive"),console.error(e)}this.props.stopDragging(),p.default.set(i.MODE,"handles"),p.default.set(i.CELL,{}),n||m.update()})}render(){return a.createElement("div",{className:"signals-container"},this.props.signals.map(e=>a.createElement("div",{draggable:!0,className:"signal",onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,"data-signal":e.signal},e.label)))}})},1253:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(372),i=n(225),o=n(157),l=n(222),c=n(598),p=n(1254),d=n(1255),u=n(1256),m=n(72),g=n(310);const h={setSelection:i.setSelection,setApplication:i.setApplication,removeApplication:i.removeApplication,setSignals:i.setSignals};function f(e){return"nominal"===e.field.mtype||"ordinal"===e.field.mtype?[c.WidgetSelection({type:"radio",id:"radio",label:"Radio",comparator:"=="}),c.WidgetSelection({type:"select",id:"select",label:"Select",comparator:"=="})]:"temporal"===e.field.mtype||"quantitative"===e.field.mtype?[c.WidgetSelection({type:"range",id:"range",label:"Range",step:1,comparator:"=="})]:void 0}function y(e){const t=[];if(e.length){const n=e[0];t.push(s.MarkApplication({id:"color",label:"Color",targetMarkName:l.default(n.name),propertyName:"line"===n.type?"stroke":"fill",unselectedValue:"#797979"})),t.push(s.MarkApplication({id:"opacity",label:"Opacity",targetMarkName:l.default(n.name),propertyName:"opacity",unselectedValue:"0.2"})),"symbol"===n.type&&t.push(s.MarkApplication({id:"size",label:"Size",targetMarkName:l.default(n.name),propertyName:"size",unselectedValue:30}))}return t}t.WidgetInspector=r.connect(function(e,t){const n=e.getIn(["vis","present","widgets",String(t.primId)]),a=n.get("groupId"),r=o.getScaleInfoForGroup(e,a),s=e.getIn(["vis","present","marks",String(a)]),i=l.default(s.name),c=e.getIn(["vis","present","marks"]).filter(e=>"group"===e.type).mapEntries(([e,t])=>[Number(e),t]),p=c.map(t=>o.getNestedMarksOfGroup(e,t)),d=p.get(a),u=e.getIn(["vis","present","datasets"]);let g=[];if(d.length&&d[0].from&&d[0].from.data){const e=String(d[0].from.data);g=u.get(e).get("_schema").keySeq().toArray()}const h=e.getIn(["vega","isParsing"]),v=Boolean(!h&&m.view&&(r.xScaleName&&r.xFieldName||r.yScaleName&&r.yFieldName)),{selectionPreviews:_,applicationPreviews:b}=function(e,t,n){const a=t.get(e);return{selectionPreviews:f(n),applicationPreviews:y(a)}}(a,p,n);return{widget:n,groups:c,scaleInfo:r,group:s,groupName:i,datasets:u,marksOfGroups:p,fieldsOfGroup:g,canDemonstrate:v,selectionPreviews:_,applicationPreviews:b}},h)(class extends a.Component{constructor(){super(...arguments),this.previewRefs={},this.mainViewSignalValues={}}componentDidMount(){if(this.props.selectionPreviews&&this.props.selectionPreviews.length){const e=this.props.selectionPreviews.map(e=>e.id);this.props.widget.selection&&!e.every(e=>e!==this.props.widget.selection.id)||this.props.setSelection(this.props.selectionPreviews[0],this.props.widget.id)}if(this.props.applicationPreviews&&this.props.applicationPreviews.length){const e=this.props.applicationPreviews.map(e=>e.id);this.props.widget.applications.length&&!e.every(e=>this.props.widget.applications.map(e=>e.id).includes(e))||this.props.setApplication(this.props.applicationPreviews[0],this.props.widget.id)}this.props.setSignals(this.getInteractionSignals(this.props.widget),this.props.widget.id)}componentDidUpdate(e,t){!e.canDemonstrate&&this.props.canDemonstrate&&(this.restoreMainViewSignals(),this.restorePreviewSignals(),g.onSignal(`widget_${this.props.widget.id}`,(e,t)=>this.onMainViewWidgetSignal(e,t)))}restoreMainViewSignals(){const e=`widget_${this.props.widget.id}`;this.mainViewSignalValues[e]&&(m.view.signal(e,this.mainViewSignalValues[e]),m.view.runAsync())}restorePreviewSignals(){const e=`widget_${this.props.widget.id}`;this.mainViewSignalValues[e]&&(setTimeout(()=>{this.updatePreviewSignals(e,this.mainViewSignalValues[e])},50),this.updatePreviewSignals(e,this.mainViewSignalValues[e]))}updatePreviewSignals(e,t){this.props.applicationPreviews.forEach(n=>{this.previewRefs[n.id]&&this.previewRefs[n.id].setPreviewSignal(e,t)})}onMainViewWidgetSignal(e,t){this.mainViewSignalValues[e]!==t&&(this.mainViewSignalValues[e]=t,this.updatePreviewSignals(e,t))}onClickWidgetPreview(e){this.props.widget&&this.props.setSelection(e,this.props.widget.id)}onClickApplicationPreview(e){this.props.widget&&(this.widgetHasApplication(e)?this.props.removeApplication(e,this.props.widget.id):this.props.setApplication(e,this.props.widget.id))}widgetHasApplication(e){return this.props.widget.applications.some(t=>t.id===e.id)}getComparatorOptions(e){const t=["==","<",">","<=",">="].map(e=>a.createElement("option",{key:e,value:e},e));return a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"widget_comparator"},"Comparator:"),a.createElement("div",{className:"control"},a.createElement("select",{name:"widget_comparator",value:e.comparator,onChange:t=>this.onSelectComparator(e,t.target.value)},t)))}onSelectComparator(e,t){const n=e.set("comparator",t);this.props.setSelection(n,this.props.widget.id)}getTargetMarkOptions(e){const t=this.props.marksOfGroups.get(this.props.group._id);if(1===t.length)return null;const n=t.map(e=>{const t=l.default(e.name);return a.createElement("option",{key:t,value:t},t)});return a.createElement("div",{className:"property"},a.createElement("label",{htmlFor:"target_mark"},"Target Mark:"),a.createElement("div",{className:"control"},a.createElement("select",{name:"target_mark",value:e.targetMarkName,onChange:t=>this.onSelectTargetMarkName(e,t.target.value)},n)))}onSelectTargetMarkName(e,t){let n=e.set("targetMarkName",t);if(e.id.startsWith("color")){const e=this.props.marksOfGroups.get(this.props.group._id).find(e=>l.default(e.name)===t);n=n.set("propertyName","line"===e.type?"stroke":"fill")}this.props.setApplication(n,this.props.widget.id)}getInteractionSignals(e){return[{signal:`widget_${e.id}`,label:`widget_${e.field.name}`}]}render(){const e=this.props.widget,t=e.applications;return a.createElement("div",null,a.createElement("div",null,a.createElement("div",{className:"preview-controller"},a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Selections"),a.createElement("div",{className:"preview-scroll"},this.props.selectionPreviews.map(t=>a.createElement("div",{key:t.id,className:e&&e.selection&&e.selection.id===t.id?"selected":"",onClick:()=>this.onClickWidgetPreview(t)},a.createElement("div",{className:"preview-label"},t.label),a.createElement(p.default,{id:`preview-${t.id}`,groupName:this.props.groupName,widget:this.props.widget,preview:t})))),e&&e.selection?this.getComparatorOptions(e.selection):null),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Applications"),a.createElement("div",{className:"preview-scroll"},this.props.applicationPreviews.map(t=>a.createElement("div",{key:t.id,className:e&&this.widgetHasApplication(t)?"selected":""},a.createElement("div",{onClick:()=>this.onClickApplicationPreview(t)},a.createElement("div",{className:"preview-label"},t.label),a.createElement(p.default,{ref:e=>this.previewRefs[t.id]=e,id:`preview-${t.id}`,groupName:this.props.groupName,widget:this.props.widget,preview:t}))))),t.map(t=>"mark"===t.type?a.createElement("div",null,this.getTargetMarkOptions(t),a.createElement(d.WidgetMarkApplicationProperty,{widgetId:e.id,groupId:e.groupId,markApplication:t})):null))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Signals"),a.createElement(u.WidgetSignals,{widgetId:this.props.widget.id,signals:this.props.widget.signals}))))}})},1254:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(23),s=n(157),i=n(72);n(310);class o extends a.Component{constructor(){super(...arguments),this.width=75,this.height=75}previewToSpec(e){const t=this.props.groupName;let n=s.cleanSpecForPreview(i.export(!1),t);return this.props.widget.selection&&(n=s.addWidgetSelectionToScene(n,this.props.widget,this.props.widget.selection)),s.addWidgetApplicationToScene(n,this.props.groupName,this.props.widget,e)}componentDidMount(){if(this.props.preview.targetMarkName){const e=this.previewToSpec(this.props.preview);this.view=new r.View(r.parse(e),{renderer:"svg",container:`#${this.props.groupName}-${this.props.id}`}),this.view.width(this.width),this.view.height(this.height),this.view.runAsync()}}componentDidUpdate(e){if(this.props.preview.targetMarkName&&(e.groupName!==this.props.groupName||e.widget!==this.props.widget||e.widget.selection!==this.props.widget.selection)){const e=this.previewToSpec(this.props.preview);this.view=new r.View(r.parse(e),{renderer:"svg",container:`#${this.props.groupName}-${this.props.id}`}),this.view.width(this.width),this.view.height(this.height),this.view.runAsync()}}widgetPreview(){const e=s.widgetParams(this.props.widget.field,this.props.widget.dsId);switch(this.props.preview.type){case"radio":return e.options?e.options.map((e,t)=>a.createElement("div",{key:e},a.createElement("input",{type:"radio",name:this.props.preview.id,value:e,checked:0===t||null}),a.createElement("label",{htmlFor:this.props.preview.id},e))):null;case"range":return a.createElement("div",null,a.createElement("input",Object.assign({type:"range"},e)),a.createElement("label",{htmlFor:this.props.preview.id},this.props.widget.field.name));case"select":return a.createElement("select",{value:e.options&&e.options.length?e.options[0]:null},e.options?e.options.map(e=>a.createElement("option",{value:e},e)):null)}}setPreviewSignal(e,t){this.view&&(this.view.signal(e,t),this.view.runAsync())}render(){const e=this.props.preview.targetMarkName;return a.createElement("div",{id:`${this.props.groupName}-${this.props.id}`,className:"interaction-preview"},e?null:this.widgetPreview())}}t.WidgetPreview=o,t.default=o},1255:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(43),s=n(35),i=n(222),o=n(225),l=n(140),c=n(157);t.WidgetMarkApplicationProperty=s.connect(function(e,t){const n=e.getIn(["vis","present","marks",String(t.groupId)]);return{marks:r.Map(c.getNestedMarksOfGroup(e,n).map(e=>[i.default(e.name),e]))}},function(e){return{setApplication:(t,n)=>{e(o.setApplication(t,n))}}})(class extends a.Component{constructor(e){super(e)}onUnselectedValueChange(e){const t=e.target&&e.target.value;t&&this.props.setApplication(this.props.markApplication.set("unselectedValue",t),this.props.widgetId)}render(){const e=this.props.markApplication.propertyName,t=this.props.markApplication.targetMarkName,n=this.props.marks.filter((e,n)=>n===t).valueSeq().first(),r=this.props.markApplication.unselectedValue,s={primId:n._id,primType:"marks"};switch(e){case"size":s.type="number",s.min="0",s.max="500";break;case"stroke":case"fill":s.type="color";break;case"opacity":s.type="range",s.min="0",s.max="1",s.step="0.05"}return a.createElement("div",null,a.createElement(l.Property,Object.assign({name:e,label:"Selected "+e,droppable:!0},s)),a.createElement(l.Property,Object.assign({name:"unselected"+e,label:"Unselected "+e,onChange:e=>this.onUnselectedValueChange(e),value:r,disabled:!1},s)))}})},1256:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(268),i=n(90),o=n(92),l=n(67),c=n(23),p=n(267),d=n(376),u=n(72);const m={startDragging:o.startDragging,stopDragging:o.stopDragging,setMarkVisual:l.setMarkVisual};t.WidgetSignals=r.connect(function(e){const t=e.getIn(["inspector","dragging"]);return{dragging:t&&t.signal?t:null}},m)(class extends a.Component{constructor(e){super(e),this.handleDragStart=(e=>{const t=e.target.dataset.signal;this.props.startDragging(s.SignalDraggingState({signal:t})),p.default.set(i.MODE,"channels"),u.update()}),this.handleDragEnd=(()=>{const e=p.default.get(i.SELECTED),t=p.default.get(i.CELL),n=c.tupleid(e)&&c.tupleid(t);try{if(n){const n=+e.mark.role.split("lyra_")[1],a=d.channelName(t.key);this.props.setMarkVisual({property:a,def:{signal:"text"===a?`{{#${this.props.dragging.signal}}}`:this.props.dragging.signal}},n)}}catch(e){console.error("Unable to bind primitive"),console.error(e)}this.props.stopDragging(),p.default.set(i.MODE,"handles"),p.default.set(i.CELL,{}),n||u.update()})}render(){return a.createElement("div",{className:"signals-container"},this.props.signals.map(e=>a.createElement("div",{draggable:!0,className:"signal",onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,"data-signal":e.signal},e.label)))}})},1257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(140),s=n(422);t.SymbolInspector=class extends a.Component{render(){const e=this.props;return a.createElement("div",null,a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Position"),a.createElement(r.Property,Object.assign({name:"x",label:"X",type:"number",droppable:!0},e)),a.createElement(r.Property,Object.assign({name:"y",label:"Y",type:"number",droppable:!0},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Geometry"),a.createElement(r.Property,Object.assign({name:"shape",label:"Shape",type:"select",opts:s.SymbolShapes,droppable:!0},e)),a.createElement(r.Property,Object.assign({name:"size",label:"Size",type:"number",droppable:!0},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Fill"),a.createElement(r.Property,Object.assign({name:"fill",label:"Color",type:"color",droppable:!0},e)),a.createElement(r.Property,Object.assign({name:"fillOpacity",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05",droppable:!0},e))),a.createElement("div",{className:"property-group"},a.createElement("h3",null,"Stroke"),a.createElement(r.Property,Object.assign({name:"stroke",label:"Color",type:"color",droppable:!0},e)),a.createElement(r.Property,Object.assign({name:"strokeWidth",label:"Width",type:"range",min:"0",max:"10",step:"0.25",droppable:!0},e))))}}},1258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(88),r=n(40).getInVis,s=n(17),i=n(35),o=n(67),l=n(580),c=n(140);t.TextInspector=i.connect(function(e,t){const n=t.primId;return{dsId:r(e,`marks.${n}.from.data`),text:r(e,`marks.${n}.encode.update.text.signal`)}},function(e,t){return{updateTextAttributes:function(n,a){e(o.setMarkVisual({property:n,def:{signal:a}},t.primId))},updateText:function(n){e(o.setMarkVisual({property:"text",def:{signal:n}},t.primId))}}})(class extends s.Component{constructor(e){super(e)}render(){const e=this.props,t=e.dsId;return s.createElement("div",null,s.createElement("div",{className:"property-group"},s.createElement(c.Property,Object.assign({name:"text.signal",value:e.text,type:"autocomplete",autoType:"tmpl",droppable:!0,dsId:t,onChange:e.updateText},e),s.createElement("h3",{className:"label"},"Text"))),s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Font"),s.createElement(c.Property,Object.assign({name:"font",label:"Face",type:"select",opts:l.TextFonts,droppable:!0},e)),s.createElement(c.Property,Object.assign({name:"fontSize",label:"Size",type:"number",droppable:!0},e)),s.createElement(c.Property,Object.assign({name:"fontWeight",label:"Weight",type:"toggle",glyph:a.bold,opts:l.TextFontWeights.map(e=>String(e)),droppable:!0},e)),s.createElement(c.Property,Object.assign({name:"fontStyle",label:"Style",type:"toggle",glyph:a.italic,opts:l.TextFontStyles,droppable:!0},e)),s.createElement(c.Property,Object.assign({name:"fill",label:"Color",type:"color",droppable:!0},e)),s.createElement(c.Property,Object.assign({name:"fillOpacity",label:"Opacity",type:"range",min:"0",max:"1",step:"0.05",droppable:!0},e))),s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Offset"),s.createElement(c.Property,Object.assign({name:"dx",label:"X",type:"number",droppable:!0},e)),s.createElement(c.Property,Object.assign({name:"dy",label:"Y",type:"number",droppable:!0},e))),s.createElement("div",{className:"property-group"},s.createElement("h3",null,"Align"),s.createElement(c.Property,Object.assign({name:"align",label:"Horizontal",type:"selection",glyphs:[a["align-left"],a["align-center"],a["align-right"]],opts:l.TextAlignments,droppable:!0},e)),s.createElement(c.Property,Object.assign({name:"baseline",label:"Vertical",type:"selection",glyphs:[a["vertical-align-top"],a["vertical-align-center"],a["vertical-align-bottom"]],opts:l.TextBaselines,droppable:!0},e)),s.createElement(c.Property,Object.assign({name:"angle",label:"Rotation",type:"number",droppable:!0},e))))}})},1259:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(1260),s=n(1275);t.PipelinesToolbar=class extends a.PureComponent{constructor(e){super(e),this.openModal=(()=>this.setState({modalIsOpen:!0})),this.closeModal=(()=>this.setState({modalIsOpen:!1})),this.state={modalIsOpen:!1}}render(){return a.createElement("div",{id:"pipeline-toolbar"},a.createElement("h2",null,"Data Pipelines"),a.createElement(r.PipelineList,{openModal:this.openModal}),a.createElement(s.default,{modalIsOpen:this.state.modalIsOpen,closeModal:this.closeModal}))}}},1260:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(92),i=n(311),o=n(87),l=n(1261),c=n(40).getInVis,p=n(314),d=n(88);const u={selectPipeline:s.selectPipeline,updatePipeline:i.updatePipelineProperty};t.PipelineList=r.connect(function(e){return{pipelines:c(e,"pipelines"),selectedId:e.getIn(["inspector","pipelines","selectedId"])}},u)(class extends a.Component{render(){const e=this.props.pipelines.keySeq().toArray(),t=this.props.pipelines.valueSeq().toArray(),n=this.props.selectedId?this.props.selectedId:e.length?e[0]:this.props.selectedId;return a.createElement("div",{id:"pipeline-list",style:{marginTop:t.length?-20:-15}},a.createElement("div",{className:"pipeline-tabs"},t.length?t.map(e=>{const t=e._id,r=e.name;return a.createElement(p,{key:t,className:"header "+(n===t?"selected":""),value:r,save:this.props.updatePipeline.bind(this,t,"name"),onClick:()=>this.props.selectPipeline(t)})}):null,a.createElement("span",{className:"new",onClick:this.props.openModal},a.createElement(o.Icon,{glyph:d.plus})," New")),e.length?e.map(e=>a.createElement(l.PipelineInspector,{key:e,id:e,selectedId:n})):a.createElement("div",{id:"pipeline-hint",onClick:this.props.openModal},"Add a new data pipeline to get started."))}})},1261:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(1262),i=n(40).getInVis;t.PipelineInspector=r.connect(function(e,t){const n=t.id;return{pipeline:i(e,"pipelines."+n)}})(class extends a.Component{render(){const e=this.props,t=e.pipeline,n=e.id;let r;const i=+e.selectedId==+n;return i&&(r=a.createElement("div",null,a.createElement(s.default,{id:t._source,fieldsCount:6}),t._aggregates.entrySeq().map(function(e,t){return a.createElement("div",{key:t,className:"aggregate"},a.createElement("p",{className:"source"},"Group By: ",e[0].split("|").join(", ")),a.createElement(s.default,{id:e[1],fieldsCount:6}))}))),a.createElement("div",{className:"pipeline"+(i?" selected":"")},r)}})},1262:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(1263),r=n(17),s=n(35),i=n(1267),o=n(882),l=n(40).getInVis;t.default=s.connect(function(e,t){const n=t.id;return{dataset:l(e,"datasets."+n)}})(class extends r.Component{constructor(e){super(e),this.onPage=this.onPage.bind(this),this.state={page:0,scroll:0}}onPage(e){this.setState({page:e})}onScroll(e){e!==this.state.scroll&&this.setState({scroll:e})}render(){const e=this.props,t=e.id,n=e.dataset.get("_schema").keySeq().toArray(),s=~~(n.length/e.fieldsCount),l=Math.ceil(n.length/(s+1)),c=[];for(let e=0;e<=s;e++)c.push(r.createElement(o.default,{key:e,id:this.props.id,first:0===e,last:e===s,fieldsIndex:e,fieldsCount:l,limit:20,page:this.state.page,onPage:this.onPage,scroll:this.state.scroll,onScroll:i.throttle(250,e=>this.onScroll(e))}));return c.push(r.createElement("div",{key:"TransformList",className:"datatable-container"},r.createElement(a.default,{dsId:t}))),r.createElement("div",{className:"datatable-multi"},c)}})},1263:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(1264),i=n(40).getInVis;t.default=r.connect(function(e,t){return{transforms:i(e,"datasets."+t.dsId+".transform")}})(class extends a.Component{constructor(e){super(e),this.state={expandedIndex:null}}setExpandedIndex(e){this.setState({expandedIndex:e})}render(){const e=this.props,t=e.transforms.filter(e=>"aggregate"!==e.type),n=!!t&&1===t.length&&"aggregate"===t[0].type,r=e.dsId;return t&&t.length&&!n?a.createElement("div",{className:"transform-list"},t.map(function(e,t){return"identifier"===e.type?null:a.createElement(s.default,{key:t,index:t,dsId:r,def:e,expanded:this.state.expandedIndex===t,setExpandedIndex:e=>this.setExpandedIndex(e)})},this)):null}})},1264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(156),i=n(1265),o=n(1266),l=n(370);class c extends a.Component{constructor(){super(...arguments),this.Filter=i.Filter,this.Formula=o.Formula,this.timer=null,this.resetTimer=(()=>{window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{},1e4)}),this.expand=(()=>{this.props.setExpandedIndex(this.props.index),this.resetTimer()}),this.updateTransform=(e=>{this.props.updateTransform(e),this.resetTimer()})}componentDidMount(){this.resetTimer()}componentWillUnmount(){window.clearTimeout(this.timer)}render(){const e=this.props,t=l(e.def.type),n=this[t];return this.props.expanded?a.createElement("div",{className:"transform-inspector"},a.createElement(n,Object.assign({update:this.updateTransform},e))):a.createElement("div",{className:"transform-button",onClick:this.expand},t)}}t.TransformInspector=c,t.default=r.connect(null,function(e,t){return{updateTransform:function(n){e(s.updateTransform({index:t.index,transform:n},t.dsId))}}})(c)},1265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(83),s=n(140),i=n(72);t.Filter=class extends a.Component{constructor(){super(...arguments),this.updateFilter=(e=>{let t=e.target?e.target.value:e;if(i.view)try{r.default(t,{getSignal:e=>i.view.signal(e),signalRef:()=>null}),this.props.update({type:"filter",expr:t})}catch(e){console.warn(e)}else setTimeout(()=>{this.updateFilter(e)},100)})}render(){const e=this.props,t=e.dsId;return a.createElement(s.Property,{type:"autocomplete",autoType:"expr",label:"Filter",primType:"datasets",primId:t,name:"transform."+e.index+".expr",dsId:t,onChange:this.updateFilter})}}},1266:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(83),s=n(140),i=n(72);t.Formula=class extends a.Component{constructor(){super(...arguments),this.updateFormula=(e=>{const t=this.props,n=t.def,a=e.target?e.target.value:n.as,s=e.target?n.expr:e;if(i.view)try{r.default(s,{getSignal:e=>i.view.signal(e),signalRef:()=>null}),t.update({type:"formula",as:a,expr:s})}catch(e){}else setTimeout(()=>{this.updateFormula(e)},100)})}render(){const e=this.props,t=this.updateFormula,n=e.dsId;return a.createElement("div",null,a.createElement(s.Property,{type:"autocomplete",label:"Calculate",autoType:"expr",primType:"datasets",primId:n,name:"transform."+e.index+".expr",dsId:n,onChange:t}),a.createElement(s.Property,{type:"text",label:"As",primType:"datasets",primId:n,name:"transform."+e.index+".as",onChange:t}))}}},1268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(226),i=n(23),o=n(376),l=n(92),c=n(267),p=n(268),d=n(90),u=n(309),m=n(87),g=n(1269),h=n(1271),f=n(1272),y=n(1273),v=n(72),_=n(40).getInVis,b=n(88),x=n(883).QUANTITATIVE;const S={bindChannel:o.default,startDragging:l.startDragging,stopDragging:l.stopDragging};t.default=r.connect(function(e,t){return{srcId:_(e,"pipelines."+_(e,"datasets."+t.dsId+"._parent")+"._source")}},S)(class extends a.Component{constructor(e){super(e),this.handleDragStart=(e=>{const t=e.target.classList;this.setState(e=>Object.assign(Object.assign({},e),{bindField:u.default(this.state.fieldDef),showAggregates:t.contains("aggregate-field")}));const n=this.props.dsId,a=this.state.fieldDef;this.props.startDragging(p.FieldDraggingState({dsId:n,fieldDef:a})),c.default.set(d.MODE,"channels"),v.update()}),this.handleDragEnd=((e,t)=>{const n=this.props,a=c.default.get(d.SELECTED),r=c.default.get(d.CELL),s=this.state.bindField,o=i.tupleid(a)&&i.tupleid(r),l=s.source?n.srcId:n.dsId;try{if(o){const e=+a.mark.role.split("lyra_")[1];i.extend(s,t),n.bindChannel(l,s,e,r.key)}}catch(e){console.error("Unable to bind primitive"),console.error(e)}n.stopDragging(),c.default.set(d.MODE,"handles"),c.default.set(d.CELL,{}),this.setState({bindField:null}),o||v.update()}),this.toggleTransforms=(e=>{this.setState({showAggregates:!this.state.showAggregates})}),this.state={fieldDef:null,offsetTop:null,bindField:null,showAggregates:!1}}componentWillReceiveProps(e){const t=e.def,n=e.schema;this.setState(e=>t?Object.assign(Object.assign({},e),{fieldDef:n.get(t.name),offsetTop:t.offsetTop,showAggregates:!1}):Object.assign(Object.assign({},e),{fieldDef:null,showAggregates:!1}))}componentDidUpdate(){s.default.rebuild()}render(){const e=this.props.dsId,t=this.state,n=document.querySelector(".field.source"),r=n?n.getBoundingClientRect():{height:1,width:1},s=t.fieldDef,i={top:t.offsetTop,display:s?"block":"none"},o={top:t.offsetTop,display:s&&t.showAggregates?"block":"none"},l={display:i.display,top:t.offsetTop-18,height:r.height+26,width:2*r.width},c={onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd},p=s?a.createElement("div",null,a.createElement(h.default,{dsId:e,field:s}),s.mtype===x?a.createElement(m.Icon,{onClick:this.toggleTransforms,glyph:b.aggregate,width:"10",height:"10","data-tip":"Show aggregations"}):null,a.createElement("span",{className:"fieldName"},s.name),a.createElement(f.default,{dsId:e,field:s}),a.createElement(y.default,{dsId:e,field:s})):null;return a.createElement("div",{onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd},a.createElement("div",{className:"buffer full",style:l}),a.createElement("div",{style:i,draggable:!0,className:"full field "+(s&&s.source?"source":"derived")},p),a.createElement(g.AggregateList,Object.assign({handlers:c,style:o,field:s},this.props)))}})},1269:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(1270),s=n(595),i=5;t.AggregateList=class extends a.Component{constructor(e){super(e),this.expand=(()=>{this.setState({fullList:!0})}),this.state={fullList:!1}}componentWillReceiveProps(e){e.field!==this.props.field&&this.setState({fullList:!1})}render(){const e=this.props,t=this.state.fullList,n=s.slice(0,t?void 0:i);return a.createElement("div",{className:"aggregates-list",style:e.style},n.map(function(t,n){return a.createElement(r.default,Object.assign({op:t,key:n,field:e.field},e.handlers))}),t?null:a.createElement("div",{className:"more full field derived",onClick:this.expand},"+ More"))}}},1270:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17);n(595);t.default=class extends a.Component{constructor(){super(...arguments),this.onDragEnd=(e=>{const t=this.props;t.onDragEnd(e,{aggregate:t.op})})}render(){const e=this.props,t=e.field,n=t?t.name:null;return a.createElement("div",{className:"full field derived aggregate-field",draggable:!0,onDragStart:e.onDragStart,onDragEnd:this.onDragEnd},a.createElement("strong",null,e.op),"_",n)}}},1271:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(226),i=n(156),o=n(87),l=n(370),c=n(883),p=n(88);t.default=r.connect(null,function(e,t){return{changeType:function(){const n=t.field;let a=c.indexOf(n.mtype);a=(a+1)%c.length,e(i.changeFieldMType({field:n.name,mtype:c[a]},t.dsId))}}})(class extends a.Component{componentDidUpdate(){s.default.rebuild()}render(){const e=this.props,t=e.field.mtype;return a.createElement(o.Icon,{onClick:e.changeType,glyph:p[t],width:"10",height:"10","data-tip":l(t)+" field"})}})},1272:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(156),i=n(87),o=n(88);class l extends a.Component{render(){return a.createElement(i.Icon,{onClick:this.props.filter,glyph:o.filter,width:"10",height:"10","data-tip":"Filter"})}}t.FilterIcon=l,t.default=r.connect(null,function(e,t){return{filter:function(){e(s.addTransform({type:"filter",expr:"datum."+t.field.name},t.dsId))}}})(l)},1273:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(156),i=n(87),o=n(88);class l extends a.Component{render(){return a.createElement(i.Icon,{onClick:this.props.formula,glyph:o.formula,width:"10",height:"10","data-tip":"Calculate a new field"})}}t.FormulaIcon=l,t.default=r.connect(null,function(e,t){return{formula:function(){const n=t.field.name;e(s.addTransform({type:"formula",as:"calc_"+n,expr:"datum."+n},t.dsId))}}})(l)},1274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(592);t.default=class extends a.Component{render(){const e=this.props,t=e.event;if(!t)return null;const n=r.select(t.target),s=n.node(),i=s.parentNode.firstChild,o=i.getBoundingClientRect(),l=i.offsetLeft+o.width,c=n.classed("odd")?"odd":"even",p={display:"block",left:s.offsetLeft-e.scrollLeft+l,top:i.offsetTop};return a.createElement("div",{className:"full value "+c,style:p},n.text())}}},1275:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(1276),s=n(35),i=n(311),o=n(371),l=n(581),c=n(224),p=n(603),d=n(882),u=n(1285),m=n(1286),g=/([\w\d_-]*)\.?[^\\\/]*$/i;const h={addPipeline:i.addPipeline,derivePipeline:i.derivePipeline};class f extends a.Component{constructor(e){super(e),this.initialState={error:null,success:null,showPreview:!1,selectedExample:null,name:null,pipeline:null,dataset:null,values:null,isDerived:!1},this.state=this.initialState,this.loadURL=this.loadURL.bind(this),this.fopen=this.fopen.bind(this)}createPipeline(e){const t=e.match(g)[1];this.setState({name:t,pipeline:l.Pipeline({name:t})})}createDataset(e){const t=c.parseRaw(e),n=t.values;this.setState({values:n,dataset:o.Dataset({name:this.state.name,format:t.format,_schema:c.schema(n)})})}success(e,t){this.setState({error:null,success:e||null,showPreview:!0,selectedExample:t,isDerived:!1})}error(e){this.setState({error:e.statusText||e.message||"An error occured!",success:null,selectedExample:null,isDerived:!1})}done(e){const t=this.state;e&&null===t.error&&(this.state.isDerived?this.props.derivePipeline(t.pipeline._id):this.props.addPipeline(t.pipeline,t.dataset,t.values)),this.setState(this.initialState),this.props.closeModal()}loadURL(e,t){this.createPipeline(e),p.get(e,(n,a)=>{a?this.error(a):(this.createDataset(n),this.success(t?null:`Succesfully imported ${e}`),this.setState({selectedExample:e}))})}selectPipelineToDerive(e){const t=this.props.datasets.get(String(e._source));this.setState({name:e.name,pipeline:e,dataset:t,values:c.output(t._id),isDerived:!0,showPreview:!0,selectedExample:String(e._id)})}fopen(e){p.read(e.target.files,(e,t)=>{this.createPipeline(t.name),this.createDataset(e),this.success(`Successfully imported ${t.name}`)})}render(){const e=this.props,t=this.state,n=t.error,s=t.success,i=t.showPreview,o=this.done.bind(this,!1),l=e.canDerive,c={overlay:{display:"flex",alignItems:"center",justifyContent:"center"},content:{overflow:"hidden",top:null,bottom:null,left:null,right:null,width:"550px",height:s||n||i||l?"auto":"300px",padding:null}};return a.createElement(r,{isOpen:e.modalIsOpen,onRequestClose:o,contentLabel:"Pipeline Modal",style:c},a.createElement("div",{className:"pipelineModal"},a.createElement("span",{className:"closeModal",onClick:o},"close"),a.createElement("div",{className:"row"},a.createElement("div",{className:"examples"},a.createElement("h2",null,"Example Datasets"),a.createElement("ul",null,m.map(function(e){const n=e.name,r=e.description,s=e.url,i=t.selectedExample===s?"selected":null;return a.createElement("li",{key:n,onClick:this.loadURL.bind(this,s,!0),className:i},a.createElement("p",{className:"example-name"},n),a.createElement("p",null,r))},this))),a.createElement("div",{className:"load"},a.createElement("h2",null,"Import a Dataset"),a.createElement("p",null,"Data must be in a tabular form. Supported import formats include ",a.createElement("abbr",{title:"JavaScript Object Notation"},"json"),", ",a.createElement("abbr",{title:"Comma-Separated Values"},"csv")," and ",a.createElement("abbr",{title:"Tab-Separated Values"},"tsv")),a.createElement("p",null,a.createElement("input",{type:"file",accept:".json,.tsv,.csv",onChange:this.fopen})),a.createElement("p",null,"or"),a.createElement(u.default,{loadURL:this.loadURL}))),this.props.pipelines.length?a.createElement("div",{className:"row"},a.createElement("div",{className:"derive"},a.createElement("h2",null,"Derive from Existing Dataset"),a.createElement("ul",null,this.props.pipelines.map(function(e){const n=e.name,r=t.selectedExample===String(e._id)?"selected":null;return a.createElement("li",{key:n,onClick:()=>this.selectPipelineToDerive(e),className:r},a.createElement("p",{className:"pipeline-name"},n))},this)))):null,n?a.createElement("div",{className:"error-message"},n):null,s?a.createElement("div",{className:"success-message"},s):null,!i||n?null:a.createElement("div",{className:"preview"},a.createElement("h2",null,"Preview"),a.createElement(d.default,{className:"source",values:t.values,schema:t.dataset._schema,limit:20}),a.createElement("button",{className:"button button-success",onClick:this.done.bind(this,!0)},"Import"))))}}t.PipelineModal=f,t.default=s.connect(function(e){const t=e.getIn(["vis","present","pipelines"]).valueSeq().toArray();return{pipelines:t,datasets:e.getIn(["vis","present","datasets"]),canDerive:t.length}},h)(f)},1285:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17);t.default=class extends a.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(e){this.props.loadURL(e.target.url.value),e.preventDefault()}render(){return a.createElement("form",{onSubmit:this.handleSubmit},a.createElement("input",{type:"text",name:"url",placeholder:"Enter url"}),a.createElement("button",{type:"submit",value:"Submit",className:"button"},"Load"))}}},1286:function(e,t,n){"use strict";e.exports=[{name:"Cars",description:"Vehicular data which consists of names, cylinders and displacement",url:"./data/cars.json"},{name:"Jobs",description:"Job demographics such as job type, sex and count",url:"./data/jobs.json"},{name:"Gapminder",description:"Year, country, population, fertility",url:"./data/gapminder.json"},{name:"Climate",description:"Climate attributes such as temperature by lat-long",url:"./data/climate.json"}]},1287:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(87),s=n(1288),i=n(1289),o=n(1290),l=n(1291),c=n(1292),p=n(88);t.Toolbar=class extends a.PureComponent{render(){return a.createElement("div",{className:"toolbar"},a.createElement("div",{className:"toolbar-menu"},a.createElement("input",{type:"checkbox",id:"nav-trigger",className:"nav-trigger"}),a.createElement("label",{htmlFor:"nav-trigger"},a.createElement(r.Icon,{glyph:p.hamburger})),a.createElement("div",{className:"menu"},a.createElement(s.AddMarks,null),a.createElement(i.AddInteractions,null),a.createElement(c.UndoRedo,null),a.createElement(l.Persist,null),a.createElement(o.Export,null))))}}},1288:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(67),i=n(421),o=n(87),l=n(375),c=n(88),p=["rect","symbol","text","line","area"];t.AddMarks=r.connect(null,function(e,t){return{addMark:t=>{const n=i.Mark(t,{_parent:l.getClosestGroupId()});e(s.addMark(n))}}})(class extends a.Component{render(){return a.createElement("ul",{className:"add-marks"},p.map(function(e,t){return a.createElement("li",{key:e,onClick:this.props.addMark.bind(null,e)},a.createElement(o.Icon,{glyph:c[e]})," ",e)},this))}})},1289:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(158),i=n(87),o=n(372),l=n(375),c=n(157),p=n(88),d=n(72);t.AddInteractions=r.connect(function(e){const t=l.getClosestGroupId(),n=c.getScaleInfoForGroup(e,t),a=e.getIn(["vega","isParsing"]);return{groupId:t,canDemonstrate:Boolean(!a&&d.view&&(n.xScaleName&&n.xFieldName||n.yScaleName&&n.yFieldName))}},function(e){return{addInteraction:t=>{const n=o.Interaction({groupId:t});e(s.addInteraction(n))}}})(class extends a.Component{render(){return this.props.canDemonstrate&&1!==this.props.groupId?a.createElement("ul",{className:"add-interactions"},a.createElement("li",{onClick:()=>this.props.addInteraction(this.props.groupId)},a.createElement(i.Icon,{glyph:p.select})," Interaction")):null}})},1290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(23),s=n(590),i=n(603),o=n(87),l=n(88),c={png:"canvas",svg:"svg"};t.Export=class extends a.Component{toImageURL(e){const t=s.exporter(),n=new r.View(r.parse(t),{renderer:c[e]});n.runAsync().then(()=>n.toImageURL(e).then(t=>i.download(t,e)))}toJSONURL(){const e=JSON.stringify(s.exporter(),null,2);return i.toBlob(e,"json")}toHTMLURL(){const e=JSON.stringify(s.exporter(),null,2),t=l.scaffold.replace("INJECT_SPEC",e);return i.toBlob(t,"html")}render(){return a.createElement("ul",null,a.createElement("li",null,a.createElement(o.Icon,{glyph:l.export})," Export",a.createElement("ul",null,a.createElement("li",{onClick:this.toImageURL.bind(null,"png")},"As PNG"),a.createElement("li",{onClick:this.toImageURL.bind(null,"svg")},"As SVG"),a.createElement("li",{onClick:this.toJSONURL},"As JSON"),a.createElement("li",{onClick:this.toHTMLURL},"As HTML"))))}}},1291:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(423),i=n(603),o=n(87),l=n(88);t.Persist=r.connect(null,{hydrate:s.hydrate})(class extends a.Component{constructor(e){super(e),this.open=this.open.bind(this)}open(){return i.fopen("json",this.props.hydrate)}save(){const e=s.persist();return i.toBlob(JSON.stringify(e),"json")}render(){return a.createElement("ul",{className:"persist"},a.createElement("li",{onClick:this.open},a.createElement(o.Icon,{glyph:l.open,className:"open",width:"15"})),a.createElement("li",{onClick:this.save},a.createElement(o.Icon,{glyph:l.save,className:"save"})))}})},1292:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(88),r=n(17),s=n(35),i=n(303),o=n(87);class l extends r.PureComponent{render(){const e=this.props;return r.createElement("ul",{className:"undo-redo"},r.createElement("li",{onClick:e.undo,className:e.canUndo?"":"grey"},r.createElement(o.Icon,{glyph:a.undo,className:"undo",width:"12",height:"12"})),r.createElement("li",{onClick:e.redo,className:e.canRedo?"":"grey"},r.createElement(o.Icon,{glyph:a.redo,className:"redo",width:"12",height:"12"})))}}t.BaseUndoRedo=l,t.UndoRedo=s.connect(function(e){const t=e.vis;return{canUndo:t.past.length>0,canRedo:t.future.length>0}},i.ActionCreators)(l)},1293:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17),r=n(35),s=n(225),i=n(157),o=n(375),l=n(598),c=n(72);const p={addWidget:s.addWidget};t.default=r.connect(function(e){const t=o.getClosestGroupId(),n=i.getScaleInfoForGroup(e,t),a=e.getIn(["vega","isParsing"]),r=Boolean(!a&&c.view&&(n.xScaleName&&n.xFieldName||n.yScaleName&&n.yFieldName)),s=e.getIn(["inspector","dragging"]);return{dragging:s&&s.dsId?s:null,groupId:t,canDemonstrate:r}},p)(class extends a.Component{constructor(){super(...arguments),this.handleDragOver=(e=>(e.preventDefault&&e.preventDefault(),!1)),this.handleDrop=(()=>{this.props.addWidget(l.Widget({groupId:this.props.groupId,field:this.props.dragging.fieldDef,dsId:this.props.dragging.dsId}))})}render(){return this.props.dragging&&this.props.canDemonstrate?a.createElement("div",{className:"interaction-widget",onDragOver:e=>this.handleDragOver(e),onDrop:()=>this.handleDrop()},a.createElement("div",null,a.createElement("i",null,"Drop field to add query widget"))):null}})},1336:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const a=n(303),r=n(23),s=n(67),i=n(223),o=n(202),l=n(421),c=n(859);n(1532),n(1174),n(854),n(1175);const p=e.store=o.store,d=e.ctrl=n(72),u=n(1176);p.subscribe(u.createStoreListener(p,d)),p.dispatch(i.createScene(c.Scene())),p.dispatch(s.addMark(l.Mark("group",{_parent:1}))),n(1177),p.dispatch(a.ActionCreators.clearHistory()),e.vega=r}).call(this,n(121))},140:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(40),r=a.getIn,s=a.getInVis,i=n(17),o=n(35),l=n(67),c=n(879),p=n(1236),d=n(1239);t.Property=o.connect(function(e,t){if(!t.primId)return{};const n=s(e,t.primType+"."+t.primId);let a,i;t.name&&(t.primType===c.PrimType.MARKS?(a="encode.update."+t.name,i=r(n,"from.data")):a=t.name);const o=r(n,a+".scale"),l=r(n,a+".field"),p=o&&s(e,"scales."+o+".name"),d=r(n,a);return{group:r(n,a+".group"),signal:r(n,a+".signal"),value:d||t.value,field:l,scale:o,srcField:!(!i||!l)&&s(e,"datasets."+i+"._schema."+l+".source"),scaleName:p,dragging:e.getIn(["inspector","dragging"])}},function(e,t){return{unbind:function(){e(l.resetMarkVisual(t.name,t.primId))}}})(class extends i.Component{constructor(e){super(e),this.state={dragOver:0}}render(){const e=this.props,t=e.name,n=e.label,a=e.type,r=e.scale,s=e.field,o=e.unbind;let l,c,u,m,g=this.state.dragOver;if(i.Children.forEach(e.children,function(e){const t=e&&e.props.className;"extra"===t?m=e:"control"===t?u=e:("label"===a||t&&-1!==t.indexOf("label"))&&(l=e)}),l=l||i.createElement("label",{htmlFor:t},n),c=r?i.createElement("div",{className:"scale",onClick:o},e.scaleName):null,!(u=s?i.createElement("div",{className:"field "+(e.srcField?"source":"derived"),onClick:o},s):u))switch(a){case"autocomplete":u=i.createElement(p.AutoComplete,{type:e.autoType,updateFn:e.onChange,value:e.value,dsId:e.dsId,primId:e.primId,primType:e.primType});break;default:u=i.createElement(d.FormInputProperty,Object.assign({},e))}m&&(m=i.createElement("div",{className:"extra"},m));const h="property"+(e.droppable&&e.dragging?" droppable":"")+(e.droppable&&g?" drag-over":"")+(e.firstChild?" first-child":"");return i.createElement("div",{className:h,onDragEnter:()=>this.setState({dragOver:++g}),onDragLeave:()=>this.setState({dragOver:--g})},l,i.createElement("div",{className:"control"},c,u),m)}})},1532:function(e,t){},156:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(167);t.addDataset=function(e,n){return function(a,s){const i=e._id||r.assignId(a,s());e.transform.filter(e=>"identifier"===e.type).length>0||e.transform.push({type:"identifier",as:"_vgsid_"}),a(t.baseAddDataset(e.merge({_id:i}),n))}},t.baseAddDataset=a.createStandardAction("ADD_DATASET")(),t.deleteDataset=a.createStandardAction("DELETE_DATASET")(),t.changeFieldMType=a.createStandardAction("CHANGE_FIELD_MTYPE")(),t.sortDataset=a.createStandardAction("SORT_DATASET")(),t.summarizeAggregate=a.createStandardAction("SUMMARIZE_AGGREGATE")(),t.addTransform=a.createStandardAction("ADD_DATA_TRANSFORM")(),t.updateTransform=a.createStandardAction("UPDATE_DATA_TRANSFORM")()},157:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(309),r=n(582),s=n(224);function i(e,t,n){const r=a.default(e);return r.marks=r.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&(e.signals=u(e.signals,n)),e)),r}function o(e,t,n,r){return(e=a.default(e)).marks=e.marks.map(e=>e.name&&e.name===t&&"group"===e.type?h(e,e=>{if(e.name===n){for(let[t,n]of Object.entries(r))"encode"!==t&&(e[t]=n);if(r.encode&&r.encode.update)for(let[t,n]of Object.entries(r.encode.update)){const a=e.encode.update[t];a&&(a.value||a.signal||a.field?(delete n[0].value,n[0]=Object.assign(Object.assign({},n[0]),a)):Array.isArray(a)&&a.length&&(a[0].test&&!n[0].test.includes(a[0].test)&&(n[0].test=n[0].test+" && "+a[0].test),a[0].value&&(n[0].value=a[0].value))),e.encode.update[t]=n}}return e}):e),e}function l(e,t){return(e=a.default(e)).marks=e.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&(e.marks=e.marks.filter(e=>!(e.name&&e.name.startsWith("lyra_brush")))),e)),e}function c(e){const{xScaleName:t,yScaleName:n,xFieldName:a,yFieldName:r}=e;return{ifXElse:(e,n)=>t&&a?e:n,ifYElse:(e,t)=>n&&r?e:t,ifXY:e=>t&&a&&n&&r?e:""}}var p;function d(e){switch(e){case"linear":case"log":case"pow":case"sqrt":case"symlog":case"time":case"utc":case"sequential":return p.CONTINUOUS;case"ordinal":case"band":case"point":case"quantile":case"quantize":case"threshold":case"bin-ordinal":return p.DISCRETE}}function u(e,t){return e.filter(e=>t.every(t=>t.name!==e.name)).concat(t)}t.addDatasetsToScene=function(e,t,n){const r=a.default(e),s=r.data||(r.data=[]);return r.data=[...s,{name:`brush_store_${t}_${n}`},{name:`grid_store_${t}_${n}`},{name:`points_store_${t}_${n}`}],r},t.addInputsToScene=function(e,t,n,r,s,o){const{xScaleName:l,yScaleName:p,xFieldName:d,yFieldName:u}=s,{ifXElse:m,ifYElse:g,ifXY:h}=c(s);return e=i(e,t,[{name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]},{name:`key_modifier_${n}`,value:!r||!r.keycode,on:[{events:[{source:"window",type:"keydown"}],update:r&&r.keycode?`event.keyCode === ${r.keycode}`:o?"false":"true"},{events:[{source:"window",type:"keyup"}],update:r&&r.keycode?"false":"true"}]},{name:`mouse_x_${n}`,on:[{events:"mousemove",update:`key_modifier_${n} ? x(unit) : mouse_x_${n}`}]},{name:`mouse_y_${n}`,on:[{events:"mousemove",update:`key_modifier_${n} ? y(unit) : mouse_y_${n}`}]}]),l&&d&&(e=i(e,t,[{name:`mouse_${d}_${n}`,on:[{events:"mousemove",update:`key_modifier_${n} ? invert("${l}", mouse_x_${n}) : mouse_${d}_${n}`}]}])),p&&u&&(e=i(e,t,[{name:`mouse_${u}_${n}`,on:[{events:"mousemove",update:`key_modifier_${n} ? invert("${p}", mouse_x_${n}) : mouse_${u}_${n}`}]}])),e=i(e,t,[{name:`points_${n}`,update:`vlSelectionResolve("points_store_${t}_${n}")`},{name:`lyra_is_point_projecting_${n}`,init:"false"},{name:`lyra_points_tuple_${n}`,update:`lyra_is_point_projecting_${n} ? points_tuple_projected_${n} : points_tuple_${n}`},{name:`points_tuple_${n}`,on:[{events:[Object.assign({source:"scope",type:r&&"drag"!==r.mouse?r.mouse:"click"},r&&r.mouse&&"mouseover"===r.mouse&&r.nearest?{markname:`voronoi_${n}`}:{})],update:`datum && !datum.manipulator && item().mark.marktype !== 'group' ? (key_modifier_${n} ? {unit: "layer_0", fields: points_tuple_fields_${n}, values: [(item().isVoronoi ? datum.datum : datum)['_vgsid_']]} : points_tuple_${n} ) : null`,force:!0},{events:[{source:"scope",type:"dblclick"}],update:"null"}]},{name:`points_tuple_projected_${n}`,on:[{events:[Object.assign({source:"scope",type:r&&"drag"!==r.mouse?r.mouse:"click"},r&&r.mouse&&"mouseover"===r.mouse&&r.nearest?{markname:`voronoi_${n}`}:{})],update:`datum && !datum.manipulator && item().mark.marktype !== 'group' ? (key_modifier_${n} ? {unit: "layer_0", fields: points_tuple_fields_${n}, values: [(item().isVoronoi ? datum.datum : datum)['_vgsid_']]} : points_tuple_projected_${n} ) : null`,force:!0},{events:[{source:"scope",type:"dblclick"}],update:"null"}]},{name:`points_tuple_fields_${n}`,value:[{type:"E",field:"_vgsid_"}]},{name:`points_modify_${n}`,update:`modify("points_store_${t}_${n}", lyra_points_tuple_${n}, true, null)`}]),e=i(e=function(e,t,n,r){const{ifXElse:s,ifYElse:i,ifXY:o}=c(r);return(e=a.default(e)).marks=e.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&(e.marks=[...e.marks,{name:`lyra_brush_brush_bg_${n}`,type:"rect",clip:!0,encode:{enter:{fill:{value:"#333"},fillOpacity:{value:.125}},update:{x:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},s({signal:`lyra_brush_x_${n}[0]`},{value:"0"})),{value:0}],y:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},i({signal:`lyra_brush_y_${n}[0]`},{value:"0"})),{value:0}],x2:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},s({signal:`lyra_brush_x_${n}[1]`},{signal:"width"})),{value:0}],y2:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},i({signal:`lyra_brush_y_${n}[1]`},{signal:"height"})),{value:0}]}}},{name:`lyra_brush_brush_${n}`,type:"rect",clip:!0,encode:{enter:{fill:{value:"transparent"}},update:{x:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},s({signal:`lyra_brush_x_${n}[0]`},{value:"0"})),{value:0}],y:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},i({signal:`lyra_brush_y_${n}[0]`},{value:"0"})),{value:0}],x2:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},s({signal:`lyra_brush_x_${n}[1]`},{signal:"width"})),{value:0}],y2:[Object.assign({test:`data("brush_store_${t}_${n}").length && data("brush_store_${t}_${n}")[0].unit === ""`},i({signal:`lyra_brush_y_${n}[1]`},{signal:"height"})),{value:0}],stroke:[{test:s(`lyra_brush_x_${n}[0] !== lyra_brush_x_${n}[1]`,"")+o(" && ")+i(`lyra_brush_y_${n}[0] !== lyra_brush_y_${n}[1]`,""),value:"white"},{value:null}]}}}]),e)),e}(e,t,n,s),t,[{name:`brush_x_start_${n}`,update:`lyra_brush_x_${n}[0]`},{name:`brush_x_end_${n}`,update:`lyra_brush_x_${n}[1]`},{name:`brush_y_start_${n}`,update:`lyra_brush_y_${n}[0]`},{name:`brush_y_end_${n}`,update:`lyra_brush_y_${n}[1]`},{name:`lyra_brush_is_x_encoding_${n}`,init:"false"},{name:`lyra_brush_is_y_encoding_${n}`,init:"false"},{name:`lyra_brush_x_${n}`,update:`lyra_brush_is_y_encoding_${n} ? [width, 0] : brush_x_${n}`},{name:`lyra_brush_y_${n}`,update:`lyra_brush_is_x_encoding_${n} ? [0, height] : brush_y_${n}`},{name:`brush_${n}`,update:`vlSelectionResolve("brush_store_${t}_${n}")`},{name:`grid_${n}`,update:`vlSelectionResolve("grid_store_${t}_${n}")`},{name:`brush_x_${n}`,value:[],on:[{events:{source:"scope",type:"mousedown",filter:[`!event.item || event.item.mark.name !== "lyra_brush_brush_${n}"`]},update:`key_modifier_${n} ? [x(unit), x(unit)] : brush_x_${n}`},{events:{source:"window",type:"mousemove",consume:!0,between:[{source:"scope",type:"mousedown",filter:[`!event.item || event.item.mark.name !== "lyra_brush_brush_${n}"`]},{source:"window",type:"mouseup"}]},update:`key_modifier_${n} ? [brush_x_${n}[0], clamp(x(unit), 0, width)] : brush_x_${n}`},{events:{signal:`brush_scale_trigger_${n}`},update:m(`isArray(brush_${d}_${l}_${n}) && length(brush_${d}_${l}_${n}) == 2 ? [scale("${l}", brush_${d}_${l}_${n}[0]), scale("${l}", brush_${d}_${l}_${n}[1])] : [0, 0]`,"[width, 0]")},{events:{signal:`brush_translate_delta_${n}`},update:`clampRange(panLinear(brush_translate_anchor_${n}.extent_x, brush_translate_delta_${n}.x / span(brush_translate_anchor_${n}.extent_x)), 0, width)`},{events:{signal:`brush_zoom_delta_${n}`},update:`clampRange(zoomLinear(brush_x_${n}, brush_zoom_anchor_${n}.x, brush_zoom_delta_${n}), 0, width)`},{events:[{source:"scope",type:"dblclick"}],update:"[0, 0]"}]},{name:m(`brush_${d}_${l}_${n}`,`brush_x_field_undefined_${n}`),on:m([{events:{signal:`lyra_brush_x_${n}`},update:`lyra_brush_x_${n}[0] === lyra_brush_x_${n}[1] ? null : invert("${l}", lyra_brush_x_${n})`}],[])},{name:`brush_y_${n}`,value:[],on:[{events:{source:"scope",type:"mousedown",filter:[`!event.item || event.item.mark.name !== "lyra_brush_brush_${n}"`]},update:`key_modifier_${n} ? [y(unit), y(unit)] : brush_y_${n}`},{events:{source:"window",type:"mousemove",consume:!0,between:[{source:"scope",type:"mousedown",filter:[`!event.item || event.item.mark.name !== "lyra_brush_brush_${n}"`]},{source:"window",type:"mouseup"}]},update:`key_modifier_${n} ? [brush_y_${n}[0], clamp(y(unit), 0, height)] : brush_y_${n}`},{events:{signal:`brush_scale_trigger_${n}`},update:g(`isArray(brush_${u}_${p}_${n}) && length(brush_${u}_${p}_${n}) == 2 ? [scale("${p}", brush_${u}_${p}_${n}[0]), scale("${p}", brush_${u}_${p}_${n}[1])] : [0, 0]`,"[0, height]")},{events:{signal:`brush_translate_delta_${n}`},update:`clampRange(panLinear(brush_translate_anchor_${n}.extent_y, brush_translate_delta_${n}.y / span(brush_translate_anchor_${n}.extent_y)), 0, height)`},{events:{signal:`brush_zoom_delta_${n}`},update:`clampRange(zoomLinear(brush_y_${n}, brush_zoom_anchor_${n}.y, brush_zoom_delta_${n}), 0, height)`},{events:[{source:"scope",type:"dblclick"}],update:"[0, 0]"}]},{name:g(`brush_${u}_${p}_${n}`,`brush_y_field_undefined_${n}`),on:g([{events:{signal:`lyra_brush_y_${n}`},update:`lyra_brush_y_${n}[0] === lyra_brush_y_${n}[1] ? null : invert("${p}", lyra_brush_y_${n})`}],[])},{name:`brush_scale_trigger_${n}`,value:{},on:[{events:[].concat(m([{scale:"x"}],[])).concat(g([{scale:"y"}],[])),update:m(`(!isArray(brush_${d}_${l}_${n}) || (+invert("${l}", lyra_brush_x_${n})[0] === +brush_${d}_${l}_${n}[0] && +invert("${l}", lyra_brush_x_${n})[1] === +brush_${d}_${l}_${n}[1]))`,"")+h(" && ")+g(`(!isArray(brush_${u}_${p}_${n}) || (+invert("${p}", lyra_brush_y_${n})[0] === +brush_${u}_${p}_${n}[0] && +invert("${p}", lyra_brush_y_${n})[1] === +brush_${u}_${p}_${n}[1]))`,"")+` ? brush_scale_trigger_${n} : {}`}]},{name:`brush_tuple_${n}`,on:[{events:[{signal:m(`brush_${d}_${l}_${n}`,"")+h(" || ")+g(`brush_${u}_${p}_${n}`,"")}],update:m(`brush_${d}_${l}_${n}`,"")+h(" && ")+g(`brush_${u}_${p}_${n}`,"")+` ? {unit: "", fields: brush_tuple_fields_${n}, values: [`+m(`brush_${d}_${l}_${n}`,"")+h(",")+g(`brush_${u}_${p}_${n}`,"")+"]} : null"}]},{name:`brush_tuple_fields_${n}`,value:[].concat(m([{field:d,channel:"x",type:"R"}],[])).concat(g([{field:u,channel:"y",type:"R"}],[]))},{name:`brush_translate_anchor_${n}`,value:{},on:[{events:[{source:"scope",type:"mousedown",markname:`lyra_brush_brush_${n}`}],update:`key_modifier_${n} ? {x: x(unit), y: y(unit), extent_x: slice(lyra_brush_x_${n}), extent_y: slice(lyra_brush_y_${n})} : brush_translate_anchor_${n}`}]},{name:`brush_translate_delta_${n}`,value:{},on:[{events:[{source:"window",type:"mousemove",consume:!0,between:[{source:"scope",type:"mousedown",markname:`lyra_brush_brush_${n}`},{source:"window",type:"mouseup"}]}],update:`key_modifier_${n} ? {x: brush_translate_anchor_${n}.x - x(unit), y: brush_translate_anchor_${n}.y - y(unit)} : brush_translate_delta_${n}`}]},{name:`brush_zoom_anchor_${n}`,on:[{events:[{source:"scope",type:"wheel",consume:!0,markname:`lyra_brush_brush_${n}`}],update:`key_modifier_${n} ? {x: x(unit), y: y(unit)} : brush_zoom_anchor_${n}`}]},{name:`brush_zoom_delta_${n}`,on:[{events:[{source:"scope",type:"wheel",consume:!0,markname:`lyra_brush_brush_${n}`}],force:!0,update:`key_modifier_${n} ? pow(1.001, event.deltaY * pow(16, event.deltaMode)) : brush_zoom_delta_${n}`}]},{name:`brush_modify_${n}`,update:`modify("brush_store_${t}_${n}", brush_tuple_${n}, true)`},{name:m(`grid_${d}_${l}_${n}`,`grid_x_field_undefined_${n}`),on:m([{events:{signal:`grid_translate_delta_${n}`},update:`panLinear(grid_translate_anchor_${n}.extent_x, -grid_translate_delta_${n}.x / width)`},{events:{signal:`grid_zoom_delta_${n}`},update:`zoomLinear(domain("${l}"), grid_zoom_anchor_${n}.x, grid_zoom_delta_${n})`},{events:[{source:"scope",type:"dblclick"}],update:"null"}],[])},{name:g(`grid_${u}_${p}_${n}`,`grid_y_field_undefined_${n}`),on:g([{events:{signal:`grid_translate_delta_${n}`},update:`panLinear(grid_translate_anchor_${n}.extent_y, grid_translate_delta_${n}.y / height)`},{events:{signal:`grid_zoom_delta_${n}`},update:`zoomLinear(domain("${p}"), grid_zoom_anchor_${n}.y, grid_zoom_delta_${n})`},{events:[{source:"scope",type:"dblclick"}],update:"null"}],[])},{name:`grid_tuple_${n}`,on:[{events:[{signal:m(`grid_${d}_${l}_${n}`,"")+h(" || ")+g(`grid_${u}_${p}_${n}`,"")}],update:m(`grid_${d}_${l}_${n}`,"")+h(" && ")+g(`grid_${u}_${p}_${n}`,"")+`? {unit: "", fields: brush_tuple_fields_${n}, values: [`+m(`grid_${d}_${l}_${n}`,"")+h(",")+g(`grid_${u}_${p}_${n}`,"")+"]} : null"}]},{name:`grid_translate_anchor_${n}`,value:{},on:[{events:[{source:"scope",type:"mousedown"}],update:`key_modifier_${n} ? {x: x(unit), y: y(unit)`+m(`, extent_x: domain("${l}")`,"")+g(`, extent_y: domain("${p}")`,"")+`} : grid_translate_anchor_${n}`}]},{name:`grid_translate_delta_${n}`,value:{},on:[{events:[{source:"window",type:"mousemove",consume:!0,between:[{source:"scope",type:"mousedown"},{source:"window",type:"mouseup"}]}],update:`key_modifier_${n} ? {x: grid_translate_anchor_${n}.x - x(unit), y: grid_translate_anchor_${n}.y - y(unit)} : grid_translate_delta_${n}`}]},{name:`grid_zoom_anchor_${n}`,on:[{events:[{source:"scope",type:"wheel",consume:!0}],update:`key_modifier_${n} ? {`+m(`x: invert("${l}", x(unit))`,"")+h(", ")+g(`y: invert("${p}", y(unit))`,"")+`} : grid_zoom_anchor_${n}`}]},{name:`grid_zoom_delta_${n}`,on:[{events:[{source:"scope",type:"wheel",consume:!0}],force:!0,update:`key_modifier_${n} ? pow(1.001, event.deltaY * pow(16, event.deltaMode)) : grid_zoom_delta_${n}`}]},{name:`grid_modify_${n}`,update:`modify("grid_store_${t}_${n}", grid_tuple_${n}, true)`}])},t.addSelectionToScene=function(e,t,n,a,r){switch(r.type){case"point":const s=(r=r).field;switch(e=i(e=l(e,t),t,[{name:`lyra_is_point_projecting_${n}`,init:s&&"_vgsid_"!==s?"true":"false"},{name:`points_tuple_projected_${n}`,on:[{events:[Object.assign({source:"scope",type:a&&"drag"!==a.mouse?a.mouse:"click"},a&&a.mouse&&"mouseover"===a.mouse&&a.nearest?{markname:`voronoi_${n}`}:{})],update:`datum && !datum.manipulator && item().mark.marktype !== 'group' ? (key_modifier_${n} ? {unit: "layer_0", fields: points_tuple_fields_${n}, values: [(item().isVoronoi ? datum.datum : datum)['${s||"_vgsid_"}']]} : points_tuple_projected_${n} ) : null`,force:!0},{events:[{source:"scope",type:"dblclick"}],update:"null"}]},{name:`points_tuple_fields_${n}`,value:[Object.assign({type:"E",field:s||"_vgsid_"},r.encoding?{channel:r.encoding}:{})]}]),r.ptype){case"single":break;case"multi":e=i(e,t,[{name:`points_toggle_${n}`,value:!1,on:[{events:[Object.assign({source:"scope",type:a&&"drag"!==a.mouse?a.mouse:"click"},a&&a.mouse&&"mouseover"===a.mouse&&a.nearest?{markname:`voronoi_${n}`}:{})],update:"event.shiftKey"},{events:[{source:"scope",type:"dblclick"}],update:"false"}]}])}return e;case"interval":switch((r=r).encoding){case"x":return i(e,t,[{name:`lyra_brush_is_x_encoding_${n}`,init:"true"},{name:`lyra_brush_is_y_encoding_${n}`,init:"false"}]);case"y":return i(e,t,[{name:`lyra_brush_is_y_encoding_${n}`,init:"true"},{name:`lyra_brush_is_x_encoding_${n}`,init:"false"}]);default:return e}}},t.addApplicationToScene=function(e,t,n,r,s){const i="drag"===r.mouse;let c;switch(s.type){case"mark":c=(s=s).targetMarkName;const r=s.unselectedValue;return e=o(e,t,c,{encode:{update:{[s.propertyName]:[{test:i?`!(length(data("brush_store_${t}_${n}"))) || (vlSelectionTest("brush_store_${t}_${n}", datum))`:`!(length(data("points_store_${t}_${n}"))) || (vlSelectionTest("points_store_${t}_${n}", datum))`,value:""},{value:r}]}}});case"scale":const p=(s=s).scaleInfo;return function(e,t,n){return(e=a.default(e)).marks=e.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&e.scales.forEach(e=>{n.forEach(t=>{if(e.name===t.name)for(let[n,a]of Object.entries(t))"_axis"!==n&&(e[n]=a)})}),e)),e}(e=function(e,t){return(e=a.default(e)).marks=e.marks.map(e=>e.name&&e.name===t&&"group"===e.type?h(e,e=>(e.clip=!0,e)):e),e}(e=l(e,t),t),t,[{_axis:"x",name:p.xScaleName,domainRaw:{signal:`grid_${n}["${p.xFieldName}"]`},zero:!1},{_axis:"y",name:p.yScaleName,domainRaw:{signal:`grid_${n}["${p.yFieldName}"]`},zero:!1}]);case"transform":const d=(s=s).datasetName,u=s.targetGroupName,m=d+"_filter_"+u;e=o(e,u,c=s.targetMarkName,{from:{data:m}});const{source:g,transform:f}=function e(t,n,a){const r=t.data.filter(e=>e.name===n)[0],s=a.concat(r.transform),i=s.map(e=>JSON.stringify(e)),o=s.filter((e,t)=>i.indexOf(JSON.stringify(e))===t);return r.source?e(t,r.source,o):{source:n,transform:o}}(e,d,[]);return e=function(e,t){const n=((e=a.default(e)).data||(e.data=[])).filter(e=>e.name!==t.name);return e.data=[...n,t],e}(e,{name:m,source:g,transform:[{type:"filter",expr:i?`!(length(data("brush_store_${t}_${n}"))) || (vlSelectionTest("brush_store_${t}_${n}", datum))`:`!(length(data("points_store_${t}_${n}"))) || (vlSelectionTest("points_store_${t}_${n}", datum))`},...f]})}},t.pushSignalsInScene=function(e,t,n){return e=a.default(e),n.forEach(n=>{n.push&&(e.signals=e.signals||[],e.signals=u(e.signals,[{name:n.signal}]),e.marks=e.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&(e.signals=e.signals.map(e=>e.name===n.signal?Object.assign(Object.assign({},e),{push:"outer"}):e)),e)))}),e},t.addWidgetSelectionToScene=function(e,t,n){switch((e=a.default(e)).signals=e.signals||[],n.type){case"select":return e.signals=u(e.signals,[{name:`widget_${t.id}`,bind:Object.assign({name:t.field.name,input:"select"},g(t.field,t.dsId))}]),e;case"radio":return e.signals=u(e.signals,[{name:`widget_${t.id}`,bind:Object.assign({name:t.field.name,input:"radio"},g(t.field,t.dsId))}]),e;case"range":const r=g(t.field,t.dsId);return e.signals=u(e.signals,[{name:`widget_${t.id}`,bind:{name:t.field.name,input:"range",min:r.min,max:r.max,step:n.step||r.step}}]),e;default:return e}},t.addWidgetApplicationToScene=function(e,t,n,a){if(!n.selection)return e;const r=a.targetMarkName,s=a.unselectedValue;return o(e,t,r,{encode:{update:{[a.propertyName]:[{test:`datum.${n.field.name} ${n.selection.comparator} widget_${n.id}`,value:""},{value:s}]}}})},t.addVoronoiMark=function(e,t,n,r,s,i){return(e=a.default(e)).marks=e.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&e.marks.find(e=>e.name===r)&&(e.marks=e.marks.filter(e=>e.name!==`voronoi_${s}`),e.marks=[...e.marks,{name:`voronoi_${s}`,type:"path",interactive:!0,from:{data:r},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}}},transform:[{type:"voronoi",x:{expr:"y"===n?"0":"datum.datum.x || 0"},y:{expr:"x"===n?"0":"datum.datum.y || 0"},size:[{signal:"width"},{signal:"height"}]}]}]),e)),e},t.getScaleInfoForGroup=function(e,t){const{scaleRecordX:n,scaleRecordY:a}=function(e,t){const n={scaleRecordX:null,scaleRecordY:null},a=e.getIn(["vis","present","marks",String(t)]).get("marks").map(t=>e.getIn(["vis","present","marks",String(t)]));if(!a.length)return n;const r=a[0];if(r.encode&&r.encode.update){if(r.encode.update.x){const{scale:t}=r.encode.update.x;n.scaleRecordX=e.getIn(["vis","present","scales",String(t)])}if(r.encode.update.y){const{scale:t}=r.encode.update.y;n.scaleRecordY=e.getIn(["vis","present","scales",String(t)])}}return n}(e,t);return{xScaleName:n?n.get("name"):null,xFieldName:n?n.get("_domain")[0].field:null,xScaleType:n?d(n.get("type")):null,yScaleName:a?a.get("name"):null,yFieldName:a?a.get("_domain")[0].field:null,yScaleType:a?d(a.get("type")):null}},function(e){e.CONTINUOUS="CONTINUOUS",e.DISCRETE="DISCRETE"}(p=t.ScaleSimpleType||(t.ScaleSimpleType={})),t.cleanSpecForPreview=function(e,t,n){const r=a.default(e);return r.autosize="none",r.marks=r.marks.filter(()=>!0).map(e=>(e.name&&"group"===e.type&&(e.axes=e.axes.map(e=>Object.assign(Object.assign({},e),{title:"",labels:!1,ticks:!1,domain:!1})),e.legends=[],e.encode.update.x={value:0},e.encode.update.y={value:0},e.encode.update.width={signal:"width"},e.encode.update.height={signal:"height"},e.marks.length&&"symbol"===e.marks[0].type&&e.marks[0].encode.update.size.value&&(e.marks[0].encode.update.size={value:"10"}),e.name!==t&&(e.encode.update.x={value:-999},e.encode.update.y={value:-999})),e)),function(e,t,n){const r=a.default(e),s=m.map(e=>"width"===e.name||"height"===e.name?e:Object.assign(Object.assign({},e),{name:`${e.name}_${n}`}));return r.marks=r.marks.map(e=>(e.name&&e.name===t&&"group"===e.type&&(e.signals=u(e.signals,s)),e)),r}(r,t,n)},t.editSignals=u;const m=[{name:"width",init:"75"},{name:"height",init:"75"},{name:"mouse_x",init:"null"},{name:"mouse_y",init:"null"},{name:"brush_x",init:"[0, 0]"},{name:"brush_y",init:"[0, 0]"},{name:"brush_zoom_anchor",init:"null"},{name:"brush_zoom_delta",init:"null"},{name:"grid_zoom_anchor",init:"null"},{name:"grid_zoom_delta",init:"null"},{name:"points_tuple",init:"null"},{name:"grid_translate_anchor",init:{}},{name:"grid_translate_delta",init:{}}];function g(e,t){const n=e.mtype;let a=s.output(t).map(t=>t[e.name]);if(n===r.NOMINAL||n===r.ORDINAL)return(a=[...new Set(a)]).length>50&&(a=a.slice(0,50)),{options:a};if(n===r.QUANTITATIVE||n===r.TEMPORAL){const e=(a=a.sort((e,t)=>e-t)).length,t=a.every(e=>Number.isInteger(e));return{max:a[e-1],min:a[0],step:t?1:.1}}}function h(e,t){return(e=a.default(e)).marks=e.marks.map(e=>e.name&&e.name.startsWith("lyra")?e:"group"===e.type?h(e,t):t(e)),e}t.widgetParams=g,t.getNestedMarksOfGroup=function e(t,n){return n.marks.map(a=>{const r=t.getIn(["vis","present","marks",String(a)]);return"group"===r.type?e(t,n):r}).filter(e=>!e.name.startsWith("lyra"))},t.mapNestedMarksOfGroup=h},158:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(313),s=n(167),i=n(877);t.addInteraction=function(e){return function(n,a){const o=e.id||s.assignId(n,a());(e=e.set("id",o)).get("name")||(e=e.set("name",i.recordName(a(),"interactions","Interaction"))),n(t.baseAddInteraction(e,o)),n(r.addInteractionToGroup(o,e.groupId))}},t.baseAddInteraction=a.createStandardAction("ADD_INTERACTION")(),t.setInput=a.createStandardAction("SET_INPUT")(),t.setSelection=a.createStandardAction("SET_SELECTION")(),t.setApplication=a.createStandardAction("SET_APPLICATION")(),t.setSignals=a.createStandardAction("SET_INTERACTION_SIGNALS")(),t.setSignalPush=a.createStandardAction("SET_INTERACTION_SIGNAL_PUSH")(),t.removeApplication=a.createStandardAction("REMOVE_APPLICATION")(),t.deleteInteraction=a.createStandardAction("DELETE_INTERACTION")(),t.updateInteractionName=a.createStandardAction("UPDATE_INTERACTION_NAME")()},167:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(852);t.assignId=function(e,t){const n=t.getIn(["lyra","idCounter"]);return e(a.incrementCounter()),n}},168:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),r=n(221);t.propSg=function(e,t,n){return r(t+"_"+e+"_"+n)},t.convertValuesToSignals=function(e,n,r,s){return e?Object.keys(e).reduce(function(e,i){return void 0===e[i]||void 0===e[i].value?e:(e[i]=a.extend({},{signal:t.propSg(r,n,s?s+"_"+i:i)},e[i]._disabled?{_disabled:!0}:{}),e)},e):e}},201:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(167);t.addGuide=function(e){return function(n,a){const s=e._id||r.assignId(n,a());n(t.baseAddGuide(e.merge({_id:s}),s))}},t.baseAddGuide=a.createStandardAction("ADD_GUIDE")(),t.deleteGuide=a.createStandardAction("DELETE_GUIDE")(),t.updateGuideProperty=a.createStandardAction("UPDATE_GUIDE_PROPERTY")()},202:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(612),s=n(1095),i=n(1096),o=n(876),l=n(268),c=n(90),p=n(599),d=n(878),u=n(597),m=a.Record({vis:{past:[],present:a.Map({pipelines:a.Map(),datasets:a.Map(),scene:a.Map(),scales:a.Map(),guides:a.Map(),marks:a.Map(),interactions:a.Map(),widgets:a.Map(),signals:c.defaultSignalState}),future:[]},vega:p.VegaReparse(),lyra:u.LyraGlobals(),inspector:l.Inspector(),walkthrough:d.Walkthrough(),hints:o.Hints()},"LyraState");var g;t.defaultState=m(),t.store=(g=t.defaultState,r.createStore(i.default,g,r.applyMiddleware(s.default)))},221:function(e,t,n){"use strict";n(854);e.exports=function(e){return e.startsWith("lyra_")?e:"lyra_"+e}},222:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.replace(/\s/g,"_")}},223:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(420),s=n(67),i=n(167),o=n(40).getInVis;t.createScene=function(e){return function(n,a){const r=e._id||i.assignId(n,a());n(t.baseCreateScene({props:e.merge({_id:r}),name:"Scene"},r))}},t.baseCreateScene=a.createStandardAction("CREATE_SCENE")(),t.clearScene=function(){return function(e,t){const n=t(),a=o(n,"scene._id"),i=o(n,"marks."+a+".marks");r.batchGroupBy.start(),i.forEach(function(t){e(s.deleteMark(t))}),r.batchGroupBy.end()}}},224:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(23),s=n(202),i=n(371),o=n(582),l={boolean:o.NOMINAL,number:o.QUANTITATIVE,integer:o.QUANTITATIVE,date:o.TEMPORAL,string:o.NOMINAL},c=n(424),p=(n(1123),n(40).getInVis);let d={};function u(e,t){const n=e._id;if(d[n])return d[n];t?d[n]=t:void 0!==e.source?d[n]=d[e.source]:d[n]=null}function m(){d={}}function g(e){return arguments.length?d=e:d}function h(e){return d[e]||[]}function f(e){const t=n(72),a=function(e){return p(s.store.getState(),"datasets."+e)}(e);return a&&t.view&&t.view.data(a.name)||h(e)||[]}function y(e){const t={parse:"auto",type:null};let n;try{return t.type="json",{format:t,values:c.read(e,t)}}catch(a){if(t.type="csv",n=c.read(e,t),Object.keys(n[0]).length>1)return{format:t,values:n};if(t.type="tsv",n=c.read(e,t),Object.keys(n[0]).length>1)return{format:t,values:n};throw Error("Raw data is in an unsupported format. Only JSON, CSV, or TSV may be imported.")}}function v(e){if(c.isNumber(e))throw Error("Dataset schemas are now available in the store.");if(c.isArray(e)){const t=c.type.inferAll(e);return c.keys(t).reduce(function(e,n){return e.set(n,i.Column({name:n,type:t[n],mtype:l[t[n]],source:!0}))},a.Map())}throw Error("Expected an array of raw values.")}function _(e,t){const n=t.groupby.reduce((t,n)=>t.set(n,e.get(n)),a.Map());return r.array(t.as).reduce((e,t)=>e.set(t,i.Column({name:t,type:"number",mtype:l.number,source:!1})),n)}t.init=u,t.reset=m,t.persist=g,t.input=h,t.output=f,t.parseRaw=y,t.schema=v,t.aggregateSchema=_,e.exports={init:u,reset:m,persist:g,input:h,output:f,parseRaw:y,schema:v,aggregateSchema:_}},225:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(313),s=n(167),i=n(877);t.addWidget=function(e){return function(n,a){const o=e.id||s.assignId(n,a());(e=e.merge({id:o})).get("name")||(e=e.set("name",i.recordName(a(),"widgets","Widget"))),n(t.baseAddWidget(e,o)),n(r.addWidgetToGroup(o,e.groupId))}},t.baseAddWidget=a.createStandardAction("ADD_WIDGET")(),t.setSelection=a.createStandardAction("SET_WIDGET_SELECTION")(),t.setApplication=a.createStandardAction("SET_WIDGET_APPLICATION")(),t.removeApplication=a.createStandardAction("REMOVE_WIDGET_APPLICATION")(),t.setSignals=a.createStandardAction("SET_WIDGET_SIGNALS")(),t.deleteWidget=a.createStandardAction("DELETE_WIDGET")(),t.updateWidgetName=a.createStandardAction("UPDATE_WIDGET_NAME")()},266:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47);t.initSignal=a.createStandardAction("INIT_SIGNAL")(),t.setSignal=a.createStandardAction("SET_SIGNAL")(),t.setSignalStreams=a.createStandardAction("SET_SIGNAL_STREAMS")(),t.unsetSignal=a.createStandardAction("UNSET_SIGNAL")()},267:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(266),r=n(202),s=n(90),i=n(221),o=n(40).getInVis;function l(){return o(r.store.getState(),"signals").toJS()}function c(e){return s.signalNames.includes(e)}t.api=l,l.init=function(e,t){r.store.dispatch(a.initSignal(t,e))},l.reference=function(e){return{signal:i(e)}},l.isDefault=c,l.get=function(e){let t,a=n(72).view,s=function(e){return o(r.store.getState(),"signals."+i(e))}(e);return a&&"function"==typeof a.signal&&(t=a.signal(i(e))),t||s.get("value")},l.set=function(e,t,s){void 0===s&&(s=!0);const o=n(72).view;c(e)||!1===s||r.store.dispatch(a.setSignal(t,e)),o&&"function"==typeof o.signal&&o.signal(i(e),t)},l.delete=function(e){r.store.dispatch(a.unsetSignal(null,e))},l.streams=function(e,t){r.store.dispatch(a.setSignalStreams(e,t))},t.default=l,window.sg=l},268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.EncodingState=a.Record({selectedId:null,selectedType:null,expandedLayers:{}},"LyraEncodingState"),t.FieldDraggingState=a.Record({dsId:null,fieldDef:null},"LyraFieldDraggingState"),t.SignalDraggingState=a.Record({interactionId:null,signal:null},"LyraSignalDraggingState"),t.ScaleDraggingState=a.Record({scaleId:null,fieldName:null},"LyraScaleDraggingState"),t.Inspector=a.Record({pipelines:{selectedId:null},encodings:t.EncodingState(),dragging:null},"LyraInspector")},27:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),r=n(90),s=n(309),i=n(222),o=n(221);t.default=function(e,t){const n=`${i.default(e.name)}_manipulators`,a=`peek(data("${n}"))`,s=Object.keys(e.encode.update).filter(e=>"text"!==e).map(t=>e.encode.update[t]).filter(e=>e&&!!e.signal).map(e=>({signal:e.signal}));return[t,{type:"group",data:[{name:n,transform:[{type:o("manipulators_"+e.type),lyra_id:e._id,lyra_selected:{signal:r.SELECTED},lyra_mode:{signal:r.MODE},signals:s},{type:"window",ops:["min","max","min","max"],fields:["x","x","y","y"]}]},{name:"voronoi",source:n,transform:[{type:"voronoi",x:"x",y:"y",as:"lyra_cell_path",extent:[{signal:`data("${n}")[0] ? [${a}.min_x - 100, ${a}.min_y - 50] : [0, 0]`},{signal:`data("${n}")[0] ? [${a}.max_x + 100, ${a}.max_y + 50] : [0, 0]`}]}]},p("handle",n),p("connector",n),p("arrow",n),p("span",n),p("border",n)],marks:[m,g,h("arrow"),h("span"),u(t),d]}]},t.LARGE=40,t.SMALL=20,t.PADDING=7,t.ARROWHEAD=7,t.coords=function(e,t){const n={topLeft:{x:e.x1,y:e.y1,cursor:"nw-resize"},topCenter:{x:e.x1+e.width()/2,y:e.y1,cursor:"n-resize"},topRight:{x:e.x2,y:e.y1,cursor:"ne-resize"},midLeft:{x:e.x1,y:e.y1+e.height()/2,cursor:"w-resize"},midCenter:{x:e.x1+e.width()/2,y:e.y1+e.height()/2,cursor:"move"},midRight:{x:e.x2,y:e.y1+e.height()/2,cursor:"e-resize"},bottomLeft:{x:e.x1,y:e.y2,cursor:"sw-resize"},bottomCenter:{x:e.x1+e.width()/2,y:e.y2,cursor:"s-resize"},bottomRight:{x:e.x2,y:e.y2,cursor:"se-resize"}};if(t)for(const[r,s]of Object.entries(n))n[r]=a.extend({},{size:l(e),key:r,manipulator:t},s);return n};const l=e=>e.width()<t.SMALL||e.height()<t.SMALL?t.SMALL:t.LARGE,c=(e,t)=>[Object.assign({test:`${r.CELL}.key === datum.key`},e),t],p=(e,t)=>({name:e,source:t,transform:[{type:"filter",expr:`datum.manipulator === "${e}"`}]}),d={type:"path",from:{data:"voronoi"},role:r.CELL,encode:{update:{path:{field:"lyra_cell_path"},key:{field:"key"},tooltip:{field:"tooltip"},strokeWidth:{value:.35},stroke:{value:"transparent"},fill:[{test:'datum.manipulator === "handle"',value:null},{value:"transparent"}]},hover:{cursor:[{test:'datum.manipulator === "handle"',field:"cursor"},{value:null}]}}};function u(e){const t=s.default(e.encode.update),n=e.type,a="line"===n||"area"===n;for(const e of Object.keys(t))t[e]={field:e};return delete t.fill,t.stroke=c({value:"lightsalmon"},{value:"cyan"}),t.strokeWidth={value:"text"===n?1:3},a&&(delete t.x,delete t.y,t.path={field:"path"}),{type:a?"path":n,role:"border",from:{data:"border"},encode:{update:t}}}const m={type:"symbol",from:{data:"handle"},role:"handle",encode:{update:{x:{field:"x"},y:{field:"y"},shape:{value:"square"},size:{field:"size"},fill:{value:"white"},stroke:{value:"black"},strokeWidth:{value:.5}},hover:{cursor:{field:"cursor"}}}},g={type:"symbol",from:{data:"connector"},role:"connector",encode:{update:{x:{field:"x"},y:{field:"y"},shape:{value:"diamond"},size:{field:"size"},fill:{value:"white"},stroke:c({value:"lightsalmon"},{value:"cyan"}),strokeWidth:{value:.5}}}},h=e=>({type:"group",role:e,from:{facet:{data:e,name:"facet",groupby:"key"}},marks:[{type:"line",from:{data:"facet"},encode:{update:{x:{field:"x"},y:{field:"y"},fill:c({value:"lightsalmon"},{value:"cyan"}),stroke:c({value:"lightsalmon"},{value:"cyan"}),strokeWidth:{value:3}}}}]});t.BUBBLE_CURSOR={type:"line",from:{data:"bubble_cursor"},interactive:!1,encode:{update:{x:{field:"x"},y:{field:"y"},fill:{value:"lightsalmon"},fillOpacity:{value:.2}}}},t.BUBBLE_CURSOR_TIP=[{type:"text",interactive:!1,encode:{update:{x:{signal:`${r.MOUSE}.x`},y:{signal:`${r.MOUSE}.y`},dy:{value:35},text:{signal:`${r.CELL}.tooltip`},align:{value:"center"},baseline:{value:"bottom"},stroke:{value:"white"},strokeWidth:{value:4},fontSize:{value:12},fontFamily:{value:"Lato"},fontWeight:{value:"bold"}}}},{type:"text",interactive:!1,encode:{update:{x:{signal:`${r.MOUSE}.x`},y:{signal:`${r.MOUSE}.y`},dy:{value:35},text:{signal:`${r.CELL}.tooltip`},align:{value:"center"},baseline:{value:"bottom"},fill:{value:"lightsalmon"},fontSize:{value:12},fontFamily:{value:"Lato"},fontWeight:{value:"bold"}}}}]},308:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r={x:"bottom",y:"left"};var s;!function(e){e.Axis="axis",e.Legend="legend"}(s=t.GuideType||(t.GuideType={})),function(e){e.fill="fill",e.opacity="opacity",e.shape="shape",e.size="size",e.stroke="stroke",e.strokeDash="strokeDash"}(t.LegendForType||(t.LegendForType={})),t.Axis=a.Record({_gtype:s.Axis,_id:null,orient:null,scale:null,tickCount:null,tickSize:null,grid:!1,title:null,zindex:0,encode:{}},"LyraAxis"),t.Legend=a.Record({_id:null,_type:null,_gtype:s.Legend,fill:null,opacity:null,shape:null,size:null,stroke:null,strokeWidth:null,strokeDash:null,symbolFillColor:"#ffffff",symbolOpacity:1,strokeColor:"#ffffff",encode:{}},"LyraLegend"),t.Guide=function(e,n,a){const i=a._id?String(a._id):String(a);return e===s.Axis?t.Axis({orient:r[n],scale:i}):e===s.Legend?t.Legend({_type:n,[n]:i,encode:{}}):void 0},t.isAxis=function(e){return e&&e._gtype===s.Axis},t.isLegend=function(e){return e&&e._gtype===s.Legend}},309:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return JSON.parse(JSON.stringify(e))}},310:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(592),r=n(303),s=n(47),i=n(92),o=n(67),l=n(202),c=n(90),p=n(267),d=(n(1140),n(72));e.exports={onSignal:g,offSignal:h,onSignalInGroup:y,offSignalInGroup:v,setSignalInGroup:_,getSignalInGroup:b,register:x};const u={},m={};function g(e,t){return u[e]=u[e]||[],u[e].push(t),d.view&&d.view.addSignalListener(e,t),d}function h(e,t){u[e]=u[e]||[];const n=u[e];for(let e=n.length;--e>=0;)t&&n[e]!==t||n.splice(e,1);return d.view&&d.view.removeSignalListener(e,t),d}function f(e,t,n){const a=e._scenegraph.root.items[0];for(const e of a.items)if(e.name&&"group"===e.marktype&&e.name===t&&e.items&&e.items.length){const t=e.items[0].context.signals;for(const e of Object.keys(t))if(e===n)return t[e]}return null}function y(e,t,n,a){const r=f(e,t,n);if(r){const s=function(){a(n,r.value)};s.handler=a,m[t]=m[t]||{},m[t][n]=m[t][n]||[],m[t][n].push({operator:r,handler:s}),e.on(r,null,s)}}function v(e,t,n,a){if(f(e,t,n)){m[t]=m[t]||{},m[t][n]=m[t][n]||[];const e=m[t][n];for(let t=e.length;--t>=0;)a&&e[t].handler!==a||(e[t].operator._targets.remove(a),e.splice(t,1))}}function _(e,t,n,a){const r=f(e,t,n);e.update(r,a),e.runAsync()}function b(e,t,n){const a=f(e,t,n);return a?a.value:null}function x(){const e=a.select(window);e.on("dragover.altchan")||e.on("dragover.altchan",function(){const e=p.default.get(c.MODE),t=a.event.shiftKey,n="channels"===e,r="altchannels"===e;(n||r)&&(n&&t?(p.default.set(c.MODE,"altchannels"),d.update()):r&&!t&&(p.default.set(c.MODE,"channels"),d.update()))}),d.view&&(Object.keys(u).forEach(function(e){d.view._signals[e]?u[e].forEach(function(t){d.view.addSignalListener(e,t)}):u[e]=[]}),Object.keys(m).forEach(function(e){Object.keys(m[e]).forEach(function(t){f(d.view,e,t)?m[e][t].forEach(function(e){d.view.on(e.operator,null,e.handler)}):m[e][t]=[]})}))}function S(e){const t=e.srcElement||e.target,n=t.tagName.toUpperCase();return("INPUT"===n||"TEXTAREA"===n||"true"===t.contentEditable)&&(!t.readOnly&&!t.disabled)}a.select(window).on("keydown",function(){const e=a.event;window._inputKeyboard={keycode:e.keyCode,_key:e.key},function(e){const t=e.keyCode;if(!S(e)&&!0===e.metaKey||!0===e.ctrlKey){if(89===t)return l.store.dispatch(r.ActionCreators.redo()),e.preventDefault(),!1;if(90===t)l.store.dispatch(e.shiftKey?r.ActionCreators.redo():r.ActionCreators.undo()),e.preventDefault()}}(e),function(e){if(!S(e)&&8===e.keyCode){const t=l.store.getState(),n=t.getIn(["inspector","encodings"]),a=n.get("selectedType"),r=n.get("selectedId"),c=t.getIn(["vis","present","marks",String(r),"_parent"]);if(a===s.getType(i.baseSelectMark))e.preventDefault(),l.store.dispatch(i.selectMark(c)),l.store.dispatch(o.deleteMark(r))}}(e)}).on("keyup",function(){window._inputKeyboard=null}).on("beforeunload",function(){{const e="You have unsaved changed in Lyra.";return a.event.returnValue=e,e}}),t.onSignal=g,t.offSignal=h,t.onSignalInGroup=y,t.offSignalInGroup=v,t.setSignalInGroup=_,t.getSignalInGroup=b,t.registerSignalListeners=x},311:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(40).getInVis;const a=n(47),r=n(371),s=n(581),i=n(224),o=n(156),l=n(92),c=n(167);t.addPipeline=function(e,n,a){return function(r,s){const i=e._id||c.assignId(r,s()),p=c.assignId(r,s()),d=n.merge({_id:p,name:`${e.name}_source_${p}`,_parent:i});r(o.addDataset(d,a)),r(t.baseAddPipeline(e.merge({_id:i,_source:p}),i)),r(l.selectPipeline(i))}},t.derivePipeline=function(e){return function(n,a){const i=a(),p=i.getIn(["vis","present","pipelines",String(e)]),d=p._source,u=i.getIn(["vis","present","datasets",String(d),"_schema"]),m=c.assignId(n,a()),g=c.assignId(n,a()),h=r.Dataset({_id:m,name:p.get("name")+"_derived_"+m,source:String(d),transform:[],_schema:u,_parent:g}),f=s.Pipeline({_id:g,name:`${p.name}_derived`,_source:m});n(t.baseAddPipeline(f,g)),n(o.addDataset(h,null)),n(l.selectPipeline(g))}},t.aggregatePipeline=function(e,n){return function(a,s){const l=s(),p=l.getIn(["vis","present","pipelines",String(e)]),d=p._source,u=l.getIn(["vis","present","datasets",String(d),"_schema"]),m=i.aggregateSchema(u,n),g=n.groupby.join("|"),h=c.assignId(a,s()),f=r.Dataset({_id:h,name:p.get("name")+"_groupby_"+g,source:String(d),transform:[n],_schema:m,_parent:e});a(o.addDataset(f,null)),a(t.baseAggregatePipeline({dsId:n._id=h,key:g},e))}},t.baseAddPipeline=a.createStandardAction("ADD_PIPELINE")(),t.baseAggregatePipeline=a.createStandardAction("AGGREGATE_PIPELINE")(),t.updatePipelineProperty=a.createStandardAction("UPDATE_PIPELINE_PROPERTY")()},312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(167);t.addScale=function(e){return function(n,a){const s=e._id||r.assignId(n,a());n(t.baseAddScale(e.merge({_id:s}),s))}},t.baseAddScale=a.createStandardAction("ADD_SCALE")(),t.updateScaleProperty=a.createStandardAction("UPDATE_SCALE_PROPERTY")(),t.amendDataRef=a.createStandardAction("AMEND_DATA_REF")(),t.deleteScale=a.createStandardAction("DELETE_SCALE")()},313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47);t.addScaleToGroup=a.createStandardAction("ADD_SCALE_TO_GROUP")(),t.addAxisToGroup=a.createStandardAction("ADD_AXIS_TO_GROUP")(),t.addLegendToGroup=a.createStandardAction("ADD_LEGEND_TO_GROUP")(),t.addInteractionToGroup=a.createStandardAction("ADD_INTERACTION_TO_GROUP")(),t.addWidgetToGroup=a.createStandardAction("ADD_WIDGET_TO_GROUP")()},314:function(e,t,n){"use strict";var a=n(17),r=n(378),s=n(116),i=n(602)({displayName:"ContentEditable",propTypes:{value:s.oneOfType([s.string,s.number]),save:s.func},getInitialState:function(){return{edit:!1}},componentDidMount:function(){this._el=r.findDOMNode(this)},componentDidUpdate:function(){this.state.edit&&this._el.focus()},componentWillUnmount:function(){this._el=null},start:function(){this.setState({edit:!0})},stop:function(){this.setState({edit:!1}),this.props.save&&this.props.save(this._el.textContent.trim())},handleEnter:function(e){(!e.keyCode||e.keyCode&&13===e.keyCode)&&this._el.blur()},render:function(){var e=this.props;return a.createElement("div",{style:e.style,className:(e.className||"")+" content-editable",contentEditable:this.state.edit,onClick:e.onClick||this.start,onDoubleClick:e.onDoubleClick||this.start,onBlur:this.stop,onKeyDown:this.handleEnter},e.value)}});e.exports=i},368:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),r=n(90),s=n(222);t.default=function(e,t,n){const i=`${r.ANCHOR}.target`;let o=`(${r.ANCHOR} && ${i} && ${i}.datum && `;return`${o+=n?`${i}.datum.mode === ${a.stringValue(t)}  && `+`${i}.datum.lyra_id === ${e._id} && `+`test(regexp(${a.stringValue(n)}, "i"), ${i}.datum.key)`:`${i}.mark && ${i}.mark.name === ${a.stringValue(s.default(e.name))}`})`}},369:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return"if("+e+","+t+","+n+")"}},371:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.Column=a.Record({name:null,type:null,mtype:null,source:null},"ColumnDescription"),t.Dataset=a.Record({_id:null,_parent:null,_schema:null,name:null,source:null,transform:[]},"LyraDataset")},372:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.PointSelection=a.Record({type:"point",ptype:null,id:null,label:null,field:null,encoding:null},"LyraPointSelection"),t.IntervalSelection=a.Record({type:"interval",id:null,label:null,encoding:null},"LyraIntervalSelection"),t.MarkApplication=a.Record({type:"mark",id:null,label:null,targetMarkName:null,propertyName:null,unselectedValue:null},"LyraMarkApplication"),t.ScaleApplication=a.Record({type:"scale",id:null,label:null,scaleInfo:null},"LyraScaleApplication"),t.TransformApplication=a.Record({type:"transform",id:null,label:null,targetGroupName:null,datasetName:null,targetMarkName:null},"LyraTransformApplication"),t.Interaction=a.Record({id:null,name:null,groupId:null,input:null,selection:null,applications:[],signals:[]},"LyraInteraction")},375:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(202),r=n(30).Bounds,s=n(40).getInVis;function i(e,t){return t=t||a.store.getState(),s(t,"marks."+e._parent)||null}function o(e,t){if(!e)return[];let n=e.get("_parent")&&i(e,t);if(!n)return[];const a=[n];for(;n&&n._parent;)(n=i(n,t))&&a.push(n);return a}function l(e){return e.reduce(function(e,t){return"group"===t.get("type")&&e.push(t.get("_id")),e},[])}function c(e,t){return t=t||a.store.getState(),l(o(s(t,"marks."+e),t))}function p(e,t){t=t||a.store.getState();const n=e||t.getIn(["inspector","encodings","selectedId"]);let r=s(t,"marks."+n);if(!r){const e=t.getIn(["vis","present","interactions",String(n)]);if(e&&e.groupId)return e.groupId;const a=t.getIn(["vis","present","widgets",String(n)]);return a&&a.groupId?a.groupId:s(t,"scene._id")}return"group"===r.get("type")||"scene"===r.get("type")?r.get("_id"):p(r.get("_parent"),t)}t.getParentGroupIds=c,t.getClosestGroupId=p,e.exports={getParent:i,getParentGroupIds:c,getParents:o,getGroupIds:l,getClosestGroupId:p,findInItemTree:function(e,t){const n=document.querySelector(".vis-container"),a={x:0,y:0};let s,i,o,l=+Number.MAX_VALUE,c=+Number.MAX_VALUE;for(let n=t.length-1;n>=0;--n){const r=t[n];a.x+=+e.x||0,a.y+=+e.y||0;for(let t=e.items,n=0,a=t.length;n<a&&null===(e=(o=t[n].role)&&+o.split("lyra_")[1]===r?t[n].items[0]:null);++n);if(null===e)break}const p=new r({x1:n.scrollLeft,x2:300+n.scrollLeft,y1:n.scrollTop,y2:200+n.scrollTop});if(e&&e.mark.items.length>1)for(let t=0,n=e.mark.items,a=n.length;t<a;++t){const a=(e=n[t]).bounds,r=a&&(a.x1<l||a.y1<c);if(!a)break;if(p.encloses(a)){i=s=null;break}p.intersects(a)&&r?(s=e,l=a.x1,c=a.y1):r&&(i=e,l=a.x1,c=a.y1)}return s||i||e}}},376:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(1142),r=n(420),s=n(309),i=n(67),o=n(1144),l=n(1145),c=n(1146),p=n(1147),d=n(1148),u=n(595),m=n(40).getInVis,g=n(224),h={rect:"bar",symbol:"circle",text:"text",line:"line",area:"area"};function f(e){switch(e){case"x":case"x+":case"x2":case"width":return"x";case"y":case"y+":case"y2":case"height":return"y";case"fill":case"stroke":return"color";case"text":case"detail":return e}}t.CELLW=517,t.CELLH=392,t.default=function(e,n,u,v){return function(_,b){const x=b(),S=m(x,"marks."+u),E=S.type,w=function(e){return e._vlUnit||{mark:h[e.type],data:{values:[]},encoding:{},config:{}}}(S),k=(A=w)._lyraMap||(A._lyraMap={data:{},scales:{},axes:{},legends:{},marks:{}}),I=f(v),T=m(x,"datasets."+e+"._parent");var A;const N=S.from;if(N&&N.data&&m(x,`datasets.${N.data}._parent`)!==T)throw Error("Mark and field must be from the same pipeline.");r.batchGroupBy.start(),w.encoding[I]=function(e){const t=e.name,n=e.aggregate,a=e.bin,r={type:e.mtype};let s;return n||(s=y.agg.exec(t))?r.aggregate=s?s[1]:n:(a||(s=y.bin.exec(t)))&&(r.bin=!0),r.field=s?s[2]:t,r}(n);const O=function(e,n,r){return(e=s.default(e)).data.values=g.output(r),e.config.view={width:t.CELLW,height:t.CELLH},e.config.mark={filled:"fill"===n},{input:e,output:a.compile(e).spec}}(w,v,e);O.map=k,O.mark=S,O.markId=u,O.markType=E,O.property=v,O.channel=I,O.dsId=e,O.plId=T,l.default(_,x,O),d.default(_,x,O),p.default(_,x,O),o.default(_,x),c.default(_,b(),O),_(i.setVlUnit(w,u)),r.batchGroupBy.end()}},t.channelName=f;const y={agg:new RegExp("^("+u.join("|")+")_(.*?)$"),bin:new RegExp("^(bin)_(.*?)(_start|_mid|_end)$")}},40:function(e,t,n){"use strict";var a=n(43);function r(e){return""+e}function s(e){return e.split(".")}function i(e,t){if(e)return e.getIn(s(t))}function o(e,t,n){return e.setIn(s(t),n)}e.exports={get:function(e,t){if(e)return e.get(r(t))},set:function(e,t,n){return e.set(r(t),n)},getIn:i,getInVis:function(e,t){return i(e.get("vis").present,t)},setIn:o,deleteKeyFromMap:function(e,t){return e.delete(r(t))},ensureValuePresent:function(e,t,n){var r=i(e,t);return r&&a.List.isList(r)&&r.indexOf(n)<0?o(e,t,r.push(n)):e},ensureValueAbsent:function(e,t,n){var r=i(e,t);return r&&a.List.isList(r)&&r.indexOf(n)>=0?o(e,t,r.filter(function(e){return e!==n})):e},str:r}},420:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(303),r=n(47),s=n(156),i=n(201),o=n(266);t.batchGroupBy={_group:[],start(){return this._group.push(Date.now())},end(){return this._group.pop()},init(e){const t=a.groupByActionTypes(e);return e=>this._group.length?this._group.join("|"):t(e)}},t.default={limit:15,filter:function(e){return e.type!==r.getType(s.baseAddDataset)},groupBy:t.batchGroupBy.init([r.getType(o.setSignal),r.getType(i.updateGuideProperty)])}},421:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(853),r=n(855),s=n(856),i=n(857),o=n(422),l=n(580),c={encode:{update:{x:{value:100},y:{value:100},fill:{value:"#4682b4"},fillOpacity:{value:1},stroke:{value:"#000000"},strokeWidth:{value:0}}}};function p(e,t){switch(e){case"symbol":return o.Symbol(t).mergeDeepWith(d,c);case"area":return a.Area(t).mergeDeepWith(d,c);case"line":return s.Line(t).mergeDeepWith(d,{encode:{update:Object.assign(Object.assign({},c.encode.update),{fill:void 0,fillOpacity:void 0})}});case"rect":return i.Rect(t).mergeDeepWith(d,c);case"text":return l.Text(t).mergeDeepWith(d,c);case"group":return r.Group(t).mergeDeepWith(d,c)}}t.Mark=p;const d=(e,t)=>void 0!==e?null===e?void 0:e:t;p.getHandleStreams=function(e){switch(e.type){case"symbol":return o.getHandleStreams(e);case"area":return a.getHandleStreams(e);case"line":return s.getHandleStreams(e);case"text":return l.getHandleStreams(e);case"group":case"rect":return i.getHandleStreams(e)}}},422:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(368),s=n(168),i=n(369),o=n(90);t.Symbol=a.Record({_id:null,_parent:null,_vlUnit:null,type:"symbol",name:null,from:null,encode:{update:{size:{value:200},shape:{value:"circle"}}}},"LyraSymbolMark"),t.SymbolShapes=["circle","square","cross","diamond","triangle-up","triangle-down"],t.getHandleStreams=function(e){const t=r.default.bind(null,e,"handles"),n=e._id,a=s.propSg(n,"symbol","x"),l=s.propSg(n,"symbol","y"),c=s.propSg(n,"symbol","size"),p=`${o.DELTA}.x`,d=`${o.DELTA}.y`;return{[a]:[{events:{signal:o.DELTA},update:i.default(t(),`${a} + ${p}`,a)}],[l]:[{events:{signal:o.DELTA},update:i.default(t(),`${l} + ${d}`,l)}],[c]:[{events:{signal:o.DELTA},update:i.default(t("top"),`${c} - (${d} << 5)`,c)},{events:{signal:o.DELTA},update:i.default(t("bottom"),`${c} + (${d} << 5)`,c)}]}}},423:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(1102),r=n(47),s=n(202),i=n(371),o=n(308),l=n(372),c=n(853),p=n(855),d=n(856),u=n(857),m=n(580),g=n(859),h=n(422),f=n(581),y=n(860),v=n(90),_=n(224),b=n(268),x=n(597),S=n(598),E=n(599),w=a.withRecords([h.Symbol,c.Area,d.Line,u.Rect,m.Text,p.Group,g.Scene,i.Column,i.Dataset,o.Axis,o.Legend,f.Pipeline,v.Signal,b.EncodingState,b.FieldDraggingState,b.SignalDraggingState,b.ScaleDraggingState,b.Inspector,l.Interaction,l.IntervalSelection,l.PointSelection,l.MarkApplication,l.ScaleApplication,l.TransformApplication,S.Widget,S.WidgetSelection,x.LyraGlobals,E.VegaReparse],(e,t)=>{switch(e){case"LyraScale":return y.Scale(t);default:return null}});t.persist=function(){const e=s.store.getState();return{store:{vis:w.toJSON(e.vis.present),inspector:w.toJSON(e.inspector),lyra:w.toJSON(e.lyra)},values:_.persist()}},t.hydrate=r.createStandardAction("HYDRATE").map(e=>{const t=JSON.parse(e);return _.persist(t.values),{payload:{vis:w.fromJSON(t.store.vis),inspector:w.fromJSON(t.store.inspector),lyra:w.fromJSON(t.store.lyra)}}}),t.hydrator=function(e,n){return(a,s)=>s.type===r.getType(t.hydrate)?s.payload[n]:e(a,s)}},48:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return function(a){return a.key=e,a.manipulator=t,a.tooltip=n||e,a}}},580:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(368),s=n(168),i=n(369),o=n(90);t.Text=a.Record({_id:null,_parent:null,_vlUnit:null,type:"text",name:null,from:null,encode:{update:{dx:{value:0,offset:0},dy:{value:0,offset:0},text:{signal:"Text"},align:{value:"center"},baseline:{value:"middle"},font:{value:"Helvetica"},fontSize:{value:12},fontStyle:{value:"normal"},fontWeight:{value:"normal"},angle:{value:0}}}},"LyraTextMark"),t.getHandleStreams=function(e){const t=r.default.bind(null,e,"handles"),n=e._id,a=s.propSg(n,"text","x"),l=s.propSg(n,"text","y"),c=s.propSg(n,"text","fontSize"),p=`${o.DELTA}.x`,d=`${o.DELTA}.y`;return{[a]:[{events:{signal:o.DELTA},update:i.default(t(),`${a} + ${p}`,a)}],[l]:[{events:{signal:o.DELTA},update:i.default(t(),`${l} + ${d}`,l)}],[c]:[{events:{signal:o.DELTA},update:i.default(`${t("left")} && ${t("top")}`,`${c} - ${p}`,c)},{events:{signal:o.DELTA},update:i.default(`${t("right")} && ${t("bottom")}`,`${c} + ${p}`,c)},{events:{signal:o.DELTA},update:i.default(`${t("left")} && ${t("top")}`,`${c} - ${d}`,c)},{events:{signal:o.DELTA},update:i.default(`${t("right")} && ${t("bottom")}`,`${c} + ${d}`,c)}]}},t.TextAlignments=["left","center","right"],t.TextBaselines=["top","middle","bottom"],t.TextFonts=["Helvetica","Verdana","Georgia","Palatino","Garamond","Trebuchet MS"],t.TextFontStyles=["normal","italic"],t.TextFontWeights=["normal","bold"]},581:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.Pipeline=a.Record({_id:null,name:null,_source:null,_aggregates:a.Map()},"LyraPipeline")},590:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),r=n(591),s=n(202),i=n(308),o=n(224),l=n(309),c=n(222),p=n(222),d=n(168),u=n(1127),m=n(157),g=n(27),h=n(1128),f=n(40),y=f.getIn,v=f.getInVis,_=n(1138),b={data:{},scales:{},_totaled:!1},x={marks:{},scales:{}},S={marks:{},guides:{}};let E=l.default(b);function w(e=!1){const t=s.store.getState(),n=!0===e;E=l.default(b);let a=w.scene(t,n);return a.data=w.pipelines(t,n),a=w.interactions(t,a),a=w.widgets(t,a)}function k(e,t,n){return{name:"pathgroup",type:"group",from:{facet:Object.assign(Object.assign({},n),{data:c.default(v(e,"datasets."+n.data+".name"))})},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:a.array(t)}}function I(e,t){const n=e.encode.update,a=r.default[t];if(!n[a.SPAN.name]._disabled)return u.signalLookup(n[a.SPAN.name].signal)}function T(e,t){let n;for(const[r,s]of Object.entries(e))(n=(n=r.startsWith("_"))||null==s||s._disabled)?delete e[r]:"name"===r&&a.isString(s)?e[r]=c.default(s):a.isObject(s)&&(s.signal&&!t?s.signal.startsWith("lyra")&&(e[r]=u.signalLookup(s.signal)):e[r]=T(e[r],t));return e}function A(e){let t,n;if(e)w();else if(E._totaled)return E;for(t in E.data)(n=E.data[t]).total=Object.keys(n.marks).length+Object.keys(n.scales).length;for(t in E.scales)(n=E.scales[t]).markTotal=Object.keys(n.marks).length,n.guideTotal=Object.keys(n.guides).length,n.total=n.markTotal+n.guideTotal;return E._totaled=!0,E}function N(e,t,n){let a,r,s,i,o,l,c={};if(1===n.length)return n=n[0],O(a=v(e,"datasets."+n.data),t,n.field);for(i=0,o=n.length;i<o;++i)a=v(e,"datasets."+n[i].data),s=n[i].field,c[r=a.get("_id")]=c[r]||(c[r]=[]),c[r].push(s);if(1===(l=Object.keys(c)).length)return O(a,t,c[r]);for(n={fields:[]},i=0,o=l.length;i<o;++i)a=v(e,"datasets."+l[i]),n.fields.push(O(a,t,c[l[i]]));return n}function O(e,t,n){const r={data:c.default(e.get("name")),field:n};if("ordinal"===t.type&&e.get("_sort")){const t=y(e,"_sort.field");return a.extend({},r,{sort:t===r.field||{field:t,op:"min"},_sortOrder:y(e,"_sort.order")})}const s=e.get("_id");return(E.data[s]||(E.data[s]=l.default(x))).scales[t._id]=!0,r}t.exporter=w,w.interactions=function(e,t){return e.getIn(["vis","present","interactions"]).forEach(n=>{const a=e.getIn(["vis","present","marks",String(n.groupId)]),r=p.default(a.name),s=m.getScaleInfoForGroup(e,a._id),i=a._interactions.map(t=>{const n=e.getIn(["vis","present","interactions",String(t)]);return n.input?n.input.mouse:null}).filter(e=>e),o=new Set(i).size!==i.length;if(t=m.addDatasetsToScene(t,r,n.id),t=m.addInputsToScene(t,r,n.id,n.input,s,o),n.selection&&(t=m.addSelectionToScene(t,r,n.id,n.input,n.selection)),n.applications.length)for(const e of n.applications)if(t=m.addApplicationToScene(t,r,n.id,n.input,e),n.input&&n.input.mouse&&"mouseover"===n.input.mouse&&n.input.nearest){const a=e.targetMarkName;if(a){const s=n.selection&&"point"===n.selection.type?n.selection.encoding:null;t=m.addVoronoiMark(t,r,s,a,n.id,e.id)}}t=m.pushSignalsInScene(t,r,n.signals)}),t},w.widgets=function(e,t){return e.getIn(["vis","present","widgets"]).forEach(n=>{const a=e.getIn(["vis","present","marks",String(n.groupId)]),r=p.default(a.name);if(n.selection&&(t=m.addWidgetSelectionToScene(t,n,n.selection)),n.applications.length)for(const e of n.applications)t=m.addWidgetApplicationToScene(t,r,n,e)}),t},w.pipelines=function(e,t){return v(e,"pipelines").valueSeq().reduce(function(n,a){n.push(w.dataset(e,t,a._source));const r=a._aggregates.toJS();for(const a in r)n.push(w.dataset(e,t,r[a]));return n},[])},w.dataset=function(e,t,n){const a=v(e,"datasets."+n).toJS(),r=T(l.default(a),t),s=o.input(n),i=r.format&&r.format.type,p=w.sort(a);return E.data[n]=E.data[n]||l.default(x),r.source?r.source=c.default(v(e,"datasets."+r.source+".name")):t?(r.values=s,delete r.url,delete r.format):r.url||(r.values=i&&"json"!==i?h({data:s,del:"tsv"===i?"\t":","}):s),void 0!==p&&(r.transform=r.transform||[],r.transform.push(p)),r},w.sort=function(e){const t=e._sort;if(t)return{type:"sort",by:(t.order===_.DESC?"-":"")+t.field}},w.scene=function(e,t){const n=e.getIn(["vis","present","scene","_id"]);let a=w.group(e,t,n);return t&&(a=a[0]),delete a.from,delete a.encode,a},w.mark=function(e,t,n){const r=v(e,"marks."+n).toJS(),s=T(l.default(r),t),i=r.encode.update,o=s.encode.update,p=r._facet;if(p)s.from={data:p.name};else if(s.from){let t;if(t=s.from.data){s.from.data=c.default(v(e,"datasets."+t+".name")),(E.data[t]||(E.data[t]=l.default(x))).marks[n]=!0}else(t=s.from.mark)&&(s.from.mark=c.default(v(e,"marks."+t+".name")))}if(Object.keys(o).forEach(function(t){let r=o[t];const s=i[t],p=s.scale;if(a.isObject(r)||(r=o[t]={value:r}),p){r.scale=c.default(v(e,"scales."+p+".name")),(E.scales[p]||(E.scales[p]=l.default(S))).marks[n]=!0}s.group&&(r.field={group:s.group},delete r.group)}),"text"===s.type){let e=s.encode.update.text.signal;e&&!e.startsWith("brush")&&(e=e.split(RegExp("{{(.*?)}}")).map(e=>e.indexOf("datum")>=0?`+ ${e} + `:e.startsWith("#")?`+ ${e.substring(1)} + `:`"${e}"`).join(""),s.encode.update.text.signal=e)}if(t){s.role=`lyra_${r._id}`;const t=g.default(r,s);return p?k(e,t,p):t}return p?k(e,s,p):s},w.group=function(e,t,n){const r=v(e,`marks.${n}`),s=w.mark(e,t,n),i=t?s[0]:s;return["scale","mark","axe","legend"].forEach(function(n){const s=n+"s",o="axes"===s||"legends"===s?"guides":s;i[s]=r[s].map(a=>{const r=v(e,`${o}.${a}`);return r?w[r.type]?w[r.type](e,t,a):w[n]?w[n](e,t,a):T(l.default(r.toJS()),t):null}).reduce((e,t)=>(a.isArray(t)?e.push.apply(e,t):t&&e.push(t),e),[])}),"Scene"!==r.name&&(i.signals=i.signals||[],i.signals.push({name:"width",value:I(r,"x")},{name:"height",value:I(r,"y")})),s},w.area=function(e,t,n){const r=w.mark(e,t,n),s=a.array("pathgroup"===r.name?r.marks:r)[0],i=s.encode.update;return s.from||(s.from={data:"dummy_data"},i.x={signal:`datum.x + ${d.propSg(n,"area","x")}`},i.y={signal:`datum.y + ${d.propSg(n,"area","y")}`}),"horizontal"===i.orient.value?delete i.y2:delete i.x2,r},w.line=function(e,t,n){const r=w.mark(e,t,n),s=a.array("pathgroup"===r.name?r.marks:r)[0],i=s.encode.update;return s.from||(s.from={data:"dummy_data"},i.x={signal:`datum.x + ${d.propSg(n,"line","x")}`},i.y={signal:`datum.y + ${d.propSg(n,"line","y")}`}),r},w.scale=function(e,t,n){const r=v(e,"scales."+n).toJS(),s=T(l.default(r),t);E.scales[n]=E.scales[n]||l.default(S),!r.domain&&r._domain&&r._domain.length&&(s.domain=N(e,r,r._domain)),!r.range&&r._range&&r._range.length&&(s.range=N(e,r,r._range));const i=a.isObject(s.domain)&&s.domain._sortOrder;return i&&(s.reverse=i===_.DESC?!s.reverse:!!s.reserve),s},w.axe=w.legend=function(e,t,n){const r=v(e,"guides."+n).toJS(),s=T(l.default(r),t),o=r._gtype,p=r._type;return o===i.GuideType.Axis?(E.scales[s.scale].guides[n]=!0,s.scale=c.default(v(e,"scales."+s.scale+".name"))):o===i.GuideType.Legend&&(E.scales[s[p]].guides[n]=!0,s[p]=c.default(v(e,"scales."+s[p]+".name"))),Object.keys(s.encode).forEach(function(e){const t=s.encode[e];Object.keys(t).forEach(function(e){a.isObject(t[e])||(t[e]={value:t[e]})})}),s},t.getCounts=A,e.exports.exportName=c.default,e.exports.counts=A},591:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={x:{START:{name:"x",label:"Left"},CENTER:{name:"xc",label:"Center"},SPAN:{name:"width",label:"Width"},END:{name:"x2",label:"Right"}},y:{START:{name:"y",label:"Top"},CENTER:{name:"yc",label:"Middle"},SPAN:{name:"height",label:"Height"},END:{name:"y2",label:"Bottom"}}}},595:function(e,t,n){"use strict";e.exports=["count","mean","sum","min","max","variance","variancep","stdev","stdevp","median","q1","q3","modeskew"]},596:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47);t.hintsOn=a.createStandardAction("HINTS_ON")(),t.clearHints=a.createStandardAction("CLEAR_HINTS")()},597:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.LyraGlobals=a.Record({idCounter:1},"LyraGlobals")},598:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.WidgetSelection=a.Record({type:null,id:null,label:null,step:null,comparator:null},"LyraWidgetSelection"),t.Widget=a.Record({id:null,name:null,groupId:null,field:null,dsId:null,selection:null,applications:[],signals:[]},"LyraWidget")},599:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.VegaReparse=a.Record({invalid:!1,isParsing:!1},"LyraVegaReparse")},603:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),r=n(592),s=n(424),i={json:"application/json",html:"text/html"};function o(e,t){const n=r.select(document.createElement("a")).attr("href",e).attr("target","_blank").attr("download","lyra."+t).node(),a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,document.defaultView,1,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(a)}function l(t,n){for(const a of t){const t=new FileReader;t.onloadend=(t=>a=>{const r=a.target.result;n("string"==typeof r?r:e.from(r).toString("utf-8"),t)})(a),t.readAsText(a)}}t.toBlob=function(e,t){const n=new Blob([e],{type:i[t]});return o(window.URL.createObjectURL(n),t)},t.download=o,t.get=function(e,t){s.load({url:e},(e,n)=>t(n,e))},t.fopen=function(e,t){r.select(document.createElement("input")).attr("type","file").attr("accept",a.array(e).map(e=>`.${e}`).join(",")).on("change",()=>l(r.event.target.files,t)).node().click()},t.read=l}).call(this,n(415).Buffer)},662:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(23),r=n(85),s=n(48),i=n.n(s),o=n(27);const l=2*o.PADDING;function c(e){r.a.call(this,[],e)}c.Definition=Object(a.extend)({},r.a.Definition);const p=Object(a.inherits)(c,r.a);p.handles=function(e){const t=Object(o.coords)(e.bounds,"handle");return Object.values(t).filter(e=>"midCenter"!==e.key)},p.connectors=function(e){return Object.values(Object(o.coords)(e.bounds,"connector"))},p.channels=function(e){var t=e.bounds,n=e.mark.group.bounds,a=Object(o.coords)(t),r=a.topLeft,s=a.topRight,l=a.bottomRight,c=t.width(),p=t.height(),d=Math.max(Math.min(s.x+c,n.x2-o.PADDING),s.x+50),u=Math.max(Math.min(l.y+p,n.y2-o.PADDING),l.y+50);return[].concat([{x:r.x,y:r.y-o.PADDING},{x:s.x,y:s.y-o.PADDING},{x:d,y:s.y-o.PADDING},{x:d-o.ARROWHEAD,y:s.y-2*o.PADDING},{x:d-o.ARROWHEAD,y:s.y},{x:d,y:s.y-o.PADDING+.1}].map(i()("x+","arrow","x position"))).concat([{x:s.x+o.PADDING,y:s.y},{x:l.x+o.PADDING,y:l.y},{x:l.x+o.PADDING,y:u},{x:l.x+2*o.PADDING,y:u-o.ARROWHEAD},{x:l.x,y:u-o.ARROWHEAD},{x:l.x+o.PADDING,y:u+.1}].map(i()("y+","arrow","y position"))).concat([{x:e.x,y:e.y,x2:e.x2,y2:e.y2,width:e.width,height:e.height,shape:e.shape}].map(i()("fill","border")))},p.altchannels=function(e){var t=e.bounds,n=e.mark.group.bounds,a=Object(o.coords)(t),r=a.topLeft,s=a.topCenter,c=a.topRight,p=a.midLeft,d=a.midRight,u=a.bottomLeft,m=a.bottomCenter,g=a.bottomRight;return[].concat([{x:n.x1,y:r.y},{x:r.x-l,y:r.y}].map(i()("x","span","left (x)"))).concat([{x:n.x1,y:g.y+o.PADDING},{x:u.x,y:g.y+o.PADDING},{x:g.x,y:g.y+o.PADDING}].map(i()("x2","span","right (x2)"))).concat([{x:r.x,y:n.y1},{x:r.x,y:r.y-l}].map(i()("y","span","top (y)"))).concat([{x:g.x+o.PADDING,y:n.y1},{x:g.x+o.PADDING,y:c.y},{x:g.x+o.PADDING,y:g.y}].map(i()("y2","span","bottom (y2)"))).concat([{x:p.x,y:c.y-o.PADDING},{x:d.x,y:c.y-o.PADDING}].map(i()("width","span"))).concat([{x:u.x-o.PADDING,y:s.y},{x:u.x-o.PADDING,y:m.y}].map(i()("height","span"))).concat([{x:e.x,y:e.y,x2:e.x2,y2:e.y2,width:e.width,height:e.height,shape:e.shape}].map(i()("stroke","border")))}},67:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(420),s=n(421),i=n(167),o=n(370),l=n(40).getInVis;t.addMark=function(e){return function(n,a){const r=e._id||i.assignId(n,a());if(!(e=e.set("_id",r)).name){const t=function(e,t){t=t||"Mark";const n=e.getIn(["vis","present","marks"]).filter(e=>e.type===t).size;return o(t)+" "+(n+1)}(a(),e.type);e=e.set("name",t)}n(t.baseAddMark({name:e.name,streams:s.Mark.getHandleStreams(e),props:e},r))}},t.baseAddMark=a.createStandardAction("ADD_MARK")(),t.updateMarkProperty=a.createStandardAction("UPDATE_MARK_PROPERTY")(),t.setParent=a.createStandardAction("SET_PARENT_MARK")(),t.setMarkVisual=a.createStandardAction("SET_MARK_VISUAL")(),t.disableMarkVisual=a.createStandardAction("DISABLE_MARK_VISUAL")(),t.resetMarkVisual=a.createStandardAction("RESET_MARK_VISUAL")(),t.bindScale=a.createStandardAction("BIND_SCALE")(),t.bindField=a.createStandardAction("BIND_FIELD")(),t.setMarkExtent=a.createStandardAction("SET_MARK_EXTENT")(),t.setVlUnit=a.createStandardAction("SET_VL_UNIT")(),t.deleteMark=function e(n){return function(a,s){const i=l(s(),"marks."+n),o=i.get("marks");r.batchGroupBy.start(),o&&o.size&&o.forEach(function(t){a(e(t))}),a(t.baseDeleteMark(i.type,i._id)),r.batchGroupBy.end()}},t.baseDeleteMark=a.createStandardAction("DELETE_MARK")()},72:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(23),r=n(90),s=n(590),i=n(27),o=n(423),l=n(267),c=n(424),p=(n(27),n(221)),d=n(1139),u=e.exports={view:null},m=n(310);let g=null;u.export=s.exporter,u.persist=o.persist,u.hydrate=o.hydrate,u.manipulators=function(){const e=u.export(!0),t=e.data||(e.data=[]),n=e.signals||(e.signals=[]),a=e.marks||(e.marks=[]),s=c.comparator("_idx");return n.push.apply(n,Object.values(l.api()).sort(s)),t.push({name:"bubble_cursor",transform:[{type:p("bubble_cursor"),lyra_cell:{signal:r.CELL},lyra_mouse:{signal:r.MOUSE}}]}),a.push(i.BUBBLE_CURSOR),a.push.apply(a,i.BUBBLE_CURSOR_TIP),t.push({name:"dummy_data",values:[{x:0,y:0},{x:100,y:100}]}),e},u.parse=function(e){return e=e||"#vis",g&&g.cancel(),(g=new d(function(e,t){const n=this;setTimeout(function(){if(!n.cancelled)try{e(a.parse(u.manipulators()))}catch(e){console.error(e)}},10)})).then(function(t){u.view=new a.View(t,{renderer:"svg"}).initialize(e).logLevel(a.Warn).hover(),m.register(),u.update(),g=null})},u.update=function(){u.view&&u.view.runAsync&&"function"==typeof u.view.runAsync&&u.view.runAsync()}},85:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(23);function r(e){a.Transform.call(this,[],e)}r.Definition={metadata:{source:!0,changes:!0},params:[{name:"lyra_id",type:"number",required:!0},{name:"lyra_selected",required:!0},{name:"lyra_mode",required:!0},{name:"signals",array:!0}]};const s=Object(a.inherits)(r,a.Transform);s.transform=function(e,t){const n=this.value||[],r=t.fork(t.NO_FIELDS&t.NO_SOURCE),s=e.lyra_id,i=e.lyra_selected,o=e.lyra_mode,l=i.mark.role,c=Object(a.tupleid)(i);if(!n.length||n._id===c&&n._mode===o||(r.rem=n.splice(0)),!l||l&&s!==+l.split("lyra_")[1])return r.source=this.value=n,r;const p=this[o](i).map(function(e){return e.mode=o,e.lyra_id=s,e});return n.length&&n._id===c?(p.forEach((e,t)=>Object(a.extend)(n[t],e)),r.mod=n):(n._id=c,n._mode=o,n.push.apply(n,p.map(a.ingest)),r.add=n),r.source=this.value=n,r},s.handles=function(e){return[]},s.connectors=function(e){return[]},s.channels=function(e){return[]},s.altchannels=function(e){return[]}},852:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47);t.incrementCounter=a.createStandardAction("INCREMENT_COUNTER")()},853:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(368),s=n(168),i=n(369),o=n(90);t.Area=a.Record({_id:null,_parent:null,_vlUnit:null,type:"area",name:null,from:null,encode:{update:{y2:{value:250},tension:{value:13},interpolate:{value:"monotone"},orient:{value:"vertical"}}}},"LyraAreaMark"),t.getHandleStreams=function(e){const t=r.default.bind(null,e,"handles"),n=e._id,a=s.propSg(n,"area","x"),l=s.propSg(n,"area","xc"),c=s.propSg(n,"area","x2"),p=s.propSg(n,"area","y"),d=s.propSg(n,"area","yc"),u=s.propSg(n,"area","y2"),m=s.propSg(n,"area","width"),g=s.propSg(n,"area","height"),h=`${o.DELTA}.x`,f=`${o.DELTA}.y`;return{[a]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("left")}`,`${a} + ${h}`,a)}],[l]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("left")}`,`${l} + ${h}`,l)}],[c]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("right")}`,`${c} + ${h}`,c)}],[p]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("top")}`,`${p} + ${f}`,p)}],[d]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("top")}`,`${d} + ${f}`,d)}],[u]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("bottom")}`,`${u} + ${f}`,u)}],[m]:[{events:{signal:o.DELTA},update:i.default(t("left"),`${m} - ${h}`,m)},{events:{signal:o.DELTA},update:i.default(t("right"),`${m} + ${h}`,m)}],[g]:[{events:{signal:o.DELTA},update:i.default(t("top"),`${g} - ${f}`,g)},{events:{signal:o.DELTA},update:i.default(t("bottom"),`${g} + ${f}`,g)}]}}},855:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);n(40).getInVis;t.Group=a.Record({_id:null,_parent:null,_vlUnit:null,_manualLayout:!1,_interactions:[],_widgets:[],type:"group",name:null,from:null,scales:[],axes:[],legends:[],marks:[],encode:{update:{fill:{value:"transparent"},stroke:null,x:{value:0},y:{value:0},x2:{value:140,_disabled:!0},y2:{value:140,_disabled:!0},xc:{value:70,_disabled:!0},yc:{value:70,_disabled:!0},width:{value:640},height:{value:360}}}},"LyraGroupMark")},856:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(368),s=n(168),i=n(369),o=n(90);t.Line=a.Record({_id:null,_parent:null,_vlUnit:null,_facet:null,type:"line",name:null,from:null,encode:{update:{strokeWidth:{value:3},tension:{value:13},interpolate:{value:"monotone"}}}},"LyraLineMark"),t.getHandleStreams=function(e){const t=r.default.bind(null,e,"handles"),n=e._id,a=s.propSg(n,"line","x"),l=s.propSg(n,"line","y"),c=`${o.DELTA}.x`,p=`${o.DELTA}.y`;return{[a]:[{events:{signal:o.DELTA},update:i.default(t(),`${a} + ${c}`,a)}],[l]:[{events:{signal:o.DELTA},update:i.default(t(),`${l} + ${p}`,l)}]}}},857:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(368),s=n(168),i=n(369),o=n(90);t.Rect=a.Record({_id:null,_parent:null,_vlUnit:null,type:"rect",name:null,from:null,encode:{update:{x2:{value:140},y2:{value:140},xc:{value:70,_disabled:!0},yc:{value:70,_disabled:!0},width:{value:40,_disabled:!0},height:{value:40,_disabled:!0}}}},"LyraRectMark"),t.getHandleStreams=function(e){const t=r.default.bind(null,e,"handles"),n=e._id,a=e.type,l=s.propSg(n,a,"x"),c=s.propSg(n,a,"xc"),p=s.propSg(n,a,"x2"),d=s.propSg(n,a,"y"),u=s.propSg(n,a,"yc"),m=s.propSg(n,a,"y2"),g=s.propSg(n,a,"width"),h=s.propSg(n,a,"height"),f=`${o.DELTA}.x`,y=`${o.DELTA}.y`;return{[l]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("left")}`,`${l} + ${f}`,l)}],[c]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("left")}`,`${c} + ${f}`,c)}],[p]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("right")}`,`${p} + ${f}`,p)}],[d]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("top")}`,`${d} + ${y}`,d)}],[u]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("top")}`,`${u} + ${y}`,u)}],[m]:[{events:{signal:o.DELTA},update:i.default(`${t()} || ${t("bottom")}`,`${m} + ${y}`,m)}],[g]:[{events:{signal:o.DELTA},update:i.default(t("left"),g+"-"+f,g)},{events:{signal:o.DELTA},update:i.default(t("right"),g+"+"+f,g)}],[h]:[{events:{signal:o.DELTA},update:i.default(t("top"),h+"-"+y,h)},{events:{signal:o.DELTA},update:i.default(t("bottom"),h+"+"+y,h)}]}}},859:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.Scene=a.Record({_id:null,type:"scene",name:"Scene",background:"white",autosize:"pad",padding:5,encode:{update:{}},scales:[],axes:[],legends:[],marks:[]},"LyraScene")},860:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.Scale=function(e){return a.Record(Object.assign({_id:null,_origName:null,_domain:[],_range:[],name:null},e),"LyraScale")()}},87:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17);t.Icon=class extends a.Component{render(){const e=this.props,t=(e.className?e.className+" ":"")+"icon";return a.createElement("svg",{className:t,onClick:e.onClick,width:e.width||13,height:e.height||13,"data-html":e["data-html"],"data-tip":e["data-tip"],"data-place":e["data-place"]},a.createElement("use",{xlinkHref:"#"+e.glyph.id}))}}},873:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47);t.setActiveStep=a.createStandardAction("SET_ACTIVE_STEP")(),t.setActiveWalkthrough=a.createStandardAction("SET_ACTIVE_WALKTHROUGH")()},876:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43);t.Hints=a.Record({display:null,on:!1},"LyraHints")},877:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recordName=function(e,t,n){return n+" "+(e.getIn(["vis","present",t]).size+1)}},878:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(1171);t.Walkthrough=a.Record({data:r.data,activeStep:1,activeWalkthrough:null},"LyraWalkthrough")},879:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.MARKS="marks",e.GUIDES="guides",e.SCALES="scales",e.DATASETS="datasets",e.INTERACTIONS="interactions",e.WIDGETS="widgets"}(t.PrimType||(t.PrimType={}))},88:function(e,t,n){"use strict";e.exports={"group-expanded":n(1185),"group-contracted":n(1186),rect:n(1187),line:n(1188),area:n(1189),text:n(1190),symbol:n(1191),trash:n(1192),plus:n(1193),undo:n(1194),redo:n(1195),nominal:n(1196),ordinal:n(1197),quantitative:n(1198),temporal:n(1199),prev:n(1200),next:n(1201),close:n(1202),hamburger:n(1203),erase:n(1204),export:n(1205),scaffold:n(1206),select:n(1207),sort:n(1208),sortAlphaAsc:n(1209),sortAlphaDesc:n(1210),sortNumericAsc:n(1211),sortNumericDesc:n(1212),filter:n(1213),formula:n(1214),aggregate:n(1215),download:n(1216),bold:n(1217),italic:n(1218),open:n(1219),save:n(1220),"align-left":n(1221),"align-center":n(1222),"align-right":n(1223),"vertical-align-bottom":n(1224),"vertical-align-center":n(1225),"vertical-align-top":n(1226)}},880:function(e,t,n){"use strict";e.exports=["linear","step-before","step-after","basis","basis-open","cardinal","cardinal-open","monotone"]},881:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(17);t.MoreProperties=class extends a.Component{constructor(e){super(e),this.state={display:"none"}}toggle(e){return"block"===e?"none":"block"}handleClick(e){this.setState({display:this.toggle(this.state.display)})}render(){const e=this.props,t=this.state.display,n={display:t},r={display:this.toggle(t)};let s,i;return e.header?s=a.createElement("div",null,a.createElement("h3",{className:"show-more-props more-props-label",onClick:this.handleClick,style:r},"+ ",e.label),a.createElement("h3",{className:"hide-more-props more-props-label",onClick:this.handleClick,style:n}," ",e.label)):(s=a.createElement("a",{className:"show-more-props more-props-label",href:"#",onClick:this.handleClick,style:r},"+ More ",e.label," Properties"),i=a.createElement("a",{className:"hide-more-props more-props-label",href:"#",style:n,onClick:this.handleClick}," Fewer ",e.label," Properties")),a.createElement("div",null,s,a.createElement("div",{className:"more-props",style:n},e.children),i)}}},882:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(1268),r=n(1274),s=n(17),i=n(35),o=n(87),l=n(424),c=(n(40).getInVis,n(224)),p=n(88),d=n(72);t.default=i.connect(function(e,t){const n=t.id,a=e.getIn(["vis","present","datasets",String(n)]);let r=[];if(a&&a.transform){const t=e.getIn(["vis","present","interactions"]).valueSeq().toArray(),n=[].concat.apply([],t.filter(e=>e.signals.length).map(e=>e.signals.map(e=>e.signal))),s=e.getIn(["vis","present","widgets"]).valueSeq().toArray(),i=[].concat.apply([],s.filter(e=>e.signals.length).map(e=>e.signals.map(e=>e.signal))),o=n.concat(i);a.transform.map(e=>{if("filter"===e.type){const t=e.expr,n=o.filter(e=>t.indexOf(e)>-1);r=r.concat(n)}})}return{dataset:a,vega:e.get("vega"),signalsInExprs:r}})(class extends s.Component{constructor(e){super(e),this.$table=s.createRef(),this.prevPage=(()=>{this.setState({page:this.state.page-1},()=>{this.props.onPage&&this.props.onPage(this.state.page)}),this.$table.current.scrollLeft=0}),this.nextPage=(()=>{this.setState({page:this.state.page+1},()=>{this.props.onPage&&this.props.onPage(this.state.page)}),this.$table.current.scrollLeft=0}),this.showHoverField=(e=>{const t=e.target;this.setState({hoverField:{name:t.textContent,offsetTop:t.offsetTop},hoverValue:null})}),this.showHoverValue=(e=>{this.setState({hoverField:null,hoverValue:(e.persist(),e)})}),this.hideHover=(()=>{this.setState({hoverField:null,hoverValue:null})}),this.onScroll=(()=>{this.hideHover();const e=this.$table.current&&this.$table.current.scrollLeft;this.props.onScroll&&this.props.onScroll(e)}),this.state={page:0,hoverField:null,hoverValue:null,output:e.id?c.output(e.id):e.values}}shouldComponentUpdate(e,t){const n=e.vega;return!n.get("invalid")&&!n.get("isParsing")}componentDidUpdate(e,t){this.props.scroll!==e.scroll&&this.$table&&(this.$table.current.scrollLeft=this.props.scroll),this.props.signalsInExprs!==e.signalsInExprs&&(this.onFilterExprSignal(),e.signalsInExprs.forEach(e=>{d.view.removeSignalListener(e,()=>this.onFilterExprSignal())}),this.props.signalsInExprs.forEach(e=>{d.view.addSignalListener(e,()=>this.onFilterExprSignal())}))}onFilterExprSignal(){this.setState({output:this.props.id?c.output(this.props.id):this.props.values})}render(){const e=this.state,t=this.props,n=void 0!==t.page?t.page:e.page,i=t.limit,c=n*i,d=c+i,u=t.id,m=u?t.dataset.get("_schema"):t.schema,g=e.output,h=g.slice(c,d),f=m.keySeq().toArray().filter((e,t)=>void 0===this.props.fieldsIndex||void 0===this.props.fieldsCount||t>=this.props.fieldsIndex*this.props.fieldsCount&&t<this.props.fieldsIndex*this.props.fieldsCount+this.props.fieldsCount),y=g.length,v=l.format.auto.number(),_=this.$table.current&&this.$table.current.scrollLeft,b=n>0?s.createElement(o.Icon,{glyph:p.prev,width:"10",height:"10",onClick:this.prevPage}):null,x=n+1<y/i?s.createElement(o.Icon,{glyph:p.next,width:"10",height:"10",onClick:this.nextPage}):null;return s.createElement("div",{className:"datatable-container"},g.length?s.createElement("div",{className:"datatable",ref:this.$table,onMouseLeave:this.hideHover,onScroll:this.onScroll},s.createElement("table",null,s.createElement("tbody",null,f.map(function(e){return s.createElement("tr",{key:e},s.createElement("td",{className:"field "+(m.get(e).source?"source":"derived"),onMouseOver:this.showHoverField},e),h.map(function(t,n){return s.createElement("td",{key:e+n,className:n%2?"even":"odd",onMouseOver:this.showHoverValue},t[e])},this))},this))),u?s.createElement(a.default,{dsId:u,schema:m,def:e.hoverField}):null,s.createElement(r.default,{event:e.hoverValue,scrollLeft:_})):null,s.createElement("div",{className:"paging"},t.first?s.createElement("span",null,v(c+1),"",v(d>y?y:d)," of ",v(y)):null,t.last?s.createElement("span",{className:"pager"},b," ",x):null))}})},883:function(e,t,n){"use strict";var a=e.exports=["quantitative","nominal","temporal"];a.NOMINAL="nominal",a.ORDINAL="ordinal",a.QUANTITATIVE="quantitative",a.TEMPORAL="temporal"},90:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(43),r=n(23),s=n(221);t.SELECTED=s("selected"),t.MODE=s("mode"),t.ANCHOR=s("anchor"),t.DELTA=s("delta"),t.CURSOR="cursor",t.CELL=s("cell"),t.MOUSE=s("mouse"),t.signalNames=[t.SELECTED,t.MODE,t.ANCHOR,t.DELTA,t.CURSOR,t.CELL,t.MOUSE],t.Signal=a.Record({_idx:null,value:null,name:null,on:[]},"LyraSignal"),t.defaultSignalState=a.Map({[t.SELECTED]:t.Signal({name:t.SELECTED,value:{mark:{}},on:[{events:"mousedown[item().mark && item().mark.name &&item().mark.name !== "+r.stringValue(t.CELL)+"]",update:"item()"},{events:"mousedown[!item().mark]",update:"{mark: {}}"}],_idx:0}),[t.MODE]:t.Signal({name:t.MODE,value:"handles",_idx:1}),[t.DELTA]:t.Signal({name:t.DELTA,value:0,on:[{events:"[mousedown, window:mouseup] > window:mousemove",update:"{x: x() - lyra_anchor.x, y: y() - lyra_anchor.y}"}],_idx:2}),[t.ANCHOR]:t.Signal({name:t.ANCHOR,value:0,on:[{events:"mousedown",update:"{x: x(), y: y(), target: item()}"},{events:"[mousedown, window:mouseup] > window:mousemove",update:"{x: x(), y: y(), target: lyra_anchor.target}"}],_idx:3}),[t.CELL]:t.Signal({name:t.CELL,value:{},on:[{events:{type:"dragover",filter:[`event.item && event.item.mark.role === "${t.CELL}"`]},update:"item()"},{events:{type:"dragleave",filter:[`event.item && event.item.mark.role === "${t.CELL}"`]},update:"{}"}],_idx:4}),[t.MOUSE]:t.Signal({name:t.MOUSE,value:{},on:[{events:"mousemove, dragover",update:"{x: x(), y: y()}"}],_idx:5})})},92:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47),r=n(375);var s;!function(e){e.SELECT_GUIDE="SELECT_GUIDE",e.SELECT_MARK="SELECT_MARK",e.SELECT_PIPELINE="SELECT_PIPELINE",e.SELECT_SCALE="SELECT_SCALE",e.SELECT_INTERACTION="SELECT_INTERACTION",e.SELECT_WIDGET="SELECT_WIDGET"}(s=t.InspectorSelectedType||(t.InspectorSelectedType={})),t.toggleLayers=a.createStandardAction("TOGGLE_LAYERS")(),t.expandLayers=a.createStandardAction("EXPAND_LAYERS")(),t.removeLayers=a.createStandardAction("REMOVE_LAYERS")(),t.selectGuide=a.createStandardAction(s.SELECT_GUIDE)(),t.baseSelectMark=a.createStandardAction(s.SELECT_MARK)(),t.selectMark=function(e){return function(n,a){const s=r.getParentGroupIds(e,a());n(t.baseSelectMark(e,s))}},t.selectPipeline=a.createStandardAction(s.SELECT_PIPELINE)(),t.selectScale=a.createStandardAction(s.SELECT_SCALE)(),t.selectInteraction=a.createStandardAction(s.SELECT_INTERACTION)(),t.selectWidget=a.createStandardAction(s.SELECT_WIDGET)(),t.startDragging=a.createStandardAction("START_DRAGGING")(),t.stopDragging=a.createStandardAction("STOP_DRAGGING")()}}]);
//# sourceMappingURL=default.js.map